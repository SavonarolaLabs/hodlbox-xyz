import{s as Y,n as H,j as N,r as Ge,l as ye,o as ct}from"../chunks/scheduler.71af12de.js";import{S as Q,i as Z,g,h as _,A as U,k as d,a as D,f as h,s as z,m as B,r as se,j as k,c as $,n as S,u as le,l as G,y as p,v as ne,o as te,d as P,t as F,w as ae,E as pe,x as fe,F as Te,G as Re,p as Ze,b as et,H as tt,e as Fe}from"../chunks/index.e9246ef9.js";import{c as Be,t as _e,S as we,f as ke,g as je,h as Ee,E as De,O as Le,i as Ve,C as pt,j as st,k as lt,l as Oe,m as He,p as Ae,T as nt,R as at,q as ft,s as rt,r as Ne,v as me,a as Se,x as Me,y as Ke,z as Ce,A as We,D as ze,F as ut,H as dt,G as ht,I as mt,B as vt,J as gt,W as _t,K as yt,L as bt,e as Pe,b as xt,M as wt,N as kt}from"../chunks/notifier.de712fd5.js";function jt(n){let e,t=`<div class="fake-window-header svelte-fmz6ic"><div class="ios-buttons svelte-fmz6ic"><div class="ios-button close svelte-fmz6ic"></div> <div class="ios-button minimize svelte-fmz6ic"></div> <div class="ios-button maximize svelte-fmz6ic"></div></div> <div style="padding-right:8px;">ergoscript</div></div> <div class="source-code svelte-fmz6ic"><pre><code class="hljs svelte-fmz6ic">{
		<span class="hljs-keyword svelte-fmz6ic">val</span> hodlTargetRate : <span class="hljs-type svelte-fmz6ic">Long</span>     = <span class="hljs-type svelte-fmz6ic">SELF</span>.<span class="hljs-type svelte-fmz6ic">R4</span>[<span class="hljs-type svelte-fmz6ic">Long</span>].get
		<span class="hljs-keyword svelte-fmz6ic">val</span> maxHeight : <span class="hljs-type svelte-fmz6ic">Int</span>           = <span class="hljs-type svelte-fmz6ic">SELF</span>.<span class="hljs-type svelte-fmz6ic">R5</span>[<span class="hljs-type svelte-fmz6ic">Int</span>].get
		<span class="hljs-keyword svelte-fmz6ic">val</span> hodlerPK : <span class="hljs-type svelte-fmz6ic">SigmaProp</span>      = <span class="hljs-type svelte-fmz6ic">SELF</span>.<span class="hljs-type svelte-fmz6ic">R6</span>[<span class="hljs-type svelte-fmz6ic">SigmaProp</span>].get
		<span class="hljs-keyword svelte-fmz6ic">val</span> uiFeePK : <span class="hljs-type svelte-fmz6ic">SigmaProp</span>       = <span class="hljs-type svelte-fmz6ic">SELF</span>.<span class="hljs-type svelte-fmz6ic">R7</span>[<span class="hljs-type svelte-fmz6ic">SigmaProp</span>].get
	 
		<span class="hljs-keyword svelte-fmz6ic">val</span> totalLockedNanoErg : <span class="hljs-type svelte-fmz6ic">Long</span> = <span class="hljs-type svelte-fmz6ic">SELF</span>.value
	 
		<span class="hljs-keyword svelte-fmz6ic">val</span> fees: <span class="hljs-type svelte-fmz6ic">Coll</span>[(<span class="hljs-type svelte-fmz6ic">SigmaProp</span>, <span class="hljs-type svelte-fmz6ic">BigInt</span>)] = {
			<span class="hljs-keyword svelte-fmz6ic">val</span> feeDenom : <span class="hljs-type svelte-fmz6ic">Long</span> = <span class="hljs-number">100000</span>L
			<span class="hljs-keyword svelte-fmz6ic">val</span> devFee   : <span class="hljs-type svelte-fmz6ic">Long</span> = <span class="hljs-number">500</span>L         <span class="hljs-comment svelte-fmz6ic">// 0.5%</span>
			<span class="hljs-keyword svelte-fmz6ic">val</span> uiFee    : <span class="hljs-type svelte-fmz6ic">Long</span> = <span class="hljs-number">500</span>L         <span class="hljs-comment svelte-fmz6ic">// 0.5%</span>
				<span class="hljs-type svelte-fmz6ic">Coll</span>(
					 (_contractDevPK, (devFee.toBigInt * totalLockedNanoErg.toBigInt) / feeDenom.toBigInt),
					 (uiFeePK, (uiFee.toBigInt * totalLockedNanoErg.toBigInt) / feeDenom.toBigInt)
				)
		}
	 
		<span class="hljs-keyword svelte-fmz6ic">val</span> feesPaid : <span class="hljs-type svelte-fmz6ic">Boolean</span> = {
			<span class="hljs-keyword svelte-fmz6ic">val</span> devFeesPaid: <span class="hljs-type svelte-fmz6ic">Boolean</span> = {
				<span class="hljs-keyword svelte-fmz6ic">if</span>(fees(<span class="hljs-number">0</span>)._2 &gt; <span class="hljs-number">0</span>){
					<span class="hljs-keyword svelte-fmz6ic">val</span> devOutput : <span class="hljs-type svelte-fmz6ic">Box</span>   = <span class="hljs-type svelte-fmz6ic">OUTPUTS</span>(<span class="hljs-number">1</span>)
					allOf(
						<span class="hljs-type svelte-fmz6ic">Coll</span>(
							devOutput.propositionBytes   == fees(<span class="hljs-number">0</span>)._1.propBytes,
							devOutput.value.toBigInt     &gt;= fees(<span class="hljs-number">0</span>)._2
						)
					)
				}<span class="hljs-keyword svelte-fmz6ic">else</span>{
					<span class="hljs-literal svelte-fmz6ic">true</span>
				}
			}
	 
			<span class="hljs-keyword svelte-fmz6ic">val</span> uiFeesPaid : <span class="hljs-type svelte-fmz6ic">Boolean</span> = {
				<span class="hljs-keyword svelte-fmz6ic">if</span>(fees(<span class="hljs-number">1</span>)._2 &gt; <span class="hljs-number">0</span>){
					<span class="hljs-keyword svelte-fmz6ic">val</span> uiOutput : <span class="hljs-type svelte-fmz6ic">Box</span>    = <span class="hljs-type svelte-fmz6ic">OUTPUTS</span>(<span class="hljs-number">2</span>)
					allOf(
						<span class="hljs-type svelte-fmz6ic">Coll</span>(
							uiOutput.propositionBytes   == fees(<span class="hljs-number">1</span>)._1.propBytes,
							uiOutput.value.toBigInt     &gt;= fees(<span class="hljs-number">1</span>)._2
						)
					)
				}<span class="hljs-keyword svelte-fmz6ic">else</span>{
					<span class="hljs-literal svelte-fmz6ic">true</span>
				}
			}
			devFeesPaid &amp;&amp; uiFeesPaid
		}
	 
		<span class="hljs-keyword svelte-fmz6ic">val</span> feesTotal : <span class="hljs-type svelte-fmz6ic">Long</span> = fees(<span class="hljs-number">0</span>)._2 + fees(<span class="hljs-number">1</span>)._2
	 
		<span class="hljs-keyword svelte-fmz6ic">val</span> repaymentNanoErg : <span class="hljs-type svelte-fmz6ic">Long</span> = totalLockedNanoErg - feesTotal
	 
		<span class="hljs-keyword svelte-fmz6ic">val</span> fundsReturned : <span class="hljs-type svelte-fmz6ic">Boolean</span> = {
			<span class="hljs-type svelte-fmz6ic">OUTPUTS</span>(<span class="hljs-number">0</span>).propositionBytes == hodlerPK.propBytes &amp;&amp; 
			<span class="hljs-type svelte-fmz6ic">OUTPUTS</span>(<span class="hljs-number">0</span>).value &gt;= repaymentNanoErg &amp;&amp;
			<span class="hljs-type svelte-fmz6ic">OUTPUTS</span>(<span class="hljs-number">0</span>).<span class="hljs-type svelte-fmz6ic">R4</span>[<span class="hljs-type svelte-fmz6ic">Coll</span>[<span class="hljs-type svelte-fmz6ic">Byte</span>]].get == <span class="hljs-type svelte-fmz6ic">SELF</span>.id
		}
	 
		<span class="hljs-keyword svelte-fmz6ic">val</span> maxHeightReached : <span class="hljs-type svelte-fmz6ic">Boolean</span> = {
			maxHeight &lt;= <span class="hljs-type svelte-fmz6ic">HEIGHT</span>
		}
	 
		<span class="hljs-keyword svelte-fmz6ic">val</span> priceTargetReached : <span class="hljs-type svelte-fmz6ic">Boolean</span> = {
			<span class="hljs-keyword svelte-fmz6ic">if</span> (<span class="hljs-type svelte-fmz6ic">CONTEXT</span>.dataInputs.size &gt; <span class="hljs-number">0</span>) {
				<span class="hljs-comment svelte-fmz6ic">// validate Oracle box</span>
				<span class="hljs-keyword svelte-fmz6ic">val</span> oracleBox : <span class="hljs-type svelte-fmz6ic">Box</span> = <span class="hljs-type svelte-fmz6ic">CONTEXT</span>.dataInputs(<span class="hljs-number">0</span>)
				<span class="hljs-keyword svelte-fmz6ic">val</span> currentRate : <span class="hljs-type svelte-fmz6ic">Long</span> = oracleBox.<span class="hljs-type svelte-fmz6ic">R4</span>[<span class="hljs-type svelte-fmz6ic">Long</span>].get
				<span class="hljs-keyword svelte-fmz6ic">val</span> oracleHeight: <span class="hljs-type svelte-fmz6ic">Long</span> = oracleBox.<span class="hljs-type svelte-fmz6ic">R5</span>[<span class="hljs-type svelte-fmz6ic">Int</span>].get
	 
				<span class="hljs-keyword svelte-fmz6ic">val</span> validDataInput: <span class="hljs-type svelte-fmz6ic">Boolean</span> = <span class="hljs-type svelte-fmz6ic">HEIGHT</span> &lt;= oracleHeight + <span class="hljs-number">30</span> &amp;&amp; oracleBox.tokens(<span class="hljs-number">0</span>)._1 == _oraclePoolNFT
	 
				<span class="hljs-comment svelte-fmz6ic">// check if the price reached target</span>
				<span class="hljs-keyword svelte-fmz6ic">val</span> targetPriceReached: <span class="hljs-type svelte-fmz6ic">Boolean</span> = currentRate &lt;= hodlTargetRate
	 
				validDataInput &amp;&amp; targetPriceReached
			} <span class="hljs-keyword svelte-fmz6ic">else</span> {
				<span class="hljs-literal svelte-fmz6ic">false</span>
			}
		}
	 
		<span class="hljs-keyword svelte-fmz6ic">if</span>(priceTargetReached || maxHeightReached){
			sigmaProp(fundsReturned &amp;&amp; feesPaid)
		} <span class="hljs-keyword svelte-fmz6ic">else</span> {
			sigmaProp(<span class="hljs-literal svelte-fmz6ic">false</span>)
		}
	}</code></pre></div>`;return{c(){e=g("div"),e.innerHTML=t,this.h()},l(s){e=_(s,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1ll1nd"&&(e.innerHTML=t),this.h()},h(){d(e,"class","editor-flex svelte-fmz6ic")},m(s,l){D(s,e,l)},p:H,i:H,o:H,d(s){s&&h(e)}}}class Et extends Q{constructor(e){super(),Z(this,e,null,jt,Y,{})}}function zt(n){let e,t="smart contract.";return{c(){e=g("a"),e.textContent=t,this.h()},l(s){e=_(s,"A",{href:!0,"data-svelte-h":!0}),U(e)!=="svelte-maej2"&&(e.textContent=t),this.h()},h(){d(e,"href","https://github.com/SavonarolaLabs/hodlbox-xyz/blob/main/src/lib/contract/hodl_hodlerg3.ts")},m(s,l){D(s,e,l)},d(s){s&&h(e)}}}function $t(n){let e,t="smart contract.";return{c(){e=g("a"),e.textContent=t,this.h()},l(s){e=_(s,"A",{href:!0,"data-svelte-h":!0}),U(e)!=="svelte-50pk7c"&&(e.textContent=t),this.h()},h(){d(e,"href","https://github.com/SavonarolaLabs/hodlbox-xyz/blob/main/src/lib/contract/hodl.ts")},m(s,l){D(s,e,l)},d(s){s&&h(e)}}}function It(n){let e,t,s,l="How does it work?",c,a,o,r,i,y,f,m,u=n[1]/10n**9n+"",j,b,I,v,w="3. Unlocked coins can only be sent to your wallet.",E,x,T,C=n[1]/10n**9n+"",X,re,V,K,O,M,ue=`<img src="hodl.jpeg" alt="" class="mt-10"/> <div class="text-4xl mt-20 mb-10 self-end"><a href="https://ergoplatform.org/en/news/ErgoHack-7-The-Future-of-Finance-and-the-Path-to-Adoption/">ERGOHACKVII</a>
				letter</div> <div class="bg-white p-16 self-end paper text-black italic shadow-md">Dear Hackathon Committee,<br/><br/>

				We are excited to present our ErgoHack project, HodlBox. This dApp is designed to encourage
				long-term investment in the Ergo ecosystem. Our project addresses a common challenge in
				crypto: holding onto your coins over an extended period of time and not selling the bottom.
				To combat this, we&#39;ve devised a non-custodial vault that allows users to stash their ERG
				until a specific time or price point is reached on Spectrum DEX. When a user purchases a
				Hodl Box, they will also receive a commemorative NFT as a token of their commitment. The
				NFTs become increasingly awesome with larger sums, adding a fun way for users to flex on
				social media.<br/><br/>

				Our project is open-source, welcoming UI competition and abiding by Ergoâ€™s open source
				ethos. It&#39;s designed to be user-friendly, allowing users to mint in just two clicks.The Hodl
				Box system is secure and risk-free. Only the person who locked the box can unlock it, either
				when a certain price point is reached or after the established time period. The NFTs serve
				as a fun reward and Proof of Hodl, but they are not connected to the redemption process,
				eliminating the risk of losing access to your Hodl Box.<br/><br/>

				We&#39;ve implemented a small fee structure (0.5% contract, 0.5% UI) to support the project&#39;s
				sustainability. Importantly, the developers hold as well, with fees only paid after the hodl
				period, aligning the incentives of the ecosystem, users, and developers.<br/><br/>

				In conclusion, our project offers a perfect financial tool for the coming bull market,
				encouraging long-term investment and increasing the TVL in the Ergo ecosystem. We look
				forward to sharing our website and contract with you soon.<br/><br/>

				Best Regards,<br/><br/>

				TMR.ERG, c8, savonarola</div>`,de,oe,R,L="Smart Contract",ve,ie,W,ee;function be(A,ce){return A[0]=="ERG"?$t:zt}let he=be(n),J=he(n);return W=new Et({}),{c(){e=g("div"),t=g("div"),s=g("div"),s.textContent=l,c=z(),a=g("div"),o=B("1. Your "),r=B(n[0]),i=B(` is locked on Ergo Blockchain behind a
			`),J.c(),y=z(),f=g("div"),m=B("2. As soon as Ergo pumps to $"),j=B(u),b=B("/ERG your coins unlock.*"),I=z(),v=g("div"),v.textContent=w,E=z(),x=g("div"),T=B("*If $"),X=B(C),re=B("/ERG is not reached, your "),V=B(n[0]),K=B(" unlocks on 2024-10-15."),O=z(),M=g("div"),M.innerHTML=ue,de=z(),oe=g("div"),R=g("div"),R.textContent=L,ve=z(),ie=g("div"),se(W.$$.fragment),this.h()},l(A){e=_(A,"DIV",{class:!0});var ce=k(e);t=_(ce,"DIV",{class:!0});var q=k(t);s=_(q,"DIV",{class:!0,"data-svelte-h":!0}),U(s)!=="svelte-jy3xgb"&&(s.textContent=l),c=$(q),a=_(q,"DIV",{});var xe=k(a);o=S(xe,"1. Your "),r=S(xe,n[0]),i=S(xe,` is locked on Ergo Blockchain behind a
			`),J.l(xe),xe.forEach(h),y=$(q),f=_(q,"DIV",{});var $e=k(f);m=S($e,"2. As soon as Ergo pumps to $"),j=S($e,u),b=S($e,"/ERG your coins unlock.*"),$e.forEach(h),I=$(q),v=_(q,"DIV",{"data-svelte-h":!0}),U(v)!=="svelte-175k4k4"&&(v.textContent=w),E=$(q),x=_(q,"DIV",{class:!0});var ge=k(x);T=S(ge,"*If $"),X=S(ge,C),re=S(ge,"/ERG is not reached, your "),V=S(ge,n[0]),K=S(ge," unlocks on 2024-10-15."),ge.forEach(h),O=$(q),M=_(q,"DIV",{style:!0,"data-svelte-h":!0}),U(M)!=="svelte-1xzq9zw"&&(M.innerHTML=ue),de=$(q),oe=_(q,"DIV",{});var Ie=k(oe);R=_(Ie,"DIV",{class:!0,"data-svelte-h":!0}),U(R)!=="svelte-14ksf12"&&(R.textContent=L),ve=$(Ie),ie=_(Ie,"DIV",{});var Ue=k(ie);le(W.$$.fragment,Ue),Ue.forEach(h),Ie.forEach(h),q.forEach(h),ce.forEach(h),this.h()},h(){d(s,"class","text-4xl mt-10 mb-5"),d(x,"class","text-sm"),G(M,"max-width","700px"),d(R,"class","text-4xl mt-10 mb-5"),d(t,"class","w-full max-w-4xl flex flex-col gap-2"),d(e,"class","w-full min-h-full bg-main flex flex-col items-center svelte-jjvsd7")},m(A,ce){D(A,e,ce),p(e,t),p(t,s),p(t,c),p(t,a),p(a,o),p(a,r),p(a,i),J.m(a,null),p(t,y),p(t,f),p(f,m),p(f,j),p(f,b),p(t,I),p(t,v),p(t,E),p(t,x),p(x,T),p(x,X),p(x,re),p(x,V),p(x,K),p(t,O),p(t,M),p(t,de),p(t,oe),p(oe,R),p(oe,ve),p(oe,ie),ne(W,ie,null),ee=!0},p(A,[ce]){(!ee||ce&1)&&te(r,A[0]),he!==(he=be(A))&&(J.d(1),J=he(A),J&&(J.c(),J.m(a,null))),(!ee||ce&2)&&u!==(u=A[1]/10n**9n+"")&&te(j,u),(!ee||ce&2)&&C!==(C=A[1]/10n**9n+"")&&te(X,C),(!ee||ce&1)&&te(V,A[0])},i(A){ee||(P(W.$$.fragment,A),ee=!0)},o(A){F(W.$$.fragment,A),ee=!1},d(A){A&&h(e),J.d(),ae(W)}}}function Tt(n,e,t){let s,l;return N(n,Be,c=>t(0,s=c)),N(n,_e,c=>t(1,l=c)),[s,l]}class Rt extends Q{constructor(e){super(),Z(this,e,Tt,It,Y,{})}}function ot(n){return Ct(n.name,n.description,n.sha256,n.url)}function Ct(n,e,t,s){return{R4:we(ke(je,Ee("utf8",n))),R5:we(ke(je,Ee("utf8",e))),R6:we(ke(je,Ee("utf8","0"))),R7:"0e020101",R8:we(ke(je,Ee("hex",t))),R9:we(ke(je,Ee("utf8",s)))}}function Bt(n){let e=JSON.parse(JSON.stringify(n));e.value=e.value.toString(),e.assets===void 0&&(e.assets=[]);for(let t=0;t<e.assets.length;t++)e.assets[t].amount=e.assets[t].amount.toString();return e}const St="011d3364de07e5a26f0c4eef0852cddb387039a921b7154ef3cab22c6eda887f";async function it(){let t=(await(await fetch(`https://api.ergoplatform.com/api/v1/boxes/unspent/byTokenId/${St}`)).json()).items[0];return t=Bt(t),t}async function Dt(n,e,t,s,l,c,a){const o=De.fromBase58(n),r=De.fromBase58(c),i=1372200,y=10n**18n/a,f=new Date().toISOString().split("T")[0],j=(1/(await it()).additionalRegisters.R4.renderedValue*10**9).toFixed(2),b={name:l.name,description:`Erg price: $${j}, date: ${f}, unlock: 2024-10-15`,sha256:l.sha256,url:`ipfs://${l.cid}`},I=new Le(Ve,pt).addTokens(s).setAdditionalRegisters({R4:st(y).toHex(),R5:lt(i).toHex(),R6:Oe(He(Ae(o.getPublicKeys()))).toHex(),R7:Oe(He(Ae(r.getPublicKeys()))).toHex()}),v=new Le(Ve,n).mintToken({amount:"1",name:l.name}).setAdditionalRegisters(ot(b));return new nt(t).from([...e]).to([I,v]).sendChangeTo(o).payFee(at*2n).build().toEIP12Object()}async function Lt(n,e,t,s,l,c){const a=De.fromBase58(n),o=De.fromBase58(l),r=1372200,i=10n**18n/c,y=new Date().toISOString().split("T")[0],f=BigInt(s.price*10**9),j=(1/(await it()).additionalRegisters.R4.renderedValue*10**9).toFixed(2),b={name:s.name,description:`Erg price: $${j}, date: ${y}, unlock: 2024-10-15`,sha256:s.sha256,url:`ipfs://${s.cid}`},I=new Le(f,ft).setAdditionalRegisters({R4:st(i).toHex(),R5:lt(r).toHex(),R6:Oe(He(Ae(a.getPublicKeys()))).toHex(),R7:Oe(He(Ae(o.getPublicKeys()))).toHex()}),v=new Le(Ve,n).mintToken({amount:"1",name:s.name}).setAdditionalRegisters(ot(b));return new nt(t).from([...e]).to([I,v]).sendChangeTo(a).payFee(at).build().toEIP12Object()}function Ot(n){let e,t,s,l=n[1].price+"",c,a,o,r,i,y,f="hodlERG3",m,u,j,b,I="ERG",v,w;return{c(){e=g("div"),t=g("button"),s=B("Lock "),c=B(l),a=z(),o=B(n[0]),r=z(),i=g("div"),y=g("button"),y.textContent=f,m=z(),u=g("div"),j=z(),b=g("button"),b.textContent=I,this.h()},l(E){e=_(E,"DIV",{class:!0});var x=k(e);t=_(x,"BUTTON",{class:!0,style:!0});var T=k(t);s=S(T,"Lock "),c=S(T,l),a=$(T),o=S(T,n[0]),T.forEach(h),r=$(x),i=_(x,"DIV",{class:!0});var C=k(i);y=_(C,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),U(y)!=="svelte-10vmmzh"&&(y.textContent=f),m=$(C),u=_(C,"DIV",{style:!0}),k(u).forEach(h),j=$(C),b=_(C,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),U(b)!=="svelte-1yk0jpa"&&(b.textContent=I),C.forEach(h),x.forEach(h),this.h()},h(){d(t,"class","btn p-4"),G(t,"width","230px"),d(y,"class","pl-4 pr-2 py-1 option-left text-sm svelte-16q2dwg"),G(y,"min-width","100px"),pe(y,"inactive",n[0]!="hodlERG3"),pe(y,"active",n[0]=="hodlERG3"),G(u,"height","100%"),G(u,"width","1px"),G(u,"background","gray"),d(b,"class","pr-4 pl-2 py-1 option-right text-sm svelte-16q2dwg"),G(b,"min-width","100px"),pe(b,"inactive",n[0]!="ERG"),pe(b,"active",n[0]=="ERG"),d(i,"class","flex mt-2"),d(e,"class","mt-4 p-4 box w-full flex flex-col items-center justify-center")},m(E,x){D(E,e,x),p(e,t),p(t,s),p(t,c),p(t,a),p(t,o),p(e,r),p(e,i),p(i,y),p(i,m),p(i,u),p(i,j),p(i,b),v||(w=[fe(t,"click",n[2]),fe(y,"click",n[4]),fe(b,"click",n[5])],v=!0)},p(E,[x]){x&2&&l!==(l=E[1].price+"")&&te(c,l),x&1&&te(o,E[0]),x&1&&pe(y,"inactive",E[0]!="hodlERG3"),x&1&&pe(y,"active",E[0]=="hodlERG3"),x&1&&pe(b,"inactive",E[0]!="ERG"),x&1&&pe(b,"active",E[0]=="ERG")},i:H,o:H,d(E){E&&h(e),v=!1,Ge(w)}}}function Ht(n,e){return n.some(t=>t.tokenId==e.tokenId)?(n.find(t=>t.tokenId==e.tokenId).amount+=e.amount,n):[...n,e]}function At(n,e,t){let s,l,c,a,o,r,i,y;N(n,rt,v=>t(3,s=v)),N(n,Ne,v=>t(9,l=v)),N(n,Be,v=>t(0,c=v)),N(n,me,v=>t(1,a=v)),N(n,_e,v=>t(10,o=v)),N(n,Se,v=>t(11,r=v)),N(n,Me,v=>t(12,i=v)),N(n,Ke,v=>t(13,y=v));let f=[];async function m(v){var w;if((w=window.ergoConnector[v])!=null&&w.isConnected){const E=await ergo.get_utxos();Me.set(JSON.parse(JSON.stringify(E))),Ke.set(E.flatMap(x=>x.assets.map(T=>(T.amount=BigInt(T.amount),T))).reduce(Ht,[])),y.filter(x=>!f.some(T=>T.tokenId==x.tokenId))}}function u(){f=[]}async function j(){var K;if(!s||!((K=window.ergoConnector[s])!=null&&K.isConnected)){Ce("Connect a wallet.",1500);return}const v=await ergo.get_utxos(),w=BigInt(await ergo.get_balance()),E=v.flatMap(O=>O.assets).reduce((O,M)=>O+(M.tokenId==We?BigInt(M.amount):0n),0n),x=await ergo.get_change_address(),T=await ergo.get_current_height();let C;if(c=="ERG"){if(w<BigInt(a.price*10**9)){Ce("Not enough Erg.",1500);return}C=await Lt(x,i,T,a,r,o)}else{if(E<BigInt(a.price*10**9)){Ce("Not enough Tokens.",1500);return}const O={tokenId:We,amount:a.price*10**9+""};C=await Dt(x,i,T,O,a,r,o)}const X=await ergo.sign_tx(C);console.log(X);const re=await ergo.submit_tx(X);console.log("transactionId:",re),Ce("Transaction submitted",3e3);const V={treasure:a,currency:c,hodler:x,tx:X,transactionId:re};Ne.update(O=>(O.push(V),O)),localStorage.setItem("ergo_bay_unconfirmed_mints",JSON.stringify(l)),u()}const b=()=>Be.set("hodlERG3"),I=()=>Be.set("ERG");return n.$$.update=()=>{n.$$.dirty&8&&m(s)},[c,a,j,s,b,I]}class Pt extends Q{constructor(e){super(),Z(this,e,At,Ot,Y,{})}}function Vt(n){let e,t,s='<img src="ship.png" alt=""/>',l,c,a='<img src="chest/bitmasks/icon.png" alt=""/>',o,r,i='<img src="chest/walrus/icon.png" alt="" style="width: 42px;"/>',y,f;return{c(){e=g("div"),t=g("button"),t.innerHTML=s,l=z(),c=g("button"),c.innerHTML=a,o=z(),r=g("button"),r.innerHTML=i,this.h()},l(m){e=_(m,"DIV",{class:!0});var u=k(e);t=_(u,"BUTTON",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-1qhbbbx"&&(t.innerHTML=s),l=$(u),c=_(u,"BUTTON",{class:!0,"data-svelte-h":!0}),U(c)!=="svelte-p0dv1p"&&(c.innerHTML=a),o=$(u),r=_(u,"BUTTON",{class:!0,"data-svelte-h":!0}),U(r)!=="svelte-fe3fay"&&(r.innerHTML=i),u.forEach(h),this.h()},h(){d(t,"class","enlarge border rounded-xl w-12 h-12 svelte-1rtdyum"),d(c,"class","enlarge border rounded-xl w-12 h-12 svelte-1rtdyum"),d(r,"class","enlarge border rounded-xl w-12 h-12 svelte-1rtdyum"),d(e,"class","fixed flex flex-col left-0 top-0 mt-24 ml-4 gap-2")},m(m,u){D(m,e,u),p(e,t),p(e,l),p(e,c),p(e,o),p(e,r),y||(f=[fe(t,"click",n[1]),fe(c,"click",n[2]),fe(r,"click",n[3])],y=!0)},p:H,i:H,o:H,d(m){m&&h(e),y=!1,Ge(f)}}}function Nt(n,e,t){let s;N(n,ze,r=>t(4,s=r));function l(r){r=="hodlbox"&&(_e.set(ut),Se.set(dt),ze.set(ht),me.set(s[0])),r=="bitmasks"&&(_e.set(mt),Se.set(vt),ze.set(gt),me.set(s[0])),r=="walrus"&&(_e.set(_t),Se.set(yt),ze.set(bt),me.set(s[0]))}return[l,()=>l("hodlbox"),()=>l("bitmasks"),()=>l("walrus")]}class Gt extends Q{constructor(e){super(),Z(this,e,Nt,Vt,Y,{})}}function Ut(n){let e,t,s="unlock: 2024-10-15",l,c,a=n[0].name.split(" ")[0]+"",o,r,i,y,f=Number(n[2]/10n**9n).toFixed(2)+"",m,u,j,b,I,v,w,E,x,T,C,X,re,V,K,O,M,ue,de,oe;return{c(){e=g("div"),t=g("div"),t.textContent=s,l=z(),c=g("div"),o=B(a),r=z(),i=g("div"),y=B("$"),m=B(f),u=B("/ERG"),j=z(),b=g("div"),I=g("button"),v=Te("svg"),w=Te("path"),T=z(),C=g("img"),re=z(),V=g("button"),K=Te("svg"),O=Te("path"),this.h()},l(R){e=_(R,"DIV",{class:!0});var L=k(e);t=_(L,"DIV",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-1whik13"&&(t.textContent=s),l=$(L),c=_(L,"DIV",{class:!0});var ve=k(c);o=S(ve,a),ve.forEach(h),r=$(L),i=_(L,"DIV",{class:!0});var ie=k(i);y=S(ie,"$"),m=S(ie,f),u=S(ie,"/ERG"),ie.forEach(h),L.forEach(h),j=$(R),b=_(R,"DIV",{class:!0});var W=k(b);I=_(W,"BUTTON",{style:!0});var ee=k(I);v=Re(ee,"svg",{xmlns:!0,viewBox:!0});var be=k(v);w=Re(be,"path",{fill:!0,d:!0}),k(w).forEach(h),be.forEach(h),ee.forEach(h),T=$(W),C=_(W,"IMG",{src:!0,alt:!0}),re=$(W),V=_(W,"BUTTON",{style:!0});var he=k(V);K=Re(he,"svg",{xmlns:!0,viewBox:!0});var J=k(K);O=Re(J,"path",{fill:!0,d:!0}),k(O).forEach(h),J.forEach(h),he.forEach(h),W.forEach(h),this.h()},h(){d(t,"class","italic text-slate-300"),d(c,"class","text-7xl font-bold text-white"),d(i,"class","text-slate-200"),d(e,"class","flex flex-col items-center"),d(w,"fill",E=n[0].id==0?"#CCC3":"#CCCD"),d(w,"d","M3 12l18-12v24z"),d(v,"xmlns","http://www.w3.org/2000/svg"),d(v,"viewBox","0 0 24 24"),I.disabled=x=n[0].id==0,G(I,"width","100px"),G(I,"height","100px"),ye(C.src,X=n[0].img)||d(C,"src",X),d(C,"alt",""),d(O,"fill",M=n[0].id==n[1].length-1?"#CCC3":"#CCCD"),d(O,"d","M21 12l-18 12v-24z"),d(K,"xmlns","http://www.w3.org/2000/svg"),d(K,"viewBox","0 0 24 24"),V.disabled=ue=n[0].id==n[1].length-1,G(V,"width","100px"),G(V,"height","100px"),d(b,"class","flex items-center gap-4")},m(R,L){D(R,e,L),p(e,t),p(e,l),p(e,c),p(c,o),p(e,r),p(e,i),p(i,y),p(i,m),p(i,u),D(R,j,L),D(R,b,L),p(b,I),p(I,v),p(v,w),p(b,T),p(b,C),p(b,re),p(b,V),p(V,K),p(K,O),de||(oe=[fe(I,"click",n[3]),fe(V,"click",n[4])],de=!0)},p(R,[L]){L&1&&a!==(a=R[0].name.split(" ")[0]+"")&&te(o,a),L&4&&f!==(f=Number(R[2]/10n**9n).toFixed(2)+"")&&te(m,f),L&1&&E!==(E=R[0].id==0?"#CCC3":"#CCCD")&&d(w,"fill",E),L&1&&x!==(x=R[0].id==0)&&(I.disabled=x),L&1&&!ye(C.src,X=R[0].img)&&d(C,"src",X),L&3&&M!==(M=R[0].id==R[1].length-1?"#CCC3":"#CCCD")&&d(O,"fill",M),L&3&&ue!==(ue=R[0].id==R[1].length-1)&&(V.disabled=ue)},i:H,o:H,d(R){R&&(h(e),h(j),h(b)),de=!1,Ge(oe)}}}function Ft(n,e,t){let s,l,c;N(n,me,r=>t(0,s=r)),N(n,ze,r=>t(1,l=r)),N(n,_e,r=>t(2,c=r));function a(){s.id>0&&me.set(l[s.id-1])}function o(){s.id<l.length-1&&me.set(l[s.id+1])}return[s,l,c,a,o]}class Mt extends Q{constructor(e){super(),Z(this,e,Ft,Ut,Y,{})}}function Kt(n){let e,t,s,l,c,a,o;return t=new Gt({}),l=new Mt({}),a=new Pt({}),{c(){e=g("div"),se(t.$$.fragment),s=z(),se(l.$$.fragment),c=z(),se(a.$$.fragment),this.h()},l(r){e=_(r,"DIV",{class:!0,style:!0});var i=k(e);le(t.$$.fragment,i),s=$(i),le(l.$$.fragment,i),c=$(i),le(a.$$.fragment,i),i.forEach(h),this.h()},h(){d(e,"class","bg-main grow flex flex-col justify-center items-center gap-5 svelte-1dohqtu"),G(e,"padding-top","80px")},m(r,i){D(r,e,i),ne(t,e,null),p(e,s),ne(l,e,null),p(e,c),ne(a,e,null),o=!0},p:H,i(r){o||(P(t.$$.fragment,r),P(l.$$.fragment,r),P(a.$$.fragment,r),o=!0)},o(r){F(t.$$.fragment,r),F(l.$$.fragment,r),F(a.$$.fragment,r),o=!1},d(r){r&&h(e),ae(t),ae(l),ae(a)}}}class Wt extends Q{constructor(e){super(),Z(this,e,null,Kt,Y,{})}}function qt(n){let e,t,s,l,c,a=n[0].treasure.name+"",o,r,i,y,f=n[0].hodler.substr(0,3)+"",m,u,j=n[0].hodler.substr(n[0].hodler.length-3,n[0].hodler.length-1)+"",b,I;return{c(){e=g("div"),t=g("img"),l=z(),c=g("div"),o=B(a),r=z(),i=g("div"),y=g("a"),m=B(f),u=B("..."),b=B(j),this.h()},l(v){e=_(v,"DIV",{class:!0});var w=k(e);t=_(w,"IMG",{src:!0,alt:!0,style:!0}),l=$(w),c=_(w,"DIV",{class:!0});var E=k(c);o=S(E,a),E.forEach(h),r=$(w),i=_(w,"DIV",{class:!0});var x=k(i);y=_(x,"A",{href:!0});var T=k(y);m=S(T,f),u=S(T,"..."),b=S(T,j),T.forEach(h),x.forEach(h),w.forEach(h),this.h()},h(){ye(t.src,s=n[0].treasure.img)||d(t,"src",s),d(t,"alt",""),G(t,"width","200px"),G(t,"height","auto"),d(c,"class","flex gap-2"),d(y,"href",I="https://explorer.ergoplatform.com/en/addresses/"+n[0].hodler),d(i,"class","text-slate-500"),d(e,"class","p-4 flex flex-col justify-center items-center")},m(v,w){D(v,e,w),p(e,t),p(e,l),p(e,c),p(c,o),p(e,r),p(e,i),p(i,y),p(y,m),p(y,u),p(y,b)},p(v,[w]){w&1&&!ye(t.src,s=v[0].treasure.img)&&d(t,"src",s),w&1&&a!==(a=v[0].treasure.name+"")&&te(o,a),w&1&&f!==(f=v[0].hodler.substr(0,3)+"")&&te(m,f),w&1&&j!==(j=v[0].hodler.substr(v[0].hodler.length-3,v[0].hodler.length-1)+"")&&te(b,j),w&1&&I!==(I="https://explorer.ergoplatform.com/en/addresses/"+v[0].hodler)&&d(y,"href",I)},i:H,o:H,d(v){v&&h(e)}}}function Xt(n,e,t){N(n,rt,l=>t(1,l));let{offer:s}=e;return n.$$set=l=>{"offer"in l&&t(0,s=l.offer)},[s]}class Jt extends Q{constructor(e){super(),Z(this,e,Xt,qt,Y,{offer:0})}}function qe(n,e,t){const s=n.slice();return s[1]=e[t],s}function Xe(n){let e,t;return e=new Jt({props:{offer:n[1]}}),{c(){se(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,l){ne(e,s,l),t=!0},p(s,l){const c={};l&1&&(c.offer=s[1]),e.$set(c)},i(s){t||(P(e.$$.fragment,s),t=!0)},o(s){F(e.$$.fragment,s),t=!1},d(s){ae(e,s)}}}function Yt(n){let e,t="Locked Boxes",s,l,c,a,o,r=Pe(n[0].filter(Je)),i=[];for(let f=0;f<r.length;f+=1)i[f]=Xe(qe(n,r,f));const y=f=>F(i[f],1,1,()=>{i[f]=null});return{c(){e=g("h2"),e.textContent=t,s=z(),l=g("div");for(let f=0;f<i.length;f+=1)i[f].c();c=z(),a=g("div"),this.h()},l(f){e=_(f,"H2",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-3iv0hq"&&(e.textContent=t),s=$(f),l=_(f,"DIV",{class:!0});var m=k(l);for(let u=0;u<i.length;u+=1)i[u].l(m);m.forEach(h),c=$(f),a=_(f,"DIV",{class:!0}),k(a).forEach(h),this.h()},h(){d(e,"class","text-4xl"),d(l,"class","w-full justify-center flex flex-wrap"),d(a,"class","mb-10")},m(f,m){D(f,e,m),D(f,s,m),D(f,l,m);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(l,null);D(f,c,m),D(f,a,m),o=!0},p(f,[m]){if(m&1){r=Pe(f[0].filter(Je));let u;for(u=0;u<r.length;u+=1){const j=qe(f,r,u);i[u]?(i[u].p(j,m),P(i[u],1)):(i[u]=Xe(j),i[u].c(),P(i[u],1),i[u].m(l,null))}for(Ze(),u=r.length;u<i.length;u+=1)y(u);et()}},i(f){if(!o){for(let m=0;m<r.length;m+=1)P(i[m]);o=!0}},o(f){i=i.filter(Boolean);for(let m=0;m<i.length;m+=1)F(i[m]);o=!1},d(f){f&&(h(e),h(s),h(l),h(c),h(a)),tt(i,f)}}}const Je=n=>n.currency;function Qt(n,e,t){let s;return N(n,xt,l=>t(0,s=l)),[s]}class Zt extends Q{constructor(e){super(),Z(this,e,Qt,Yt,Y,{})}}function es(n){let e,t,s,l,c,a,o="minting...",r,i,y,f;return{c(){e=g("div"),t=g("img"),l=z(),c=g("div"),a=g("div"),a.textContent=o,r=z(),i=g("a"),y=B("transactionID"),this.h()},l(m){e=_(m,"DIV",{class:!0});var u=k(e);t=_(u,"IMG",{src:!0,alt:!0,style:!0,class:!0}),l=$(u),c=_(u,"DIV",{class:!0});var j=k(c);a=_(j,"DIV",{"data-svelte-h":!0}),U(a)!=="svelte-15f54we"&&(a.textContent=o),r=$(j),i=_(j,"A",{target:!0,href:!0,class:!0});var b=k(i);y=S(b,"transactionID"),b.forEach(h),j.forEach(h),u.forEach(h),this.h()},h(){ye(t.src,s=n[0].treasure.img)||d(t,"src",s),d(t,"alt",""),G(t,"width","200px"),d(t,"class","blink svelte-1m6gc3r"),d(i,"target","_blank"),d(i,"href",f="https://explorer.ergoplatform.com/en/transactions/"+n[0].transactionId),d(i,"class","underline"),d(c,"class",""),d(e,"class","p-4 flex flex-col items-center")},m(m,u){D(m,e,u),p(e,t),p(e,l),p(e,c),p(c,a),p(c,r),p(c,i),p(i,y)},p(m,[u]){u&1&&!ye(t.src,s=m[0].treasure.img)&&d(t,"src",s),u&1&&f!==(f="https://explorer.ergoplatform.com/en/transactions/"+m[0].transactionId)&&d(i,"href",f)},i:H,o:H,d(m){m&&h(e)}}}function ts(n,e,t){let{mint:s}=e;return n.$$set=l=>{"mint"in l&&t(0,s=l.mint)},[s]}class ss extends Q{constructor(e){super(),Z(this,e,ts,es,Y,{mint:0})}}function Ye(n,e,t){const s=n.slice();return s[1]=e[t],s}function Qe(n){let e,t;return e=new ss({props:{mint:n[1]}}),{c(){se(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,l){ne(e,s,l),t=!0},p(s,l){const c={};l&1&&(c.mint=s[1]),e.$set(c)},i(s){t||(P(e.$$.fragment,s),t=!0)},o(s){F(e.$$.fragment,s),t=!1},d(s){ae(e,s)}}}function ls(n){let e,t,s=Pe(n[0]),l=[];for(let a=0;a<s.length;a+=1)l[a]=Qe(Ye(n,s,a));const c=a=>F(l[a],1,1,()=>{l[a]=null});return{c(){for(let a=0;a<l.length;a+=1)l[a].c();e=Fe()},l(a){for(let o=0;o<l.length;o+=1)l[o].l(a);e=Fe()},m(a,o){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(a,o);D(a,e,o),t=!0},p(a,[o]){if(o&1){s=Pe(a[0]);let r;for(r=0;r<s.length;r+=1){const i=Ye(a,s,r);l[r]?(l[r].p(i,o),P(l[r],1)):(l[r]=Qe(i),l[r].c(),P(l[r],1),l[r].m(e.parentNode,e))}for(Ze(),r=s.length;r<l.length;r+=1)c(r);et()}},i(a){if(!t){for(let o=0;o<s.length;o+=1)P(l[o]);t=!0}},o(a){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)F(l[o]);t=!1},d(a){a&&h(e),tt(l,a)}}}function ns(n,e,t){let s;return N(n,Ne,l=>t(0,s=l)),[s]}class as extends Q{constructor(e){super(),Z(this,e,ns,ls,Y,{})}}function rs(n){let e,t,s,l,c;return t=new as({}),l=new Zt({}),{c(){e=g("div"),se(t.$$.fragment),s=z(),se(l.$$.fragment),this.h()},l(a){e=_(a,"DIV",{class:!0,style:!0});var o=k(e);le(t.$$.fragment,o),s=$(o),le(l.$$.fragment,o),o.forEach(h),this.h()},h(){d(e,"class","bg-main grow flex flex-col items-center gap-5 svelte-itl043"),G(e,"padding-top","80px")},m(a,o){D(a,e,o),ne(t,e,null),p(e,s),ne(l,e,null),c=!0},p:H,i(a){c||(P(t.$$.fragment,a),P(l.$$.fragment,a),c=!0)},o(a){F(t.$$.fragment,a),F(l.$$.fragment,a),c=!1},d(a){a&&h(e),ae(t),ae(l)}}}class os extends Q{constructor(e){super(),Z(this,e,null,rs,Y,{})}}function is(n){let e,t,s,l,c,a;return e=new Wt({}),s=new Rt({}),c=new os({}),{c(){se(e.$$.fragment),t=z(),se(s.$$.fragment),l=z(),se(c.$$.fragment)},l(o){le(e.$$.fragment,o),t=$(o),le(s.$$.fragment,o),l=$(o),le(c.$$.fragment,o)},m(o,r){ne(e,o,r),D(o,t,r),ne(s,o,r),D(o,l,r),ne(c,o,r),a=!0},i(o){a||(P(e.$$.fragment,o),P(s.$$.fragment,o),P(c.$$.fragment,o),a=!0)},o(o){F(e.$$.fragment,o),F(s.$$.fragment,o),F(c.$$.fragment,o),a=!1},d(o){o&&(h(t),h(l)),ae(e,o),ae(s,o),ae(c,o)}}}function cs(n){let e,t='<img class="unselectable" src="ship.png" style="width:250px;" alt=""/> <div class="font-mono mt-4">loading...</div>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(s){e=_(s,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-83we0i"&&(e.innerHTML=t),this.h()},h(){d(e,"class","grow flex flex-col items-center justify-center")},m(s,l){D(s,e,l)},i:H,o:H,d(s){s&&h(e)}}}function ps(n){let e,t,s,l;const c=[cs,is],a=[];function o(r,i){return 1}return t=o(),s=a[t]=c[t](n),{c(){e=g("div"),s.c(),this.h()},l(r){e=_(r,"DIV",{class:!0});var i=k(e);s.l(i),i.forEach(h),this.h()},h(){d(e,"class","h-full flex flex-col grow main-page svelte-12hevi9")},m(r,i){D(r,e,i),a[t].m(e,null),l=!0},p:H,i(r){l||(P(s),l=!0)},o(r){F(s),l=!1},d(r){r&&h(e),a[t].d()}}}function fs(n){ct(e);function e(){wt(),kt()}return[]}class ms extends Q{constructor(e){super(),Z(this,e,fs,ps,Y,{})}}export{ms as component};
