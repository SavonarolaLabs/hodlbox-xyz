import{s as L,n as S,r as Be,j as H,l as z,o as Ue}from"../chunks/scheduler.71af12de.js";import{S as M,i as U,g as E,m as N,s as I,h as k,j as y,n as V,c as B,f as m,A as ae,k as f,l as D,E as j,a as T,y as g,x as ee,o as te,F as se,G as re,r as F,u as q,v as J,d as C,t as A,w as W,p as Te,b as De,H as Se,e as $e}from"../chunks/index.e9246ef9.js";import{S as X,a as Q,b as Y,c as Z,E as ie,O as ce,f as he,C as Pe,g as Ae,h as Oe,i as ue,j as fe,k as de,T as Ge,R as He,D as Ne,l as je,s as Ve,m as _e,p as me,q as oe,r as be,t as xe,v as le,H as we,A as K,e as ge,x as Fe,y as qe,z as Je}from"../chunks/notifier.6362f670.js";function Le(l){return We(l.name,l.description,l.sha256,l.url)}function We(l,e,t,n){return{R4:X(Q(Y,Z("utf8",l))),R5:X(Q(Y,Z("utf8",e))),R6:X(Q(Y,Z("utf8","0"))),R7:"0e020101",R8:X(Q(Y,Z("hex",t))),R9:X(Q(Y,Z("utf8",n)))}}function Ke(l){let e=JSON.parse(JSON.stringify(l));e.value=e.value.toString(),e.assets===void 0&&(e.assets=[]);for(let t=0;t<e.assets.length;t++)e.assets[t].amount=e.assets[t].amount.toString();return e}const ze="011d3364de07e5a26f0c4eef0852cddb387039a921b7154ef3cab22c6eda887f";async function Me(){let t=(await(await fetch(`https://api.ergoplatform.com/api/v1/boxes/unspent/byTokenId/${ze}`)).json()).items[0];return t=Ke(t),t}async function Xe(l,e,t,n,s,r=Ne){const o=ie.fromBase58(l),a=ie.fromBase58(r),i=1372200,c=20000000000n,h=10n**18n/c,b=new Date().toISOString().split("T")[0],R=(1/(await Me()).additionalRegisters.R4.renderedValue*10**9).toFixed(2),u={name:s.name,description:`Erg price: $${R}, date: ${b}, unlock: 2024-10-15`,sha256:s.sha256,url:`ipfs://${s.cid}`},p=new ce(he,Pe).addTokens(n).setAdditionalRegisters({R4:Ae(h).toHex(),R5:Oe(i).toHex(),R6:ue(fe(de(o.getPublicKeys()))).toHex(),R7:ue(fe(de(a.getPublicKeys()))).toHex()}),$=new ce(he,l).mintToken({amount:"1",name:s.name}).setAdditionalRegisters(Le(u));return new Ge(t).from([...e]).to([p,$]).sendChangeTo(o).payFee(He*2n).build().toEIP12Object()}async function Qe(l,e,t,n,s=Ne){const r=ie.fromBase58(l),o=ie.fromBase58(s),a=20000000000n,i=10n**18n/a,c=1113026,h=new Date().toISOString().split("T")[0],b=BigInt(n.price*10**9),R=(1/(await Me()).additionalRegisters.R4.renderedValue*10**9).toFixed(2),u={name:n.name,description:`Erg price: $${R}, date: ${h}, unlock: 2024-10-15`,sha256:n.sha256,url:`ipfs://${n.cid}`},p=new ce(b,je).setAdditionalRegisters({R4:Ae(i).toHex(),R5:Oe(c).toHex(),R6:ue(fe(de(r.getPublicKeys()))).toHex(),R7:ue(fe(de(o.getPublicKeys()))).toHex()}),$=new ce(he,l).mintToken({amount:"1",name:n.name}).setAdditionalRegisters(Le(u));return new Ge(t).from([...e]).to([p,$]).sendChangeTo(r).payFee(He).build().toEIP12Object()}function Ye(l){let e,t,n,s=l[1].price+"",r,o,a,i,c,h,b="hodlERG3",v,_,R,u,p="ERG",$,x;return{c(){e=E("div"),t=E("button"),n=N("Lock "),r=N(s),o=I(),a=N(l[0]),i=I(),c=E("div"),h=E("button"),h.textContent=b,v=I(),_=E("div"),R=I(),u=E("button"),u.textContent=p,this.h()},l(d){e=k(d,"DIV",{class:!0});var w=y(e);t=k(w,"BUTTON",{class:!0,style:!0});var O=y(t);n=V(O,"Lock "),r=V(O,s),o=B(O),a=V(O,l[0]),O.forEach(m),i=B(w),c=k(w,"DIV",{class:!0});var G=y(c);h=k(G,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(h)!=="svelte-1c2gdrs"&&(h.textContent=b),v=B(G),_=k(G,"DIV",{style:!0}),y(_).forEach(m),R=B(G),u=k(G,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(u)!=="svelte-ca9bet"&&(u.textContent=p),G.forEach(m),w.forEach(m),this.h()},h(){f(t,"class","btn p-4"),D(t,"width","230px"),f(h,"class","pl-4 pr-2 py-1 option-left svelte-16q2dwg"),j(h,"inactive",l[0]!="hodlERG3"),j(h,"active",l[0]=="hodlERG3"),D(_,"height","100%"),D(_,"width","1px"),D(_,"background","gray"),f(u,"class","pr-4 pl-2 py-1 option-right svelte-16q2dwg"),j(u,"inactive",l[0]!="ERG"),j(u,"active",l[0]=="ERG"),f(c,"class","flex mt-2"),f(e,"class","mt-4 p-4 box w-full flex flex-col items-center justify-center")},m(d,w){T(d,e,w),g(e,t),g(t,n),g(t,r),g(t,o),g(t,a),g(e,i),g(e,c),g(c,h),g(c,v),g(c,_),g(c,R),g(c,u),$||(x=[ee(t,"click",l[2]),ee(h,"click",l[4]),ee(u,"click",l[5])],$=!0)},p(d,[w]){w&2&&s!==(s=d[1].price+"")&&te(r,s),w&1&&te(a,d[0]),w&1&&j(h,"inactive",d[0]!="hodlERG3"),w&1&&j(h,"active",d[0]=="hodlERG3"),w&1&&j(u,"inactive",d[0]!="ERG"),w&1&&j(u,"active",d[0]=="ERG")},i:S,o:S,d(d){d&&m(e),$=!1,Be(x)}}}function Ze(l,e){return l.some(t=>t.tokenId==e.tokenId)?(l.find(t=>t.tokenId==e.tokenId).amount+=e.amount,l):[...l,e]}function et(l,e,t){let n,s,r,o,a,i;H(l,Ve,u=>t(3,n=u)),H(l,_e,u=>t(9,s=u)),H(l,me,u=>t(0,r=u)),H(l,oe,u=>t(1,o=u)),H(l,be,u=>t(10,a=u)),H(l,xe,u=>t(11,i=u));let c=[];async function h(u){var p;if((p=window.ergoConnector[u])!=null&&p.isConnected){const $=await ergo.get_utxos();be.set(JSON.parse(JSON.stringify($))),xe.set($.flatMap(x=>x.assets.map(d=>(d.amount=BigInt(d.amount),d))).reduce(Ze,[])),i.filter(x=>!c.some(d=>d.tokenId==x.tokenId))}}function b(){c=[]}async function v(){var pe;if(!n||!((pe=window.ergoConnector[n])!=null&&pe.isConnected)){le("Connect a wallet.",1500);return}const u=await ergo.get_utxos(),p=BigInt(await ergo.get_balance()),$=u.flatMap(P=>P.assets).reduce((P,ve)=>P+(ve.tokenId==we?BigInt(ve.amount):0n),0n),x=await ergo.get_change_address(),d=await ergo.get_current_height();let w;if(r=="ERG"){if(p<BigInt(o.price*10**9)){le("Not enough Erg.",1500);return}w=await Qe(x,a,d,o)}else{if($<BigInt(o.price*10**9)){le("Not enough Tokens.",1500);return}const P={tokenId:we,amount:o.price*10**9+""};w=await Xe(x,a,d,P,o)}const O=await ergo.sign_tx(w);console.log(O);const G=await ergo.submit_tx(O);console.log("transactionId:",G),le("Transaction submitted",3e3);const ne={treasure:o,currency:r,hodler:x,tx:O,transactionId:G};_e.update(P=>(P.push(ne),P)),localStorage.setItem("ergo_bay_unconfirmed_mints",JSON.stringify(s)),b()}const _=()=>me.set("hodlERG3"),R=()=>me.set("ERG");return l.$$.update=()=>{l.$$.dirty&8&&h(n)},[r,o,v,n,_,R]}class tt extends M{constructor(e){super(),U(this,e,et,Ye,L,{})}}function nt(l){let e,t,n,s,r,o,a,i,c,h,b,v,_,R,u,p,$;return{c(){e=E("div"),t=E("button"),n=se("svg"),s=se("path"),a=I(),i=E("img"),h=I(),b=E("button"),v=se("svg"),_=se("path"),this.h()},l(x){e=k(x,"DIV",{class:!0});var d=y(e);t=k(d,"BUTTON",{style:!0});var w=y(t);n=re(w,"svg",{xmlns:!0,viewBox:!0});var O=y(n);s=re(O,"path",{fill:!0,d:!0}),y(s).forEach(m),O.forEach(m),w.forEach(m),a=B(d),i=k(d,"IMG",{src:!0,alt:!0}),h=B(d),b=k(d,"BUTTON",{style:!0});var G=y(b);v=re(G,"svg",{xmlns:!0,viewBox:!0});var ne=y(v);_=re(ne,"path",{fill:!0,d:!0}),y(_).forEach(m),ne.forEach(m),G.forEach(m),d.forEach(m),this.h()},h(){f(s,"fill",r=l[0].id==0?"#CCC3":"#CCCD"),f(s,"d","M3 12l18-12v24z"),f(n,"xmlns","http://www.w3.org/2000/svg"),f(n,"viewBox","0 0 24 24"),t.disabled=o=l[0].id==0,D(t,"width","100px"),D(t,"height","100px"),z(i.src,c=l[0].img)||f(i,"src",c),f(i,"alt",""),f(_,"fill",R=l[0].id==K.length-1?"#CCC3":"#CCCD"),f(_,"d","M21 12l-18 12v-24z"),f(v,"xmlns","http://www.w3.org/2000/svg"),f(v,"viewBox","0 0 24 24"),b.disabled=u=l[0].id==K.length-1,D(b,"width","100px"),D(b,"height","100px"),f(e,"class","flex items-center gap-4")},m(x,d){T(x,e,d),g(e,t),g(t,n),g(n,s),g(e,a),g(e,i),g(e,h),g(e,b),g(b,v),g(v,_),p||($=[ee(t,"click",l[1]),ee(b,"click",l[2])],p=!0)},p(x,[d]){d&1&&r!==(r=x[0].id==0?"#CCC3":"#CCCD")&&f(s,"fill",r),d&1&&o!==(o=x[0].id==0)&&(t.disabled=o),d&1&&!z(i.src,c=x[0].img)&&f(i,"src",c),d&1&&R!==(R=x[0].id==K.length-1?"#CCC3":"#CCCD")&&f(_,"fill",R),d&1&&u!==(u=x[0].id==K.length-1)&&(b.disabled=u)},i:S,o:S,d(x){x&&m(e),p=!1,Be($)}}}function st(l,e,t){let n;H(l,oe,o=>t(0,n=o));function s(){n.id>0&&oe.set(K[n.id-1])}function r(){n.id<K.length-1&&oe.set(K[n.id+1])}return[n,s,r]}class rt extends M{constructor(e){super(),U(this,e,st,nt,L,{})}}function lt(l){let e,t,n,s,r;return t=new rt({}),s=new tt({}),{c(){e=E("div"),F(t.$$.fragment),n=I(),F(s.$$.fragment),this.h()},l(o){e=k(o,"DIV",{class:!0,style:!0});var a=y(e);q(t.$$.fragment,a),n=B(a),q(s.$$.fragment,a),a.forEach(m),this.h()},h(){f(e,"class","bg-main grow flex flex-col justify-center items-center gap-5 svelte-1k74agk"),D(e,"padding-top","80px")},m(o,a){T(o,e,a),J(t,e,null),g(e,n),J(s,e,null),r=!0},p:S,i(o){r||(C(t.$$.fragment,o),C(s.$$.fragment,o),r=!0)},o(o){A(t.$$.fragment,o),A(s.$$.fragment,o),r=!1},d(o){o&&m(e),W(t),W(s)}}}class ot extends M{constructor(e){super(),U(this,e,null,lt,L,{})}}function Ee(l){let e=l[0].treasure.price+"",t,n;return{c(){t=N(e),n=N(" HodlERG3")},l(s){t=V(s,e),n=V(s," HodlERG3")},m(s,r){T(s,t,r),T(s,n,r)},p(s,r){r&1&&e!==(e=s[0].treasure.price+"")&&te(t,e)},d(s){s&&(m(t),m(n))}}}function at(l){let e,t,n,s,r,o,a,i,c=l[0].hodler.substr(0,3)+"",h,b,v=l[0].hodler.substr(l[0].hodler.length-3,l[0].hodler.length-1)+"",_,R,u=l[0].currency=="hodlERG3"&&Ee(l);return{c(){e=E("div"),t=E("img"),s=I(),r=E("div"),u&&u.c(),o=I(),a=E("div"),i=E("a"),h=N(c),b=N("..."),_=N(v),this.h()},l(p){e=k(p,"DIV",{class:!0});var $=y(e);t=k($,"IMG",{src:!0,alt:!0,style:!0}),s=B($),r=k($,"DIV",{class:!0});var x=y(r);u&&u.l(x),x.forEach(m),o=B($),a=k($,"DIV",{class:!0});var d=y(a);i=k(d,"A",{href:!0});var w=y(i);h=V(w,c),b=V(w,"..."),_=V(w,v),w.forEach(m),d.forEach(m),$.forEach(m),this.h()},h(){z(t.src,n=l[0].treasure.img)||f(t,"src",n),f(t,"alt",""),D(t,"width","200px"),D(t,"height","auto"),f(r,"class","flex gap-2"),f(i,"href",R="https://explorer.ergoplatform.com/en/addresses/"+l[0].hodler),f(a,"class","text-slate-500"),f(e,"class","p-4 w-full flex flex-col justify-center items-center")},m(p,$){T(p,e,$),g(e,t),g(e,s),g(e,r),u&&u.m(r,null),g(e,o),g(e,a),g(a,i),g(i,h),g(i,b),g(i,_)},p(p,[$]){$&1&&!z(t.src,n=p[0].treasure.img)&&f(t,"src",n),p[0].currency=="hodlERG3"?u?u.p(p,$):(u=Ee(p),u.c(),u.m(r,null)):u&&(u.d(1),u=null),$&1&&c!==(c=p[0].hodler.substr(0,3)+"")&&te(h,c),$&1&&v!==(v=p[0].hodler.substr(p[0].hodler.length-3,p[0].hodler.length-1)+"")&&te(_,v),$&1&&R!==(R="https://explorer.ergoplatform.com/en/addresses/"+p[0].hodler)&&f(i,"href",R)},i:S,o:S,d(p){p&&m(e),u&&u.d()}}}function it(l,e,t){H(l,Ve,s=>t(1,s));let{offer:n}=e;return l.$$set=s=>{"offer"in s&&t(0,n=s.offer)},[n]}class ct extends M{constructor(e){super(),U(this,e,it,at,L,{offer:0})}}function ke(l,e,t){const n=l.slice();return n[1]=e[t],n}function Re(l){let e,t;return e=new ct({props:{offer:l[1]}}),{c(){F(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,s){J(e,n,s),t=!0},p(n,s){const r={};s&1&&(r.offer=n[1]),e.$set(r)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function ut(l){let e,t,n,s=ge(l[0].filter(ye)),r=[];for(let a=0;a<s.length;a+=1)r[a]=Re(ke(l,s,a));const o=a=>A(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=I(),t=E("div"),this.h()},l(a){for(let i=0;i<r.length;i+=1)r[i].l(a);e=B(a),t=k(a,"DIV",{class:!0}),y(t).forEach(m),this.h()},h(){f(t,"class","mb-10")},m(a,i){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(a,i);T(a,e,i),T(a,t,i),n=!0},p(a,[i]){if(i&1){s=ge(a[0].filter(ye));let c;for(c=0;c<s.length;c+=1){const h=ke(a,s,c);r[c]?(r[c].p(h,i),C(r[c],1)):(r[c]=Re(h),r[c].c(),C(r[c],1),r[c].m(e.parentNode,e))}for(Te(),c=s.length;c<r.length;c+=1)o(c);De()}},i(a){if(!n){for(let i=0;i<s.length;i+=1)C(r[i]);n=!0}},o(a){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)A(r[i]);n=!1},d(a){a&&(m(e),m(t)),Se(r,a)}}}const ye=l=>l.currency;function ft(l,e,t){let n;return H(l,Fe,s=>t(0,n=s)),[n]}class dt extends M{constructor(e){super(),U(this,e,ft,ut,L,{})}}function gt(l){let e,t,n,s,r,o,a="minting...",i,c,h,b;return{c(){e=E("div"),t=E("img"),s=I(),r=E("div"),o=E("div"),o.textContent=a,i=I(),c=E("a"),h=N("transactionID"),this.h()},l(v){e=k(v,"DIV",{class:!0});var _=y(e);t=k(_,"IMG",{src:!0,alt:!0,style:!0,class:!0}),s=B(_),r=k(_,"DIV",{class:!0});var R=y(r);o=k(R,"DIV",{"data-svelte-h":!0}),ae(o)!=="svelte-15f54we"&&(o.textContent=a),i=B(R),c=k(R,"A",{target:!0,href:!0,class:!0});var u=y(c);h=V(u,"transactionID"),u.forEach(m),R.forEach(m),_.forEach(m),this.h()},h(){z(t.src,n=l[0].treasure.img)||f(t,"src",n),f(t,"alt",""),D(t,"width","200px"),f(t,"class","blink svelte-1m6gc3r"),f(c,"target","_blank"),f(c,"href",b="https://explorer.ergoplatform.com/en/transactions/"+l[0].transactionId),f(c,"class","underline"),f(r,"class",""),f(e,"class","p-4 flex flex-col items-center")},m(v,_){T(v,e,_),g(e,t),g(e,s),g(e,r),g(r,o),g(r,i),g(r,c),g(c,h)},p(v,[_]){_&1&&!z(t.src,n=v[0].treasure.img)&&f(t,"src",n),_&1&&b!==(b="https://explorer.ergoplatform.com/en/transactions/"+v[0].transactionId)&&f(c,"href",b)},i:S,o:S,d(v){v&&m(e)}}}function mt(l,e,t){let{mint:n}=e;return l.$$set=s=>{"mint"in s&&t(0,n=s.mint)},[n]}class ht extends M{constructor(e){super(),U(this,e,mt,gt,L,{mint:0})}}function Ce(l,e,t){const n=l.slice();return n[1]=e[t],n}function Ie(l){let e,t;return e=new ht({props:{mint:l[1]}}),{c(){F(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,s){J(e,n,s),t=!0},p(n,s){const r={};s&1&&(r.mint=n[1]),e.$set(r)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function _t(l){let e,t,n=ge(l[0]),s=[];for(let o=0;o<n.length;o+=1)s[o]=Ie(Ce(l,n,o));const r=o=>A(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=$e()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=$e()},m(o,a){for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(o,a);T(o,e,a),t=!0},p(o,[a]){if(a&1){n=ge(o[0]);let i;for(i=0;i<n.length;i+=1){const c=Ce(o,n,i);s[i]?(s[i].p(c,a),C(s[i],1)):(s[i]=Ie(c),s[i].c(),C(s[i],1),s[i].m(e.parentNode,e))}for(Te(),i=n.length;i<s.length;i+=1)r(i);De()}},i(o){if(!t){for(let a=0;a<n.length;a+=1)C(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)A(s[a]);t=!1},d(o){o&&m(e),Se(s,o)}}}function pt(l,e,t){let n;return H(l,_e,s=>t(0,n=s)),[n]}class vt extends M{constructor(e){super(),U(this,e,pt,_t,L,{})}}function $t(l){let e,t,n,s,r;return t=new vt({}),s=new dt({}),{c(){e=E("div"),F(t.$$.fragment),n=I(),F(s.$$.fragment),this.h()},l(o){e=k(o,"DIV",{class:!0,style:!0});var a=y(e);q(t.$$.fragment,a),n=B(a),q(s.$$.fragment,a),a.forEach(m),this.h()},h(){f(e,"class","bg-main grow flex flex-col items-center gap-5 svelte-1qg91mt"),D(e,"padding-top","80px")},m(o,a){T(o,e,a),J(t,e,null),g(e,n),J(s,e,null),r=!0},p:S,i(o){r||(C(t.$$.fragment,o),C(s.$$.fragment,o),r=!0)},o(o){A(t.$$.fragment,o),A(s.$$.fragment,o),r=!1},d(o){o&&m(e),W(t),W(s)}}}class bt extends M{constructor(e){super(),U(this,e,null,$t,L,{})}}function xt(l){let e,t,n,s;return e=new ot({}),n=new bt({}),{c(){F(e.$$.fragment),t=I(),F(n.$$.fragment)},l(r){q(e.$$.fragment,r),t=B(r),q(n.$$.fragment,r)},m(r,o){J(e,r,o),T(r,t,o),J(n,r,o),s=!0},i(r){s||(C(e.$$.fragment,r),C(n.$$.fragment,r),s=!0)},o(r){A(e.$$.fragment,r),A(n.$$.fragment,r),s=!1},d(r){r&&m(t),W(e,r),W(n,r)}}}function wt(l){let e,t='<img class="unselectable" src="ship.png" style="width:250px;" alt=""/> <div class="font-mono mt-4">loading...</div>';return{c(){e=E("div"),e.innerHTML=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-83we0i"&&(e.innerHTML=t),this.h()},h(){f(e,"class","grow flex flex-col items-center justify-center")},m(n,s){T(n,e,s)},i:S,o:S,d(n){n&&m(e)}}}function Et(l){let e,t,n,s;const r=[wt,xt],o=[];function a(i,c){return 1}return t=a(),n=o[t]=r[t](l),{c(){e=E("div"),n.c(),this.h()},l(i){e=k(i,"DIV",{class:!0});var c=y(e);n.l(c),c.forEach(m),this.h()},h(){f(e,"class","h-full flex flex-col grow main-page svelte-12hevi9")},m(i,c){T(i,e,c),o[t].m(e,null),s=!0},p:S,i(i){s||(C(n),s=!0)},o(i){A(n),s=!1},d(i){i&&m(e),o[t].d()}}}function kt(l){Ue(e);function e(){qe(),Je()}return[]}class It extends M{constructor(e){super(),U(this,e,kt,Et,L,{})}}export{It as component};
