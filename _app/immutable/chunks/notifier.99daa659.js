var En=Object.defineProperty;var vn=(e,t,n)=>t in e?En(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var d=(e,t,n)=>(vn(e,typeof t!="symbol"?t+"":t,n),n),ft=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var x=(e,t,n)=>(ft(e,t,"read from private field"),n?n.call(e):t.get(e)),X=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},L=(e,t,n,r)=>(ft(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var te=(e,t,n,r)=>({set _(s){L(e,t,s,n)},get _(){return x(e,t,r)}});import{t as Tn,d as kn}from"./index.e9246ef9.js";import{r as In}from"./scheduler.71af12de.js";import{w as M}from"./index.4dcf2086.js";function ni(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ri(e,t){Tn(e,1,1,()=>{t.delete(e.key)})}function si(e,t,n,r,s,i,o,a,l,g,f,h){let p=e.length,w=i.length,y=p;const b={};for(;y--;)b[e[y].key]=y;const H=[],De=new Map,je=new Map,lt=[];for(y=w;y--;){const v=h(s,i,y),N=n(v);let D=o.get(N);D?r&&lt.push(()=>D.p(v,t)):(D=g(N,v),D.c()),De.set(N,H[y]=D),N in b&&je.set(N,Math.abs(y-b[N]))}const ht=new Set,dt=new Set;function Ve(v){kn(v,1),v.m(a,f),o.set(v.key,v),f=v.first,w--}for(;p&&w;){const v=H[w-1],N=e[p-1],D=v.key,Ee=N.key;v===N?(f=v.first,p--,w--):De.has(Ee)?!o.has(D)||ht.has(D)?Ve(v):dt.has(Ee)?p--:je.get(D)>je.get(Ee)?(dt.add(D),Ve(v)):(ht.add(Ee),p--):(l(N,o),p--)}for(;p--;){const v=e[p];De.has(v.key)||l(v,o)}for(;w;)Ve(H[w-1]);return In(lt),H}function Bn(e){let t=JSON.parse(JSON.stringify(e));t.value=t.value.toString(),t.assets===void 0&&(t.assets=[]);for(let n=0;n<t.assets.length;n++)t.assets[n].amount=t.assets[n].amount.toString();return t}async function zt(e){const t=`https://api.ergoplatform.com/api/v1/boxes/unspent/byAddress/${e}`,n=await fetch(t);return n.status==200?(await n.json()).items.map(Bn):[]}function G(e,t){if(e)return;let n;switch(typeof t){case"string":n=new Error(t);break;case"function":n=new Error(t());break;default:n=t}throw n}function Ut(e,t){const n=typeof e;if(n!==t)throw new Error(`Expected an object of type '${t}', got '${n}'.`)}var An=e=>Object.prototype.toString.call(e);function Sn(e){if(e===null)return"null";const t=typeof e;return t==="object"||t==="function"?An(e).slice(8,-1):t}function nt(e,t){if(!(e instanceof t))throw new Error(`Expected an instance of '${t.name}', got '${Sn(e)}'.`)}function U(e){return e?Array.isArray(e)?e.length===0:Object.keys(e).length===0:!0}function I(e){return!U(e)}function A(e){return e==null||Number.isNaN(e)}function _(e){return!A(e)}function z(e){if(e)return G(e.length>0,"Empty array."),e[0]}function Cn(e){if(e)return G(e.length>0,"Empty array."),Hn(e,-1)}function Hn(e,t){const n=e==null?void 0:e.length;if(n)return t<0&&(t+=n),e[t]}function Rn(e,t){return e.some((n,r)=>e.findIndex(s=>t(s)===t(n))!==r)}function Pn(e,t){if(e.length<=t)return[e];const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}function Ln(e,t,n="asc"){return[...e].sort((r,s)=>t(r)>t(s)?n==="asc"?1:-1:t(r)<t(s)?n==="asc"?-1:1:0)}function On(e,t){if(e===t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function gt(e,t){if(e===t)return!0;if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function zn(e,t){if(e===t)return!0;if(t.length>e.length)return!1;const n=e.length-t.length;for(let r=t.length-1;r>=0;r--)if(t[r]!==e[r+n])return!1;return!0}var m=BigInt(0),He=BigInt(1),Mt=BigInt(7);BigInt(10);var Un=BigInt(63),Nt=BigInt(127),Dt=BigInt(128);function k(e){return typeof e=="bigint"?e:BigInt(e)}function We(e,t,n){let r=m;if(U(e))return r;for(const s of e)(A(n)||n(s))&&(r+=t(s));return r}var oe="nanoErgs";function Q(e,t){const n={};for(const r of e)if((A(t)||t===oe)&&(n[oe]=(n[oe]||m)+k(r.value)),t!==oe)for(const s of r.assets)_(t)&&t!==s.tokenId||(n[s.tokenId]=(n[s.tokenId]||m)+k(s.amount));return _(t)?n[t]||m:{nanoErgs:n[oe]||m,tokens:Object.keys(n).filter(r=>r!==oe).map(r=>({tokenId:r,amount:n[r]}))}}function Be(e,t){var s;Array.isArray(e)&&(e=Q(e)),Array.isArray(t)&&(t=Q(t));const n=[],r=e.nanoErgs-t.nanoErgs;for(const i of e.tokens){const o=i.amount-(((s=t.tokens.find(a=>a.tokenId===i.tokenId))==null?void 0:s.amount)||m);o!==m&&n.push({tokenId:i.tokenId,amount:o})}return{nanoErgs:r,tokens:n}}var pt=4,Mn=9;function Nn(e){let t=0;for(let n=pt;n<=Mn;n++){const r=`R${n}`;if(e[r]){if(n===pt){t=n;continue}if(n-t>1)return!1;t=n}}return!0}function Dn(e){const t={};for(const n in e){const r=e[n];A(r)||(t[n]=r)}return t}function ve(...e){const t=new Uint8Array(e.reduce((r,s)=>r+s.length,0));let n=0;for(const r of e)nt(r,Uint8Array),t.set(r,n),n+=r.length;return t}function jt(e){return!e||e.length%2?!1:(e.startsWith("0x")||(e="0x"+e),!isNaN(Number(e)))}function fe(e){return e.length/2}var Ne=(e=>(e[e.Mainnet=0]="Mainnet",e[e.Testnet=16]="Testnet",e))(Ne||{}),O=(e=>(e[e.P2PK=1]="P2PK",e[e.P2SH=2]="P2SH",e[e.P2S=3]="P2S",e))(O||{}),yt={sizeInclusion:8,constantSegregation:16},rt=class{constructor(){d(this,"_items");this._items=[]}_isIndexOutOfBounds(e){return e<0||e>=this._items.length}[Symbol.iterator](){let e=0;return{next:()=>({done:e>=this.length,value:this._items[e++]})}}get length(){return this._items.length}get isEmpty(){return this.length===0}at(e){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);return this._items[e]}add(e,t){return this._addOneOrMore(e,t)}_addOne(e,t){if(_(t)&&_(t.index)){if(t.index===this.length)return this._items.push(this._map(e)),this.length;if(this._isIndexOutOfBounds(t.index))throw new RangeError(`Index '${t.index}' is out of range.`);return this._items.splice(t.index,0,this._map(e)),this.length}return this._items.push(this._map(e)),this._items.length}_addOneOrMore(e,t){if(Array.isArray(e)){_(t)&&_(t.index)&&(e=e.reverse());for(const n of e)this._addOne(n,t)}else this._addOne(e,t);return this.length}toArray(){return[...this._items]}reduce(e,t){return this._items.reduce(e,t)}};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jn=e=>e instanceof Uint8Array,Re=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),$e=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),j=(e,t)=>e<<32-t|e>>>t,Vn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Vn)throw new Error("Non little-endian hardware is not supported");function $n(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function se(e){if(typeof e=="string"&&(e=$n(e)),!jn(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}class Vt{clone(){return this._cloneInto()}}function Gn(e){const t=r=>e().update(se(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Kn(e){const t=(r,s)=>e(s).update(se(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Ge(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Fn(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Pe(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function $t(e,t){Fn(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Qn=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);class qn extends Vt{constructor(t,n,r={},s,i,o){if(super(),this.blockLen=t,this.outputLen=n,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,Ge(t),Ge(n),Ge(s),n<0||n>s)throw new Error("outputLen bigger than keyLen");if(r.key!==void 0&&(r.key.length<1||r.key.length>s))throw new Error(`key must be up 1..${s} byte long or undefined`);if(r.salt!==void 0&&r.salt.length!==i)throw new Error(`salt must be ${i} byte long or undefined`);if(r.personalization!==void 0&&r.personalization.length!==o)throw new Error(`personalization must be ${o} byte long or undefined`);this.buffer32=Re(this.buffer=new Uint8Array(t))}update(t){Pe(this);const{blockLen:n,buffer:r,buffer32:s}=this;t=se(t);const i=t.length,o=t.byteOffset,a=t.buffer;for(let l=0;l<i;){this.pos===n&&(this.compress(s,0,!1),this.pos=0);const g=Math.min(n-this.pos,i-l),f=o+l;if(g===n&&!(f%4)&&l+g<i){const h=new Uint32Array(a,f,Math.floor((i-l)/4));for(let p=0;l+n<i;p+=s.length,l+=n)this.length+=n,this.compress(h,p,!1);continue}r.set(t.subarray(l,l+g),this.pos),this.pos+=g,this.length+=g,l+=g}return this}digestInto(t){Pe(this),$t(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,this.buffer.subarray(n).fill(0),this.compress(r,0,!0);const s=Re(t);this.get().forEach((i,o)=>s[o]=i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.length=r,t.finished=s,t.destroyed=i,t.outputLen=o,t.buffer.set(n),t.pos=a,t}}const Te=BigInt(2**32-1),Ye=BigInt(32);function Gt(e,t=!1){return t?{h:Number(e&Te),l:Number(e>>Ye&Te)}:{h:Number(e>>Ye&Te)|0,l:Number(e&Te)|0}}function Xn(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:i,l:o}=Gt(e[s],t);[n[s],r[s]]=[i,o]}return[n,r]}const Wn=(e,t)=>BigInt(e>>>0)<<Ye|BigInt(t>>>0),Yn=(e,t,n)=>e>>>n,Zn=(e,t,n)=>e<<32-n|t>>>n,Jn=(e,t,n)=>e>>>n|t<<32-n,er=(e,t,n)=>e<<32-n|t>>>n,tr=(e,t,n)=>e<<64-n|t>>>n-32,nr=(e,t,n)=>e>>>n-32|t<<64-n,rr=(e,t)=>t,sr=(e,t)=>e,ir=(e,t,n)=>e<<n|t>>>32-n,or=(e,t,n)=>t<<n|e>>>32-n,ar=(e,t,n)=>t<<n-32|e>>>64-n,cr=(e,t,n)=>e<<n-32|t>>>64-n;function ur(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const lr=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),hr=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,dr=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),fr=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,gr=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),pr=(e,t,n,r,s,i)=>t+n+r+s+i+(e/2**32|0)|0,yr={fromBig:Gt,split:Xn,toBig:Wn,shrSH:Yn,shrSL:Zn,rotrSH:Jn,rotrSL:er,rotrBH:tr,rotrBL:nr,rotr32H:rr,rotr32L:sr,rotlSH:ir,rotlSL:or,rotlBH:ar,rotlBL:cr,add:ur,add3L:lr,add3H:hr,add4L:dr,add4H:fr,add5H:pr,add5L:gr},C=yr,E=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),u=new Uint32Array(32);function W(e,t,n,r,s,i){const o=s[i],a=s[i+1];let l=u[2*e],g=u[2*e+1],f=u[2*t],h=u[2*t+1],p=u[2*n],w=u[2*n+1],y=u[2*r],b=u[2*r+1],H=C.add3L(l,f,o);g=C.add3H(H,g,h,a),l=H|0,{Dh:b,Dl:y}={Dh:b^g,Dl:y^l},{Dh:b,Dl:y}={Dh:C.rotr32H(b,y),Dl:C.rotr32L(b,y)},{h:w,l:p}=C.add(w,p,b,y),{Bh:h,Bl:f}={Bh:h^w,Bl:f^p},{Bh:h,Bl:f}={Bh:C.rotrSH(h,f,24),Bl:C.rotrSL(h,f,24)},u[2*e]=l,u[2*e+1]=g,u[2*t]=f,u[2*t+1]=h,u[2*n]=p,u[2*n+1]=w,u[2*r]=y,u[2*r+1]=b}function Y(e,t,n,r,s,i){const o=s[i],a=s[i+1];let l=u[2*e],g=u[2*e+1],f=u[2*t],h=u[2*t+1],p=u[2*n],w=u[2*n+1],y=u[2*r],b=u[2*r+1],H=C.add3L(l,f,o);g=C.add3H(H,g,h,a),l=H|0,{Dh:b,Dl:y}={Dh:b^g,Dl:y^l},{Dh:b,Dl:y}={Dh:C.rotrSH(b,y,16),Dl:C.rotrSL(b,y,16)},{h:w,l:p}=C.add(w,p,b,y),{Bh:h,Bl:f}={Bh:h^w,Bl:f^p},{Bh:h,Bl:f}={Bh:C.rotrBH(h,f,63),Bl:C.rotrBL(h,f,63)},u[2*e]=l,u[2*e+1]=g,u[2*t]=f,u[2*t+1]=h,u[2*n]=p,u[2*n+1]=w,u[2*r]=y,u[2*r+1]=b}class mr extends qn{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=E[0]|0,this.v0h=E[1]|0,this.v1l=E[2]|0,this.v1h=E[3]|0,this.v2l=E[4]|0,this.v2h=E[5]|0,this.v3l=E[6]|0,this.v3h=E[7]|0,this.v4l=E[8]|0,this.v4h=E[9]|0,this.v5l=E[10]|0,this.v5h=E[11]|0,this.v6l=E[12]|0,this.v6h=E[13]|0,this.v7l=E[14]|0,this.v7h=E[15]|0;const n=t.key?t.key.length:0;if(this.v0l^=this.outputLen|n<<8|65536|1<<24,t.salt){const r=Re(se(t.salt));this.v4l^=r[0],this.v4h^=r[1],this.v5l^=r[2],this.v5h^=r[3]}if(t.personalization){const r=Re(se(t.personalization));this.v6l^=r[0],this.v6h^=r[1],this.v7l^=r[2],this.v7h^=r[3]}if(t.key){const r=new Uint8Array(this.blockLen);r.set(se(t.key)),this.update(r)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:l,v4l:g,v4h:f,v5l:h,v5h:p,v6l:w,v6h:y,v7l:b,v7h:H}=this;return[t,n,r,s,i,o,a,l,g,f,h,p,w,y,b,H]}set(t,n,r,s,i,o,a,l,g,f,h,p,w,y,b,H){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=l|0,this.v4l=g|0,this.v4h=f|0,this.v5l=h|0,this.v5h=p|0,this.v6l=w|0,this.v6h=y|0,this.v7l=b|0,this.v7h=H|0}compress(t,n,r){this.get().forEach((l,g)=>u[g]=l),u.set(E,16);let{h:s,l:i}=C.fromBig(BigInt(this.length));u[24]=E[8]^i,u[25]=E[9]^s,r&&(u[28]=~u[28],u[29]=~u[29]);let o=0;const a=Qn;for(let l=0;l<12;l++)W(0,4,8,12,t,n+2*a[o++]),Y(0,4,8,12,t,n+2*a[o++]),W(1,5,9,13,t,n+2*a[o++]),Y(1,5,9,13,t,n+2*a[o++]),W(2,6,10,14,t,n+2*a[o++]),Y(2,6,10,14,t,n+2*a[o++]),W(3,7,11,15,t,n+2*a[o++]),Y(3,7,11,15,t,n+2*a[o++]),W(0,5,10,15,t,n+2*a[o++]),Y(0,5,10,15,t,n+2*a[o++]),W(1,6,11,12,t,n+2*a[o++]),Y(1,6,11,12,t,n+2*a[o++]),W(2,7,8,13,t,n+2*a[o++]),Y(2,7,8,13,t,n+2*a[o++]),W(3,4,9,14,t,n+2*a[o++]),Y(3,4,9,14,t,n+2*a[o++]);this.v0l^=u[0]^u[16],this.v0h^=u[1]^u[17],this.v1l^=u[2]^u[18],this.v1h^=u[3]^u[19],this.v2l^=u[4]^u[20],this.v2h^=u[5]^u[21],this.v3l^=u[6]^u[22],this.v3h^=u[7]^u[23],this.v4l^=u[8]^u[24],this.v4h^=u[9]^u[25],this.v5l^=u[10]^u[26],this.v5h^=u[11]^u[27],this.v6l^=u[12]^u[28],this.v6h^=u[13]^u[29],this.v7l^=u[14]^u[30],this.v7h^=u[15]^u[31],u.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const wr=Kn(e=>new mr(e));function br(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),l=r?4:0,g=r?0:4;e.setUint32(t+l,o,r),e.setUint32(t+g,a,r)}class _r extends Vt{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=$e(this.buffer)}update(t){Pe(this);const{view:n,buffer:r,blockLen:s}=this;t=se(t);const i=t.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const l=$e(t);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Pe(this),$t(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)n[h]=0;br(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=$e(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=l/4,f=this.get();if(g>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<g;h++)a.setUint32(4*h,f[h],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return t.length=s,t.pos=a,t.finished=i,t.destroyed=o,s%n&&t.buffer.set(r),t}}const xr=(e,t,n)=>e&t^~e&n,Er=(e,t,n)=>e&t^e&n^t&n,vr=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Z=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),J=new Uint32Array(64);class Tr extends _r{constructor(){super(64,32,8,!1),this.A=Z[0]|0,this.B=Z[1]|0,this.C=Z[2]|0,this.D=Z[3]|0,this.E=Z[4]|0,this.F=Z[5]|0,this.G=Z[6]|0,this.H=Z[7]|0}get(){const{A:t,B:n,C:r,D:s,E:i,F:o,G:a,H:l}=this;return[t,n,r,s,i,o,a,l]}set(t,n,r,s,i,o,a,l){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=l|0}process(t,n){for(let h=0;h<16;h++,n+=4)J[h]=t.getUint32(n,!1);for(let h=16;h<64;h++){const p=J[h-15],w=J[h-2],y=j(p,7)^j(p,18)^p>>>3,b=j(w,17)^j(w,19)^w>>>10;J[h]=b+J[h-7]+y+J[h-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:l,G:g,H:f}=this;for(let h=0;h<64;h++){const p=j(a,6)^j(a,11)^j(a,25),w=f+p+xr(a,l,g)+vr[h]+J[h]|0,b=(j(r,2)^j(r,13)^j(r,22))+Er(r,s,i)|0;f=g,g=l,l=a,a=o+w|0,o=i,i=s,s=r,r=w+b|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,g=g+this.G|0,f=f+this.H|0,this.set(r,s,i,o,a,l,g,f)}roundClean(){J.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const kr=Gn(()=>new Tr);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ie(...e){const t=(s,i)=>o=>s(i(o)),n=Array.from(e).reverse().reduce((s,i)=>s?t(s,i.encode):i.encode,void 0),r=e.reduce((s,i)=>s?t(s,i.decode):i.decode,void 0);return{encode:n,decode:r}}function ue(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function le(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function st(e,t="="){if(typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let s of n)if(typeof s!="string")throw new Error(`padding.decode: non-string input=${s}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function Ir(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function mt(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const s=[],i=Array.from(e);for(i.forEach(o=>{if(o<0||o>=t)throw new Error(`Wrong integer: ${o}`)});;){let o=0,a=!0;for(let l=r;l<i.length;l++){const g=i[l],f=t*o+g;if(!Number.isSafeInteger(f)||t*o/t!==o||f-g!==t*o)throw new Error("convertRadix: carry overflow");o=f%n;const h=Math.floor(f/n);if(i[l]=h,!Number.isSafeInteger(h)||h*n+o!==f)throw new Error("convertRadix: carry overflow");if(a)h?a=!1:r=l;else continue}if(s.push(o),a)break}for(let o=0;o<e.length-1&&e[o]===0;o++)s.push(0);return s.reverse()}const Kt=(e,t)=>t?Kt(t,e%t):e,Le=(e,t)=>e+(t-Kt(e,t));function wt(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Le(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Le(t,n)}`);let s=0,i=0;const o=2**n-1,a=[];for(const l of e){if(l>=2**t)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(s=s<<t|l,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)a.push((s>>i-n&o)>>>0);s&=2**i-1}if(s=s<<n-i&o,!r&&i>=t)throw new Error("Excess padding");if(!r&&s)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&a.push(s>>>0),a}function Br(e){return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return mt(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(mt(t,e,2**8))}}}function xe(e,t=!1){if(e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Le(8,e)>32||Le(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return wt(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(wt(n,e,8,t))}}}function Ar(e,t){if(typeof t!="function")throw new Error("checksum fn should be function");return{encode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),s=new Uint8Array(n.length+e);return s.set(n),s.set(r,n.length),s},decode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),s=t(r).slice(0,e),i=n.slice(-e);for(let o=0;o<e;o++)if(s[o]!==i[o])throw new Error("Invalid checksum");return r}}}const Sr=ie(xe(4),ue("0123456789ABCDEF"),le("")),Cr=ie(xe(5),ue("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),st(5),le("")),Hr=ie(xe(6),ue("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),st(6),le("")),Rr=ie(xe(6),ue("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),st(6),le("")),Pr=e=>ie(Br(58),ue(e),le("")),ye=Pr("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),bt=[0,2,3,5,6,7,9,10,11],Lr={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=ye.encode(r).padStart(bt[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),s=bt.indexOf(r.length),i=ye.decode(r);for(let o=0;o<i.length-s;o++)if(i[o]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(i.slice(i.length-s)))}return Uint8Array.from(t)}},Or=e=>ie(Ar(4,t=>e(e(t))),ye),zr={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},Ur=ie(xe(4),ue("0123456789abcdef"),le(""),Ir(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),_t={utf8:zr,hex:Ur,base16:Sr,base32:Cr,base64:Hr,base64url:Rr,base58:ye,base58xmr:Lr},Mr="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",ii=(e,t)=>{if(!_t.hasOwnProperty(e))throw new TypeError(Mr);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return _t[e].decode(t)};var Nr=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Dr(e){nt(e,Uint8Array);let t="";for(let n=0,r=e.length;n<r;n++)t+=Nr[e[n]];return t}function jr(e){Ut(e,"string"),G(e.length%2===0,"Invalid hex padding.");const t=new Uint8Array(e.length/2);for(let n=0,r=0,s=t.length;n<s;n++){const i=xt(e.charCodeAt(r++)),o=xt(e.charCodeAt(r++));t[n]=i*16+o}return t}function xt(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-(65-10);if(e>=97&&e<=102)return e-(97-10);throw new Error("Invalid byte sequence.")}var T={encode:Dr,decode:jr};function Vr(e){return nt(e,Uint8Array),new TextDecoder().decode(e)}function $r(e){return Ut(e,"string"),new Uint8Array(new TextEncoder().encode(e))}var Ke={encode:Vr,decode:$r};Or(Gr);var he=ye;function Ft(e){return e instanceof Uint8Array?e:T.decode(e)}function ge(e){return wr(Ft(e),{dkLen:32})}function Gr(e){return kr(Ft(e))}function Kr(e){e.length%2&&(e="0"+e);const t=BigInt("0x"+e);return 128&parseInt(e.slice(0,2),16)?-Qt(t):t}function Fr(e){const t=e>=m;t||(e=Qt(e));let n=e.toString(16);return n.length%2&&(n="0"+n),t&&128&parseInt(n.slice(0,2),16)&&(n="00"+n),n}function Qt(e){const t=e<m;t&&(e=-e);const n=e.toString(2);let r=n.length;const s=r%8;s>0?r+=8-s:t&&z(n)==="1"&&n.indexOf("1",1)!==-1&&(r+=8);const i=(1n<<BigInt(r))-1n;return(~e&i)+1n}function Qr(e,t){if(t===0)return e.write(0);if(t<0)throw new RangeError("Variable Length Quantity not supported for negative numbers.");do{let n=t&127;t>>=7,t>0&&(n|=128),e.write(n)}while(t>0);return e}function Fe(e){if(e.isEmpty)return 0;let t=0,n=0,r=0;do r=e.readByte(),t|=(r&127)<<n,n+=7;while(r&128);return t}function qr(e,t){if(t===m)return e.write(0);if(t<m)throw new RangeError("Variable Length Quantity not supported for negative numbers");do{let n=Number(t&Nt);t>>=Mt,t>0&&(n|=128),e.write(n)}while(t>0);return e}function Xr(e){if(e.isEmpty)return m;let t=m,n=m,r=m;do r=BigInt(e.readByte()),t|=(r&Nt)<<n,n+=Mt;while((r&Dt)!=m);return t}function S(e){let t=0;if(typeof e=="number"){do t++,e=Math.floor(e/128);while(e>0);return t}e=k(e);do t++,e/=Dt;while(e>m);return t}function Wr(e){return e<<1^e>>63}function Yr(e){return e>>1^-(e&1)}function Zr(e){return e<<He^e>>Un}function Jr(e){return e>>He^-(e&He)}var K,$,Pt,es=(Pt=class{constructor(e){X(this,K,void 0);X(this,$,void 0);typeof e=="string"?L(this,K,T.decode(e)):L(this,K,e),L(this,$,0)}get isEmpty(){return U(x(this,K))}readBoolean(){return this.readByte()===1}readBits(e){const t=new Array(e);let n=0;for(let r=0;r<e;r++){const s=x(this,K)[x(this,$)]>>n++&1;t[r]=s===1,n==8&&(n=0,te(this,$)._++)}return n>0&&te(this,$)._++,t}readByte(){return x(this,K)[te(this,$)._++]}readBytes(e){return x(this,K).subarray(x(this,$),L(this,$,x(this,$)+e))}readVlq(){return Fe(this)}readShort(){return Number(Yr(Fe(this)))}readInt(){const e=this.readLong();return Number(e)}readLong(){return Jr(Xr(this))}readBigInt(){const e=Fe(this);return Kr(T.encode(this.readBytes(e)))}},K=new WeakMap,$=new WeakMap,Pt),F,R,Lt,it=(Lt=class{constructor(e){X(this,F,void 0);X(this,R,void 0);L(this,F,new Uint8Array(e)),L(this,R,0)}get length(){return x(this,R)}writeBoolean(e){return this.write(e===!0?1:0),this}writeVLQ(e){return Qr(this,e)}writeBigVLQ(e){return qr(this,e)}writeShort(e){return this.writeVLQ(Wr(e)),this}writeInt(e){return this.writeLong(BigInt(e)),this}writeLong(e){return this.writeBigVLQ(Zr(e)),this}write(e){return x(this,F)[te(this,R)._++]=e,this}writeBytes(e){return x(this,F).set(e,x(this,R)),L(this,R,x(this,R)+e.length),this}writeHex(e){return this.writeBytes(T.decode(e))}writeBits(e){let t=0;for(let n=0;n<e.length;n++)e[n]?x(this,F)[x(this,R)]|=1<<t++:x(this,F)[x(this,R)]&=~(1<<t++),t==8&&(t=0,te(this,R)._++);return t>0&&te(this,R)._++,this}writeBigInt(e){const t=Fr(e);return this.writeVLQ(t.length/2),this.writeHex(t),this}toHex(){return T.encode(this.toBytes())}toBytes(){return x(this,F).subarray(0,x(this,R))}},F=new WeakMap,R=new WeakMap,Lt),qt=class{coerce(e){return e}},Xt=class extends qt{get embeddable(){return!1}},ee=class extends Xt{get embeddable(){return!0}},me,Ot,Wt=(Ot=class extends qt{constructor(t){super();X(this,me,void 0);L(this,me,t)}get elementsType(){return x(this,me)}get embeddable(){return!1}},me=new WeakMap,Ot),Yt=class extends ee{get code(){return 1}toString(){return"SBool"}},Zt=class extends ee{get code(){return 2}toString(){return"SByte"}},Jt=class extends ee{get code(){return 3}toString(){return"SShort"}},en=class extends ee{get code(){return 4}toString(){return"SInt"}},tn=class extends ee{get code(){return 5}coerce(e){return k(e)}toString(){return"SLong"}},nn=class extends ee{get code(){return 6}coerce(e){return k(e)}toString(){return"SBigInt"}},rn=class extends ee{get code(){return 7}coerce(e){return typeof e=="string"?T.decode(e):e}toString(){return"SGroupElement"}},sn=class extends ee{get code(){return 8}toString(){return"SSigmaProp"}},on=class extends Xt{get code(){return 98}toString(){return"SUnit"}},B=Object.freeze({embeddable:0,simpleColl:1,nestedColl:2,option:3,optionCollection:4,pairOne:5,pairTwo:6,symmetricPair:7,genericTuple:8}),an=11,Ze=an+1,V=e=>Ze*e,ts=Object.freeze({code:V(B.simpleColl),embeddable:!1,simpleCollTypeCode:V(B.simpleColl),nestedCollTypeCode:V(B.nestedColl)}),ns=Object.freeze({code:V(B.pairOne),embeddable:!1,pairOneTypeCode:V(B.pairOne),pairTwoTypeCode:V(B.pairTwo),tripleTypeCode:V(B.pairTwo),symmetricPairTypeCode:V(B.symmetricPair),quadrupleTypeCode:V(B.symmetricPair),genericTupleTypeCode:V(B.genericTuple)}),c={bool:new Yt,byte:new Zt,short:new Jt,int:new en,long:new tn,bigInt:new nn,groupElement:new rn,sigmaProp:new sn,unit:new on,coll:ts,tuple:ns};function Je(e){return e.code>=c.coll.simpleCollTypeCode&&e.code<=c.coll.nestedCollTypeCode+an}function cn(e){return e.code>=c.tuple.pairOneTypeCode&&e.code<=c.tuple.genericTupleTypeCode}function ne(e){switch(e){case c.bool.code:return c.bool;case c.byte.code:return c.byte;case c.short.code:return c.short;case c.int.code:return c.int;case c.long.code:return c.long;case c.bigInt.code:return c.bigInt;case c.groupElement.code:return c.groupElement;case c.sigmaProp.code:return c.sigmaProp;default:throw new Error(`The type code '0x${e.toString(16)}' is not a valid primitive type code.`)}}var Ae=class extends Wt{get code(){return c.coll.code}coerce(e){return this.elementsType.code===c.byte.code&&!(e instanceof Uint8Array)?typeof e=="string"?T.decode(e):Uint8Array.from(e):e.map(t=>this.elementsType.coerce(t))}toString(){return`SColl[${this.elementsType.toString()}]`}},de=class extends Wt{get code(){return c.tuple.code}coerce(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=this.elementsType[n].coerce(e[n]);return t}toString(){return`(${this.elementsType.map(e=>e.toString()).join(", ")})`}};function q(e,t,n){return new Proxy(e,{apply:(r,s,i)=>{const o=t??new r;return!n&&U(i)?o:new pe(o,...i)}})}function un(e,t){return new Proxy(e,{apply:t})}var Qe=q(Zt,c.byte);q(Yt,c.bool);q(Jt,c.short);var oi=q(en,c.int),ai=q(tn,c.long);q(nn,c.bigInt);var Oe=q(rn,c.groupElement),ze=q(sn,c.sigmaProp);q(on,void 0,!0);var qe=un(Ae,(e,t,n)=>{const[r,s]=n,i=r();return s?new pe(new e(i),s):()=>new e(i)});un(de,(e,t,n)=>{const[r,s]=n;if(typeof r=="function"&&typeof s=="function")return()=>new e([r(),s()]);if(r instanceof pe&&s instanceof pe)return new pe(new e([r.type,s.type]),[r.data,s.data]);throw new Error("Invalid tuple declaration.")});var rs=33,Et=205,vt=class Se{static serialize(t,n,r){if(n.embeddable)switch(n.code){case c.bool.code:return r.writeBoolean(t);case c.byte.code:return r.write(t);case c.short.code:return r.writeShort(t);case c.int.code:return r.writeInt(t);case c.long.code:return r.writeLong(t);case c.bigInt.code:return r.writeBigInt(t);case c.groupElement.code:return r.writeBytes(t);case c.sigmaProp.code:{const s=t;if(s.type===c.groupElement)return r.write(Et),Se.serialize(s.data,s.type,r);throw Error("Serialization error: SigmaProp operation not implemented.")}}else if(Je(n)){if(n.elementsType.code===c.byte.code){const s=t instanceof Uint8Array;G(s,`SColl[Byte] expected an UInt8Array, got ${typeof t}.`)}else G(Array.isArray(t),`SColl expected an array, got ${typeof t}.`);switch(r.writeVLQ(t.length),n.elementsType.code){case c.bool.code:return r.writeBits(t);case c.byte.code:return r.writeBytes(t);default:{for(let s=0;s<t.length;s++)Se.serialize(t[s],n.elementsType,r);return r}}}else if(cn(n)){G(Array.isArray(t),`STupleType serialization expected an array, got ${typeof t}.`);const s=n.elementsType.length;for(let i=0;i<s;i++)Se.serialize(t[i],n.elementsType[i],r);return r}else if(n.code===c.unit.code)return r;throw Error(`Serialization error: '0x${n.code.toString(16)}' type not implemented.`)}static deserialize(t,n){if(t.embeddable)switch(t.code){case c.bool.code:return n.readBoolean();case c.byte.code:return n.readByte();case c.short.code:return n.readShort();case c.int.code:return n.readInt();case c.long.code:return n.readLong();case c.bigInt.code:return n.readBigInt();case c.groupElement.code:return n.readBytes(rs);case c.sigmaProp.code:{if(n.readByte()===Et)return this.deserialize(c.groupElement,n);break}}else switch(t.code){case c.coll.code:{const r=n.readVlq(),s=t.elementsType;switch(s.code){case c.bool.code:return n.readBits(r);case c.byte.code:return n.readBytes(r);default:{const i=new Array(r);for(let o=0;o<r;o++)i[o]=this.deserialize(s,n);return i}}}case c.tuple.code:return t.elementsType.map(r=>this.deserialize(r,n));case c.unit.code:return}throw new Error(`Parsing error: '0x${t.code.toString(16)}' type not implemented.`)}},Tt=class{static serialize(e,t){if(e.embeddable)t.write(e.code);else if(e.code===c.unit.code)t.write(e.code);else if(Je(e))if(e.elementsType.embeddable)t.write(c.coll.simpleCollTypeCode+e.elementsType.code);else if(Je(e.elementsType)){const n=e.elementsType;n.elementsType.embeddable?t.write(c.coll.nestedCollTypeCode+n.elementsType.code):(t.write(c.coll.simpleCollTypeCode),this.serialize(n,t))}else t.write(c.coll.simpleCollTypeCode),this.serialize(e.elementsType,t);else if(cn(e)){switch(e.elementsType.length){case 2:{const n=z(e.elementsType),r=Cn(e.elementsType);n.embeddable?n.code===r.code?t.write(c.tuple.symmetricPairTypeCode+n.code):(t.write(c.tuple.pairOneTypeCode+n.code),this.serialize(r,t)):r.embeddable?(t.write(c.tuple.pairTwoTypeCode+r.code),this.serialize(n,t)):(t.write(c.tuple.pairOneTypeCode),this.serialize(n,t),this.serialize(r,t));return}case 3:t.write(c.tuple.tripleTypeCode);break;case 4:t.write(c.tuple.quadrupleTypeCode);break;default:{const n=e.elementsType.length;G(n>=2&&n<=255,"Invalid type: tuples must have between 2 and 255 items."),t.write(c.tuple.genericTupleTypeCode),t.writeVLQ(n)}}for(let n=0;n<e.elementsType.length;n++)this.serialize(e.elementsType[n],t)}else throw new Error("Serialization error: type not implemented.")}static deserialize(e){const t=e.readByte();if(G(t>0,`Parsing Error: Unexpected type code '0x${t.toString(16)}'`),t<c.tuple.genericTupleTypeCode){const n=Math.floor(t/Ze),r=Math.floor(t%Ze);switch(n){case B.embeddable:return ne(r);case B.simpleColl:{const s=r===0?this.deserialize(e):ne(r);return new Ae(s)}case B.nestedColl:return new Ae(new Ae(ne(r)));case B.pairOne:{const s=r===0?[this.deserialize(e),this.deserialize(e)]:[ne(r),this.deserialize(e)];return new de(s)}case B.pairTwo:{const s=r===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[this.deserialize(e),ne(r)];return new de(s)}case B.symmetricPair:{const s=r===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[ne(r),ne(r)];return new de(s)}}}else switch(t){case c.tuple.genericTupleTypeCode:{const n=e.readVlq(),r=new Array(n);for(let s=0;s<n;s++)r[s]=this.deserialize(e);return new de(r)}case c.unit.code:return c.unit}throw new Error("Not implemented.")}},ss=4096,we,be,_e,pe=(_e=class{constructor(t,n){X(this,we,void 0);X(this,be,void 0);L(this,we,t),L(this,be,t.coerce(n))}static from(t){G(t.length>0,"Empty constant bytes.");const n=new es(t),r=Tt.deserialize(n),s=vt.deserialize(r,n);return new _e(r,s)}get type(){return x(this,we)}get data(){return x(this,be)}toBytes(){const t=new it(ss);return Tt.serialize(this.type,t),vt.serialize(this.data,this.type,t),t.toBytes()}toHex(){return T.encode(this.toBytes())}},we=new WeakMap,be=new WeakMap,_e),is=65535;function ln(e,t,n){if(t||(t=new it(5e4)),t.writeBigVLQ(k(e.value)),t.writeHex(e.ergoTree),t.writeVLQ(e.creationHeight),os(t,e.assets,n),as(t,e.additionalRegisters),_(n))return t;if(!hn(e))throw new Error("Invalid box type.");return t.writeHex(e.transactionId).writeVLQ(e.index)}function hn(e){const t=e;return _(t.transactionId)&&_(t.index)}function os(e,t,n){if(U(t)){e.write(0);return}e.writeVLQ(t.length),I(n)?t.map(r=>e.writeVLQ(n.indexOf(r.tokenId)).writeBigVLQ(k(r.amount))):t.map(r=>e.writeHex(r.tokenId).writeBigVLQ(k(r.amount)))}function as(e,t){const n=Object.keys(t).sort();let r=0;for(const s of n)t[s]&&r++;if(e.writeVLQ(r),r!=0)for(const s of n){const i=t[s];_(i)&&e.writeHex(i)}}function cs(e,t){if(A(e.creationHeight))throw new Error("Box size estimation error: creation height is undefined.");let n=0;n+=S(_(t)?t:e.value),n+=fe(e.ergoTree),n+=S(e.creationHeight),n+=S(e.assets.length),n+=e.assets.reduce((s,i)=>s+=fe(i.tokenId)+S(i.amount),0);let r=0;for(const s in e.additionalRegisters){const i=e.additionalRegisters[s];i&&(n+=fe(i),r++)}return n+=S(r),n+=32,n+=S(hn(e)?e.index:is),n}function us(e){const t=new it(1e5);t.writeVLQ(e.inputs.length),e.inputs.map(r=>ls(t,r)),t.writeVLQ(e.dataInputs.length),e.dataInputs.map(r=>t.writeHex(r.boxId));const n=ds(e.outputs);return t.writeVLQ(n.length),n.map(r=>t.writeHex(r)),t.writeVLQ(e.outputs.length),e.outputs.map(r=>ln(r,t,n)),t}function ls(e,t){e.writeHex(t.boxId),e.write(0),hs(e,t.extension)}function hs(e,t){const n=Object.keys(t);let r=0;for(const s of n){const i=t[s];_(i)&&r++}if(e.writeVLQ(r),r!=0)for(const s of n){const i=t[s];_(i)&&e.writeVLQ(Number(s)).writeHex(i)}}function ds(e){const t=new Set;return e.flatMap(n=>n.assets.map(r=>t.add(r.tokenId))),Array.from(t)}var fs=class extends Error{constructor(){super("One or more inputs was selected more than one time by the current selection strategy.")}},gs=class extends Error{constructor(t){const n=[];if(t.nanoErgs&&n.push(kt("nanoErgs",t.nanoErgs)),I(t.tokens))for(const r of t.tokens)n.push(kt(r.tokenId,r.amount));super(`Insufficient inputs:${n.join()}`);d(this,"unreached");this.unreached=t}};function kt(e,t){return`
  > ${e}: ${t==null?void 0:t.toString()}`}var ps=class{constructor(){d(this,"_inputs")}select(e,t){this._inputs=e;let n=[];I(t.tokens)&&(n=this._selectTokens(t.tokens));const r=We(n,s=>s.value);if(A(t.nanoErgs)&&U(t.tokens)||_(t.nanoErgs)&&r<t.nanoErgs){const s=_(t.nanoErgs)?t.nanoErgs-r:void 0;n=n.concat(this._select(s))}return n}_selectTokens(e){let t=[];for(const n of e){const r=_(n.amount)?n.amount-Q(t,n.tokenId):void 0;r&&r<=m||(t=t.concat(this._select(r,n.tokenId)))}return t}_select(e,t){const n=this._inputs;let r=m,s=[];if(A(e))t?s=n.filter(i=>i.assets.some(o=>o.tokenId===t)):s=n;else for(let i=0;i<n.length&&r<e;i++)if(t)for(const o of n[i].assets)o.tokenId===t&&(r+=o.amount,s.push(n[i]));else r+=n[i].value,s.push(n[i]);return I(s)&&(this._inputs=this._inputs.filter(i=>!s.includes(i))),s}},ys=class{constructor(e){d(this,"_selector");this._selector=e}select(e,t){return this._selector(e,t)}},ms=class{constructor(e){d(this,"_inputs");d(this,"_strategy");d(this,"_ensureFilterPredicate");d(this,"_selector");d(this,"_sortDirection");d(this,"_ensureInclusionBoxIds");this._inputs=e}defineStrategy(e){return this._isISelectionStrategyImplementation(e)?this._strategy=e:this._strategy=new ys(e),this}select(e){this._strategy||(this._strategy=new ps);const t=this._deepCloneTarget(e);let n=[...this._inputs],r=[];const s=this._ensureFilterPredicate,i=this._ensureInclusionBoxIds;if(s?i?r=n.filter(a=>s(a)||i.has(a.boxId)):r=n.filter(s):i&&(r=n.filter(a=>i.has(a.boxId))),I(r)&&(n=n.filter(a=>!r.some(l=>l.boxId===a.boxId)),t.nanoErgs&&t.nanoErgs>m&&(t.nanoErgs-=We(r,a=>a.value)),I(t.tokens)&&r.some(a=>!U(a.assets))))for(const a of t.tokens)a.amount&&a.amount>m&&(a.amount-=Q(r,a.tokenId));if(this._selector&&(n=Ln(n,this._selector,this._sortDirection||"asc")),r=r.concat(this._strategy.select(n,t)),Rn(r,a=>a.boxId))throw new fs;const o=this._getUnreachedTargets(r,e);if(o.nanoErgs||I(o.tokens))throw new gs(o);return r}_deepCloneTarget(e){return{nanoErgs:e.nanoErgs,tokens:e.tokens?e.tokens.map(t=>({tokenId:t.tokenId,amount:t.amount})):void 0}}_getUnreachedTargets(e,t){const n={nanoErgs:void 0,tokens:void 0},r=We(e,s=>s.value);if(t.nanoErgs&&t.nanoErgs>r&&(n.nanoErgs=t.nanoErgs-r),U(t.tokens))return n;for(const s of t.tokens){const i=Q(e,s.tokenId);if(s.amount&&s.amount>i){if(s.tokenId===z(e).boxId)continue;A(n.tokens)&&(n.tokens=[]),n.tokens.push({tokenId:s.tokenId,amount:s.amount-i})}}return n}ensureInclusion(e){if(typeof e=="function")this._ensureFilterPredicate=e;else if(e==="all")this._ensureFilterPredicate=t=>t.value>0n;else if(A(this._ensureInclusionBoxIds)&&(this._ensureInclusionBoxIds=new Set),Array.isArray(e))for(const t of e)this._ensureInclusionBoxIds.add(t);else this._ensureInclusionBoxIds.add(e);return this}orderBy(e,t){return this._selector=e,this._sortDirection=t,this}_isISelectionStrategyImplementation(e){return!!e.select}static buildTargetFrom(e){const t={};let n=m;for(const r of e){n+=k(r.value);for(const s of r.assets)t[s.tokenId]=(t[s.tokenId]||m)+k(s.amount)}return{nanoErgs:n,tokens:Object.keys(t).map(r=>({tokenId:r,amount:t[r]}))}}},ws=class extends Error{constructor(){super("Registers should be densely packed. This means that it's not possible to use a register like 'R7' without filling 'R6', 'R5' and 'R4', for example.")}},bs=class extends Error{constructor(){super("Minting context is undefined. Transaction's inputs must be included in order to determine minting token id.")}},_s=class extends Error{constructor(){super("Creation Height is undefined.")}},xs=class extends Error{constructor(e){super(`Invalid Ergo address: ${e}`)}},re=4,Es=32,et=T.decode("0008cd"),vs=36,dn=T.decode("d40801"),Ce=T.decode("00ea02d193b4cbe4e3010e040004300e18"),Ts=44,ke=24;function It(e){return z(e)&240}function Xe(e){return z(e)&15}function Bt(e){return typeof e=="string"?T.decode(e):e}function ks(e){return e.length===vs&&gt(e,et)?O.P2PK:e.length===Ts&&gt(e,Ce)&&zn(e,dn)?O.P2SH:O.P2S}function At(e){return U(e)||e.length!==33?!1:e[0]===2||e[0]===3}var P=class ae{constructor(t,n){d(this,"_ergoTree");d(this,"_network");d(this,"_type");this._ergoTree=t,this._network=n,this._type=ks(t)}get network(){return this._network}get ergoTree(){return T.encode(this._ergoTree)}get type(){return this._type}static fromErgoTree(t,n){return new ae(T.decode(t),n)}static fromPublicKey(t,n){const r=Bt(t);if(!At(r))throw new Error("The Public Key is invalid.");const s=ve(et,r);return new ae(s,n)}static fromHash(t,n){if(t=Bt(t),t.length===Es)t=t.subarray(0,ke);else if(t.length!=ke)throw Error(`Invalid hash length: ${t.length}`);const r=ve(Ce,t,dn);return new ae(r,n)}static fromBase58(t,n=!1){const r=he.decode(t);if(!n&&!ae.validate(r))throw new xs(t);const s=It(r),i=Xe(r),o=r.subarray(1,r.length-re);return i===O.P2PK?this.fromPublicKey(o,s):i===O.P2SH?this.fromHash(o,s):new ae(o,s)}static validate(t){const n=typeof t=="string"?he.decode(t):t;if(n.length<re)return!1;if(Xe(n)===O.P2PK){const a=n.subarray(1,n.length-re);if(!At(a))return!1}const r=n.subarray(0,n.length-re),s=n.subarray(n.length-re,n.length),o=ge(r).subarray(0,re);return On(o,s)}static getNetworkType(t){return It(he.decode(t))}static getAddressType(t){return Xe(he.decode(t))}getPublicKeys(){return this.type===O.P2PK?[this._ergoTree.subarray(et.length)]:[]}toP2SH(t){if(this.type===O.P2SH)return this.encode();const n=ge(this._ergoTree).subarray(0,ke);return this._encode(n,O.P2SH,t)}encode(t){let n;return this.type===O.P2PK?n=z(this.getPublicKeys()):this.type===O.P2SH?n=this._ergoTree.subarray(Ce.length,Ce.length+ke):n=this._ergoTree,this._encode(n,this.type,t)}_encode(t,n,r){_(r)||(_(this.network)?r=this.network:r=Ne.Mainnet);const s=Uint8Array.from([r+n]);t=ve(s,t);const i=ge(t).subarray(0,re);return he.encode(ve(t,i))}toString(t){return this.encode(t)}},Is=class fn{constructor(t){d(this,"boxId");d(this,"value");d(this,"ergoTree");d(this,"creationHeight");d(this,"assets");d(this,"additionalRegisters");d(this,"transactionId");d(this,"index");this.boxId=t.boxId,this.ergoTree=t.ergoTree,this.creationHeight=t.creationHeight,this.value=k(t.value),this.assets=t.assets.map(n=>({tokenId:n.tokenId,amount:k(n.amount)})),this.additionalRegisters=t.additionalRegisters,this.transactionId=t.transactionId,this.index=t.index}isValid(){return fn.validate(this)}static validate(t){const n=ln(t).toBytes(),r=T.encode(ge(n));return t.boxId===r}},St=class extends Is{constructor(t){super(t);d(this,"_extension");t.extension&&this.setContextVars(t.extension)}get extension(){return this._extension}setContextVars(t){return this._extension=t,this}toUnsignedInputObject(t){return{...this.toPlainObject(t),extension:this._extension||{}}}toPlainObject(t){return t==="EIP-12"?{boxId:this.boxId,value:this.value.toString(),ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:this.assets.map(n=>({tokenId:n.tokenId,amount:n.amount.toString()})),additionalRegisters:this.additionalRegisters,transactionId:this.transactionId,index:this.index}:{boxId:this.boxId}}},Bs=class{constructor(e,t,n){d(this,"_inputs");d(this,"_dataInputs");d(this,"_outputs");this._inputs=Object.freeze(e),this._dataInputs=Object.freeze(t),this._outputs=Object.freeze(n)}get id(){return T.encode(ge(this.toBytes()))}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get burning(){return Be(Q(this.inputs),Q(this.outputs))}toPlainObject(e){return{inputs:this.inputs.map(t=>t.toUnsignedInputObject(e||"default")),dataInputs:this.dataInputs.map(t=>t.toPlainObject(e||"default")),outputs:this.outputs.map(t=>As(t))}}toEIP12Object(){return this.toPlainObject("EIP-12")}toBytes(){return us({inputs:this.inputs.map(e=>e.toUnsignedInputObject("default")),dataInputs:this.dataInputs.map(e=>e.toPlainObject("default")),outputs:this.outputs}).toBytes()}};function As(e){return{...e,value:e.value.toString(),assets:e.assets.map(t=>({tokenId:t.tokenId,amount:t.amount.toString()}))}}var Ss=class extends Error{constructor(e){super(`Box '${e}' is already included.`)}},Cs=class extends Error{constructor(e){super(e)}},Hs=class extends Error{constructor(e){super(`Invalid input: ${e}`)}},Ct=class extends Error{constructor(e){super(`Malformed transaction: ${e}`)}},Rs=class extends Error{constructor(){super(`A box must contain no more than ${at} distinct tokens.`)}},gn=class extends Error{constructor(){super("This transaction is trying to burn tokens. If that's your intention you must explicitly allow token burning on TransactionBuilder.configure() method. If no, a change address should be provided.")}},ot=class extends Error{constructor(e){super(e)}},at=120,tt=class extends rt{constructor(e,t){super(),_(e)&&this.add(e,t)}_map(e){return{tokenId:e.tokenId,amount:k(e.amount)}}_addOne(e,t){if((A(t)||t.sum&&!_(t.index))&&this._sum(this._map(e)))return this.length;if(this._items.length>=at)throw new Rs;return super._addOne(e,t),this.length}add(e,t){return super.add(e,t)}_sum(e){for(const t of this._items)if(t.tokenId===e.tokenId)return t.amount+=e.amount,!0;return!1}remove(e,t){let n=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);n=e}else if(n=this._items.findIndex(r=>r.tokenId===e),this._isIndexOutOfBounds(n))throw new ot(`TokenId '${e}' not found in assets collection.`);if(t&&n>-1){const r=k(t),s=this._items[n];if(r>s.amount)throw new Cs("Insufficient token amount to perform a subtraction operation.");if(r<s.amount)return s.amount-=r,this.length}return this._items.splice(n,1),this.length}contains(e){return this._items.some(t=>t.tokenId===e)}},Ht=class extends rt{constructor(e){super(),_(e)&&this.add(e)}_map(e){return e instanceof St?e:new St(e)}_addOne(e){if(this._items.some(t=>t.boxId===e.boxId))throw new Ss(e.boxId);return super._addOne(e)}remove(e){let t=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);t=e}else if(t=this._items.findIndex(n=>n.boxId===e),this._isIndexOutOfBounds(t))throw new ot("The input you are trying to remove is not present in the inputs collection.");return this._items.splice(t,1),this.length}},Ps=class pn extends rt{constructor(t){super(),_(t)&&this.add(t)}_map(t){return t}remove(t){let n=-1;if(typeof t=="number"){if(this._isIndexOutOfBounds(t))throw new RangeError(`Index '${t}' is out of range.`);n=t}else if(n=this._items.lastIndexOf(t),this._isIndexOutOfBounds(n))throw new ot("The output you are trying to remove is not present in the outputs collection.");return this._items.splice(n,1),this.length}clone(){return new pn(this._items)}sum(t){const n={};let r=m;if(t&&(t.nanoErgs&&(r=t.nanoErgs),I(t.tokens)))for(const s of t.tokens)A(s.amount)||(n[s.tokenId]=(n[s.tokenId]||m)+s.amount);for(const s of this._items){r+=s.value;for(const i of s.assets)n[i.tokenId]=(n[i.tokenId]||m)+i.amount}return{nanoErgs:r,tokens:Object.keys(n).map(s=>({tokenId:s,amount:n[s]}))}}},Ls=7,Os=class{constructor(e){d(this,"_bytes");typeof e=="string"?this._bytes=T.decode(e):this._bytes=e}get header(){return this._bytes[0]}get version(){return this.header&Ls}get hasSegregatedConstants(){return(this.header&yt.constantSegregation)!=0}get hasSize(){return(this.header&yt.sizeInclusion)!=0}toBytes(){return this._bytes}toHex(){return T.encode(this.toBytes())}toAddress(e=Ne.Mainnet){return P.fromErgoTree(this.toHex(),e)}},yn=BigInt(360),mn=BigInt(1e6);function zs(e=yn){return t=>BigInt(t.estimateSize())*e}var Ie=class{constructor(e,t,n){d(this,"_address");d(this,"_tokens");d(this,"_value");d(this,"_valueEstimator");d(this,"_creationHeight");d(this,"_registers");d(this,"_minting");this.setValue(e),this._creationHeight=n,this._tokens=new tt,this._registers={},typeof t=="string"?this._address=jt(t)?P.fromErgoTree(t):P.fromBase58(t):t instanceof Os?this._address=t.toAddress():this._address=t}get value(){return _(this._valueEstimator)?this._valueEstimator(this):this._value}get address(){return this._address}get ergoTree(){return this._address.ergoTree}get creationHeight(){return this._creationHeight}get assets(){return this._tokens}get additionalRegisters(){return this._registers}get minting(){return this._minting}setValue(e){if(typeof e=="function")this._valueEstimator=e;else if(this._value=k(e),this._valueEstimator=void 0,this._value<=m)throw new Error("An UTxO cannot be created without a minimum required amount.");return this}addTokens(e,t){return e instanceof tt?this._tokens.add(e.toArray(),t):this._tokens.add(e,t),this}addNfts(...e){const t=e.map(n=>({tokenId:n,amount:He}));return this.addTokens(t)}mintToken(e){return this._minting={...e,amount:k(e.amount)},this}setCreationHeight(e,t){return(A(t)||t.replace===!0||t.replace===!1&&A(this._creationHeight))&&(this._creationHeight=e),this}setAdditionalRegisters(e){if(this._registers=Dn(e),!Nn(e))throw new ws;return this}eject(e){return e({tokens:this._tokens}),this}build(e){var n;let t=this.assets.toArray();if(this.minting){if(U(e))throw new _s;U(this.additionalRegisters)&&this.setAdditionalRegisters({R4:qe(Qe,Ke.decode(this.minting.name||"")).toHex(),R5:qe(Qe,Ke.decode(this.minting.description||"")).toHex(),R6:qe(Qe,Ke.decode(((n=this.minting.decimals)==null?void 0:n.toString())||"0")).toHex()}),t=[{tokenId:z(e).boxId,amount:this.minting.amount},...t]}if(A(this.creationHeight))throw new bs;return{value:this.value,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters}}estimateSize(e=mn){G(!!this.creationHeight,"Creation height must be set");const t=this._tokens.toArray();this.minting&&t.push({tokenId:"0000000000000000000000000000000000000000000000000000000000000000",amount:this.minting.amount});const n={value:e,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters};return cs(n)}},Us=class extends Error{constructor(e){super(e)}};function Ms(e){return{addInputs:t=>e.from(t).configureSelector(n=>n.ensureInclusion(Array.isArray(t)?t.map(r=>r.boxId):t.boxId)).inputs.length,addOutputs:(t,n)=>e.to(t,n).outputs.length,addDataInputs:(t,n)=>e.withDataFrom(t,n).dataInputs.length,burnTokens:t=>{if(!e.settings.canBurnTokensFromPlugins)throw new gn;e.burnTokens(t)},setFee:t=>e.payFee(t)}}var Ns=class{constructor(){d(this,"_maxDistinctTokensPerChangeBox");d(this,"_allowTokenBurning");d(this,"_allowTokenBurningFromPlugins");d(this,"_isolateErgOnChange");this._maxDistinctTokensPerChangeBox=at,this._allowTokenBurning=!1,this._allowTokenBurningFromPlugins=!1,this._isolateErgOnChange=!1}get maxTokensPerChangeBox(){return this._maxDistinctTokensPerChangeBox}get canBurnTokens(){return this._allowTokenBurning}get canBurnTokensFromPlugins(){return this.canBurnTokens||this._allowTokenBurningFromPlugins}get shouldIsolateErgOnChange(){return this._isolateErgOnChange}setMaxTokensPerChangeBox(e){return this._maxDistinctTokensPerChangeBox=e,this}allowTokenBurning(e=!0){return this._allowTokenBurning=e,this}allowTokenBurningFromPlugins(e=!0){return this._allowTokenBurningFromPlugins=e,this}isolateErgOnChange(e=!0){return this._isolateErgOnChange=e,this}},Ds=BigInt(11e5),js="1005040004000e36100204a00b08cd0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ea02d192a39a8cc7a701730073011001020402d19683030193a38cc7b2a57300000193c2b2a57301007473027303830108cdeeac93b1a57304",ci=class{constructor(e){d(this,"_inputs");d(this,"_dataInputs");d(this,"_outputs");d(this,"_settings");d(this,"_creationHeight");d(this,"_selectorCallbacks");d(this,"_changeAddress");d(this,"_feeAmount");d(this,"_burning");d(this,"_plugins");this._inputs=new Ht,this._dataInputs=new Ht,this._outputs=new Ps,this._settings=new Ns,this._creationHeight=e}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get changeAddress(){return this._changeAddress}get fee(){return this._feeAmount}get burning(){return this._burning}get settings(){return this._settings}get creationHeight(){return this._creationHeight}get and(){return this}from(e){return Vs(e)&&(e=e.toArray()),this._inputs.add(e),this}to(e,t){return this._outputs.add(e,t),this}withDataFrom(e,t){return this._dataInputs.add(e,t),this}sendChangeTo(e){return typeof e=="string"?this._changeAddress=jt(e)?P.fromErgoTree(e,Ne.Mainnet):P.fromBase58(e):this._changeAddress=e,this}payFee(e){return this._feeAmount=k(e),this}payMinFee(){return this.payFee(Ds),this}burnTokens(e){return this._burning||(this._burning=new tt),this._burning.add(e),this}configure(e){return e(this._settings),this}configureSelector(e){return A(this._selectorCallbacks)&&(this._selectorCallbacks=[]),this._selectorCallbacks.push(e),this}extend(e){return this._plugins||(this._plugins=[]),this._plugins.push({execute:e,pending:!0}),this}eject(e){return e({inputs:this.inputs,dataInputs:this.dataInputs,outputs:this.outputs,burning:this.burning,settings:this.settings,selection:t=>{this.configureSelector(t)}}),this}build(){if(I(this._plugins)){const o=Ms(this);for(const a of this._plugins)a.pending&&(a.execute(o),a.pending=!1)}if(this._isMinting()){if(this._isMoreThanOneTokenBeingMinted())throw new Ct("only one token can be minted per transaction.");if(this._isTheSameTokenBeingMintedOutsideTheMintingBox())throw new Us("EIP-4 tokens cannot be minted from outside of the minting box.")}this.outputs.toArray().map(o=>o.setCreationHeight(this._creationHeight,{replace:!1}));const e=this.outputs.clone();_(this._feeAmount)&&e.add(new Ie(this._feeAmount,js));const t=new ms(this.inputs.toArray());if(I(this._selectorCallbacks))for(const o of this._selectorCallbacks)o(t);const n=I(this._burning)?e.sum({tokens:this._burning.toArray()}):e.sum();let r=t.select(n);if(_(this._changeAddress)){let o=Be(Q(r),n);const a=[];if(I(o.tokens)){let l=Rt({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:o.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});for(;l>o.nanoErgs;)r=t.select({nanoErgs:n.nanoErgs+l,tokens:n.tokens}),o=Be(Q(r),n),l=Rt({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:o.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});const g=Pn(o.tokens,this._settings.maxTokensPerChangeBox);for(const f of g){const h=new Ie(zs(),this._changeAddress,this._creationHeight).addTokens(f);o.nanoErgs-=h.value,a.push(h)}}if(o.nanoErgs>m)if(I(a)){if(this.settings.shouldIsolateErgOnChange)e.add(new Ie(o.nanoErgs,this._changeAddress));else{const l=z(a);l.setValue(l.value+o.nanoErgs)}e.add(a)}else e.add(new Ie(o.nanoErgs,this._changeAddress))}for(const o of r)if(!o.isValid())throw new Hs(o.boxId);const s=new Bs(r,this.dataInputs.toArray(),e.toArray().map(o=>o.setCreationHeight(this._creationHeight,{replace:!1}).build(r)));let i=s.burning;if(i.nanoErgs>m)throw new Ct("it's not possible to burn ERG.");if(I(i.tokens)&&I(this._burning)&&(i=Be(i,{nanoErgs:m,tokens:this._burning.toArray()})),!this._settings.canBurnTokens&&I(i.tokens))throw new gn;return s}_isMinting(){for(const e of this._outputs)if(e.minting)return!0;return!1}_isMoreThanOneTokenBeingMinted(){let e=0;for(const t of this._outputs)if(_(t.minting)&&(e++,e>1))return!0;return!1}_isTheSameTokenBeingMintedOutsideTheMintingBox(){const e=this._getMintingTokenId();if(A(e))return!1;for(const t of this._outputs)if(t.assets.contains(e))return!0;return!1}_getMintingTokenId(){let e;for(const t of this._outputs)if(t.minting){e=t.minting.tokenId;break}return e}};function Vs(e){return e.toArray!==void 0}function Rt(e){return BigInt($s(e))*yn}function $s({changeAddress:e,creationHeight:t,tokens:n,baseIndex:r,maxTokensPerBox:s}){const i=Math.ceil(n.length/s);let o=0;o+=S(mn),o+=fe(e.ergoTree),o+=S(t),o+=S(0),o+=32,o=o*i;for(let a=0;a<i;a++)o+=S(r+a);return o+=n.reduce((a,l)=>a+=fe(l.tokenId)+S(l.amount),0),n.length>s?n.length%s>0?(o+=S(s)*Math.floor(n.length/s),o+=S(n.length%s)):o+=S(s)*i:o+=S(n.length),o}function ui(e){return e.toHex()}const ct="9fxHfNqjT4ELqxbBU3RyvmTretGh88btXFHPBHvXC5RaZoMLKqt",wn="9gdLSKyzeyB3qQ1LWidALiyyfvQwFCZtcozXqjQ9hRkfGwPFCbR",Ue="cbd75cfe1a4f37f9a22eaee516300e36ea82017073036f07a09c1d2e10277cda",Gs=20000000000n,li=60000000000n,Ks="H3AA3QNR1XTqqPnNsjrYjsF3JAKFZATMemhZ1pp94Vgus7BK3WsuZwmqfDYNWCFGvVd3Udo1nEMt3MyKEFiCnqT4fd9FUwPhTTCbMjbL5LyuVpTRhLppi9AnHvBVhmtYMLmWeyUnspkDbHC5VzZMTaETLmA9ZsNZPjzYab5woeSwSXKk5uCa9GkJf8FYi2mAHuaXB9MohZR9B3gGZY5uP8Wsq1QDE8pxKTmurTd9tVRjsjWVF7hyTdbEkhq3Ue89WsJEi1Y5Ur9RrVjNx3MgMXCiHbi2XnATEAkdssCSxybr9pyGqF2pyfjP2daNioEtaok99ca3pUFg7egqtfAuALqgjwBPMZyDT6ewmkLSwiBbNG4F8Yvh6d7jEzBM41fXNtNKHtRbxRhrj95fQmZW9dPbsr4MyAF5HpJpgCKEjpe4YBfuCjssu5YKMc5sNjwBEo8k8xHVPEne7SwpCbLDSeyj98XgK58yt9Zcm1Lr9M7txoiNxHAGaNAXmcbayGTkeVPyrgAfni8daXmzHyGTcQ8zH33bfkM6asQPpj54LTWPAfHAKsK646MPJ9UUjCGoNunpQ",Fs="2GA8D6BRAQBFM43ToK7rVxKuEanxNv9r5fy85kP5yZdsefddeVsNPv3eKY1MUek9YizEuo6oMpJTD6GxXQ26wpgikiJgdpTLKc7LB9KvcSEjhBYSmsnSkkthRPWJR5obRVqYZRcVtmbRM4k3EXymDAkctymB9VonNmoMvQXS3HzENceRdD7SJg72sYWCakgKk2rj595Dgjm5UM3jKFGK9FrGhrbW6BA2CsKe617Zp4KfUv2tirBqxSYuSbpnMJC3hrjHRpciZMgxc23BQp37hcEmYgorJQbDSYcCwsqp4vCdhc2Y7X3G7DvPHGzg43rzGJirKnAyDZRuWGm6LMtAFAWYtqaLyCkahmXuYftbQPT7x4AvXJgay2wyY5CJHBDXvEFJqRTuQ51mnZSBkmEPaqXec2uLpp9P45kQFW9b763jVmXDTou5fcNQUqKAL4yvg8bbZZebrfMQJdi8kFAM19rWmkDcsQWtc26vyNjaNnndShhA8LQosfisBQepD9wzftKA6co4PxtJvDr",hi=M(""),di=M([]),fi=M([]),bn=M([]),_n=M([]);function gi(){const e=localStorage.getItem("ergo_bay_unconfirmed_mints");e&&_n.set(JSON.parse(e))}async function Qs(){const e=await zt(Fs);e.forEach(t=>{var r,s;let n=null;t.additionalRegisters.R7.serializedValue==ze(Oe(z(P.fromBase58(ct).getPublicKeys()))).toHex()&&(n="hodlbox"),t.additionalRegisters.R7.serializedValue==ze(Oe(z(P.fromBase58(wn).getPublicKeys()))).toHex()&&(n="bitmasks"),n=="hodlbox"&&(((r=t.assets)==null?void 0:r.length)>0&&t.assets[0].tokenId==Ue?(t.treasure=ce.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=ce.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=P.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString()),n=="bitmasks"&&(((s=t.assets)==null?void 0:s.length)>0&&t.assets[0].tokenId==Ue?(t.treasure=Me.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=Me.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=P.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString())}),bn.update(t=>[...t,...e]),xn(e)}async function qs(){const e=await zt(Ks);e.forEach(t=>{var r,s;let n=null;t.additionalRegisters.R7.serializedValue==ze(Oe(z(P.fromBase58(ct).getPublicKeys()))).toHex()&&(n="hodlbox"),t.additionalRegisters.R7.serializedValue==ze(Oe(z(P.fromBase58(wn).getPublicKeys()))).toHex()&&(n="bitmasks"),n=="hodlbox"&&(((r=t.assets)==null?void 0:r.length)>0&&t.assets[0].tokenId==Ue?(t.treasure=ce.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=ce.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=P.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString()),n=="bitmasks"&&(((s=t.assets)==null?void 0:s.length)>0&&t.assets[0].tokenId==Ue?(t.treasure=Me.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=Me.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=P.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString())}),bn.set(e),xn(e)}async function pi(){await qs(),await Qs()}function xn(e){_n.update(t=>t.filter(n=>!e.some(r=>r.transactionId==n.transactionId)))}const Me=[{id:0,price:10,img:"chest/bitmasks/10erg.png",cid:"bafybeigqt6lkj54j7yefwhnlvf3zxu4u6stb2ekqeqw4edsn5tp7ojrjje",sha256:"d6681a167927bbe307c4720b7714f2af0faa235fef2cb8d749b3ce6b20de83cc",name:"$600.00 Bitbox"},{id:1,price:100,img:"chest/bitmasks/100erg.png",cid:"bafybeidpmf2y446z2eoc2hwpb7fdvihvlyszrasqsd5vm6f2i5vtydpbem",sha256:"988799f887981277f1ad6bd6069fdd942d8399099124fb04535f7fe586bb5791",name:"$6,000.00 Bitbox"},{id:2,price:1e3,img:"chest/bitmasks/1000erg.png",cid:"bafybeihtnoq4lzvklzoacz2sgoporvl5tf42prpnpkf2ue22krpezesxkq",sha256:"a6bd98171412dc07e52a46d32b2064f7c65ed3a0dce4b824b7cfafced7790ef6",name:"$60,000.00 Bitbox"},{id:3,price:1e4,img:"chest/bitmasks/10000erg.png",cid:"bafybeiemvri47zknjmtzjfxd3cxlu6pxyhsnxrwsx6wq72w72gmq52qkgm",sha256:"77443821d856013b7d6bb60c638131ff7324b82f2864e659434c7c0a7967ef13",name:"$600,000.00 Bitbox"}],ce=[{id:0,price:10,img:"chest/10erg.png",cid:"bafybeihui4r6ylwy2u7crtvhllwy4rnorop3icpgvks5edkyb47f3guziq",sha256:"e8f26588981063e0bd9fd3f4b05b2f42aac53a0c17fd1e265b3f1eef27466b44",name:"$200.00 Hodlbox"},{id:1,price:100,img:"chest/100erg.png",cid:"bafybeideasgh2la3p4c3pqvwjzcjevyxr6j7wawtqqfa6rc25a6ntogk5i",sha256:"df338cc3cce006d349dd3f4c4ca97bc497733906e20afb178f982e343548989d",name:"$2,000.00 Hodlbox"},{id:2,price:1e3,img:"chest/1000erg.png",cid:"bafybeigkm4chflhvptckwprjmhvps5kcpuzevgjcthak5q435dv4os2x54",sha256:"5704bd829777b113026534fd24c8f0e89185090f6cd36b087532173ca9d26e5e",name:"$20,000.00 Hodlbox"},{id:3,price:1e4,img:"chest/10000erg.png",cid:"bafybeicihtoti7v4ul5l4aisp2ccb7feoatoqyjtxw4clw6jk676gfkuhm",sha256:"ed40bd94ca81b53e4fe930be0e0d81e1f3fabf336ba5c26311ec55e633542d59",name:"$200,000.00 Hodlbox"},{id:4,price:1.27,img:"chest/1.27erg.png",cid:"bafkreia4wvsv6j2ka6s6sso5vkmemmkx4risp5o5i3wk3cbbtkplzcmjpe",sha256:"1cb5655f274a07a5e949ddaa98463157e45127f5dd46ecad88219a9ebc898979",name:"$25.40 Hodlbox"}],yi=M(ce),mi=M(ct),wi=M(Gs),Xs=["ERG","hodlERG3"],bi=M(ce[0]),_i=M(Xs[0]),Ws=M();function Ys(e){return typeof e=="number"?{timeout:e}:e}function ut(e,t="default",n){Ws.set({type:t,message:e,options:Ys(n)})}function xi(e,t){ut(e,"danger",t)}function Ei(e,t){ut(e,"warning",t)}function vi(e,t){ut(e,"info",t)}export{Ue as A,yi as B,Ks as C,Gs as D,P as E,ce as F,li as G,ct as H,wn as I,Me as J,gi as K,pi as L,Ie as O,Ds as R,ui as S,ci as T,mi as a,bn as b,qe as c,xi as d,ni as e,Qe as f,ii as g,mn as h,ai as i,oi as j,ze as k,Oe as l,z as m,Ws as n,ri as o,Fs as p,_n as q,_i as r,hi as s,bi as t,si as u,wi as v,Ei as w,di as x,fi as y,vi as z};
