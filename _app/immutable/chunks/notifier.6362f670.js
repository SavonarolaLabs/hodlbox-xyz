var mn=Object.defineProperty;var wn=(e,t,n)=>t in e?mn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var d=(e,t,n)=>(wn(e,typeof t!="symbol"?t+"":t,n),n),ct=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var x=(e,t,n)=>(ct(e,t,"read from private field"),n?n.call(e):t.get(e)),K=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},L=(e,t,n,r)=>(ct(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var ee=(e,t,n,r)=>({set _(s){L(e,t,s,n)},get _(){return x(e,t,r)}});import{t as bn,d as _n}from"./index.e9246ef9.js";import{r as xn}from"./scheduler.71af12de.js";import{w as W}from"./index.4dcf2086.js";function Ys(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ws(e,t){bn(e,1,1,()=>{t.delete(e.key)})}function Zs(e,t,n,r,s,o,i,a,h,g,f,l){let p=e.length,w=o.length,y=p;const b={};for(;y--;)b[e[y].key]=y;const H=[],Ue=new Map,Me=new Map,it=[];for(y=w;y--;){const v=l(s,o,y),U=n(v);let M=i.get(U);M?r&&it.push(()=>M.p(v,t)):(M=g(U,v),M.c()),Ue.set(U,H[y]=M),U in b&&Me.set(U,Math.abs(y-b[U]))}const ot=new Set,at=new Set;function ze(v){_n(v,1),v.m(a,f),i.set(v.key,v),f=v.first,w--}for(;p&&w;){const v=H[w-1],U=e[p-1],M=v.key,Ee=U.key;v===U?(f=v.first,p--,w--):Ue.has(Ee)?!i.has(M)||ot.has(M)?ze(v):at.has(Ee)?p--:Me.get(M)>Me.get(Ee)?(at.add(M),ze(v)):(ot.add(Ee),p--):(h(U,i),p--)}for(;p--;){const v=e[p];Ue.has(v.key)||h(v,i)}for(;w;)ze(H[w-1]);return xn(it),H}function En(e){let t=JSON.parse(JSON.stringify(e));t.value=t.value.toString(),t.assets===void 0&&(t.assets=[]);for(let n=0;n<t.assets.length;n++)t.assets[n].amount=t.assets[n].amount.toString();return t}async function Ht(e){const t=`https://api.ergoplatform.com/api/v1/boxes/unspent/byAddress/${e}`,n=await fetch(t);return n.status==200?(await n.json()).items.map(En):[]}function j(e,t){if(e)return;let n;switch(typeof t){case"string":n=new Error(t);break;case"function":n=new Error(t());break;default:n=t}throw n}function Pt(e,t){const n=typeof e;if(n!==t)throw new Error(`Expected an object of type '${t}', got '${n}'.`)}var vn=e=>Object.prototype.toString.call(e);function Tn(e){if(e===null)return"null";const t=typeof e;return t==="object"||t==="function"?vn(e).slice(8,-1):t}function Ze(e,t){if(!(e instanceof t))throw new Error(`Expected an instance of '${t.name}', got '${Tn(e)}'.`)}function O(e){return e?Array.isArray(e)?e.length===0:Object.keys(e).length===0:!0}function I(e){return!O(e)}function A(e){return e==null||Number.isNaN(e)}function _(e){return!A(e)}function Z(e){if(e)return j(e.length>0,"Empty array."),e[0]}function kn(e){if(e)return j(e.length>0,"Empty array."),In(e,-1)}function In(e,t){const n=e==null?void 0:e.length;if(n)return t<0&&(t+=n),e[t]}function Bn(e,t){return e.some((n,r)=>e.findIndex(s=>t(s)===t(n))!==r)}function An(e,t){if(e.length<=t)return[e];const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}function Sn(e,t,n="asc"){return[...e].sort((r,s)=>t(r)>t(s)?n==="asc"?1:-1:t(r)<t(s)?n==="asc"?-1:1:0)}function Cn(e,t){if(e===t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function ut(e,t){if(e===t)return!0;if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Hn(e,t){if(e===t)return!0;if(t.length>e.length)return!1;const n=e.length-t.length;for(let r=t.length-1;r>=0;r--)if(t[r]!==e[r+n])return!1;return!0}var m=BigInt(0),He=BigInt(1),Lt=BigInt(7);BigInt(10);var Pn=BigInt(63),Rt=BigInt(127),Ot=BigInt(128);function k(e){return typeof e=="bigint"?e:BigInt(e)}function Ke(e,t,n){let r=m;if(O(e))return r;for(const s of e)(A(n)||n(s))&&(r+=t(s));return r}var oe="nanoErgs";function G(e,t){const n={};for(const r of e)if((A(t)||t===oe)&&(n[oe]=(n[oe]||m)+k(r.value)),t!==oe)for(const s of r.assets)_(t)&&t!==s.tokenId||(n[s.tokenId]=(n[s.tokenId]||m)+k(s.amount));return _(t)?n[t]||m:{nanoErgs:n[oe]||m,tokens:Object.keys(n).filter(r=>r!==oe).map(r=>({tokenId:r,amount:n[r]}))}}function Be(e,t){var s;Array.isArray(e)&&(e=G(e)),Array.isArray(t)&&(t=G(t));const n=[],r=e.nanoErgs-t.nanoErgs;for(const o of e.tokens){const i=o.amount-(((s=t.tokens.find(a=>a.tokenId===o.tokenId))==null?void 0:s.amount)||m);i!==m&&n.push({tokenId:o.tokenId,amount:i})}return{nanoErgs:r,tokens:n}}var ht=4,Ln=9;function Rn(e){let t=0;for(let n=ht;n<=Ln;n++){const r=`R${n}`;if(e[r]){if(n===ht){t=n;continue}if(n-t>1)return!1;t=n}}return!0}function On(e){const t={};for(const n in e){const r=e[n];A(r)||(t[n]=r)}return t}function ve(...e){const t=new Uint8Array(e.reduce((r,s)=>r+s.length,0));let n=0;for(const r of e)Ze(r,Uint8Array),t.set(r,n),n+=r.length;return t}function Ut(e){return!e||e.length%2?!1:(e.startsWith("0x")||(e="0x"+e),!isNaN(Number(e)))}function de(e){return e.length/2}var Oe=(e=>(e[e.Mainnet=0]="Mainnet",e[e.Testnet=16]="Testnet",e))(Oe||{}),R=(e=>(e[e.P2PK=1]="P2PK",e[e.P2SH=2]="P2SH",e[e.P2S=3]="P2S",e))(R||{}),lt={sizeInclusion:8,constantSegregation:16},Je=class{constructor(){d(this,"_items");this._items=[]}_isIndexOutOfBounds(e){return e<0||e>=this._items.length}[Symbol.iterator](){let e=0;return{next:()=>({done:e>=this.length,value:this._items[e++]})}}get length(){return this._items.length}get isEmpty(){return this.length===0}at(e){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);return this._items[e]}add(e,t){return this._addOneOrMore(e,t)}_addOne(e,t){if(_(t)&&_(t.index)){if(t.index===this.length)return this._items.push(this._map(e)),this.length;if(this._isIndexOutOfBounds(t.index))throw new RangeError(`Index '${t.index}' is out of range.`);return this._items.splice(t.index,0,this._map(e)),this.length}return this._items.push(this._map(e)),this._items.length}_addOneOrMore(e,t){if(Array.isArray(e)){_(t)&&_(t.index)&&(e=e.reverse());for(const n of e)this._addOne(n,t)}else this._addOne(e,t);return this.length}toArray(){return[...this._items]}reduce(e,t){return this._items.reduce(e,t)}};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Un=e=>e instanceof Uint8Array,Pe=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ne=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),z=(e,t)=>e<<32-t|e>>>t,Mn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Mn)throw new Error("Non little-endian hardware is not supported");function zn(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function re(e){if(typeof e=="string"&&(e=zn(e)),!Un(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}class Mt{clone(){return this._cloneInto()}}function Nn(e){const t=r=>e().update(re(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Dn(e){const t=(r,s)=>e(s).update(re(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function De(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function jn(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Le(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function zt(e,t){jn(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Vn=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);class $n extends Mt{constructor(t,n,r={},s,o,i){if(super(),this.blockLen=t,this.outputLen=n,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,De(t),De(n),De(s),n<0||n>s)throw new Error("outputLen bigger than keyLen");if(r.key!==void 0&&(r.key.length<1||r.key.length>s))throw new Error(`key must be up 1..${s} byte long or undefined`);if(r.salt!==void 0&&r.salt.length!==o)throw new Error(`salt must be ${o} byte long or undefined`);if(r.personalization!==void 0&&r.personalization.length!==i)throw new Error(`personalization must be ${i} byte long or undefined`);this.buffer32=Pe(this.buffer=new Uint8Array(t))}update(t){Le(this);const{blockLen:n,buffer:r,buffer32:s}=this;t=re(t);const o=t.length,i=t.byteOffset,a=t.buffer;for(let h=0;h<o;){this.pos===n&&(this.compress(s,0,!1),this.pos=0);const g=Math.min(n-this.pos,o-h),f=i+h;if(g===n&&!(f%4)&&h+g<o){const l=new Uint32Array(a,f,Math.floor((o-h)/4));for(let p=0;h+n<o;p+=s.length,h+=n)this.length+=n,this.compress(l,p,!1);continue}r.set(t.subarray(h,h+g),this.pos),this.pos+=g,this.length+=g,h+=g}return this}digestInto(t){Le(this),zt(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,this.buffer.subarray(n).fill(0),this.compress(r,0,!0);const s=Pe(t);this.get().forEach((o,i)=>s[i]=o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:o,outputLen:i,pos:a}=this;return t||(t=new this.constructor({dkLen:i})),t.set(...this.get()),t.length=r,t.finished=s,t.destroyed=o,t.outputLen=i,t.buffer.set(n),t.pos=a,t}}const Te=BigInt(2**32-1),Qe=BigInt(32);function Nt(e,t=!1){return t?{h:Number(e&Te),l:Number(e>>Qe&Te)}:{h:Number(e>>Qe&Te)|0,l:Number(e&Te)|0}}function Gn(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:o,l:i}=Nt(e[s],t);[n[s],r[s]]=[o,i]}return[n,r]}const Fn=(e,t)=>BigInt(e>>>0)<<Qe|BigInt(t>>>0),Kn=(e,t,n)=>e>>>n,Qn=(e,t,n)=>e<<32-n|t>>>n,Xn=(e,t,n)=>e>>>n|t<<32-n,qn=(e,t,n)=>e<<32-n|t>>>n,Yn=(e,t,n)=>e<<64-n|t>>>n-32,Wn=(e,t,n)=>e>>>n-32|t<<64-n,Zn=(e,t)=>t,Jn=(e,t)=>e,er=(e,t,n)=>e<<n|t>>>32-n,tr=(e,t,n)=>t<<n|e>>>32-n,nr=(e,t,n)=>t<<n-32|e>>>64-n,rr=(e,t,n)=>e<<n-32|t>>>64-n;function sr(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const ir=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),or=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,ar=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),cr=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,ur=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),hr=(e,t,n,r,s,o)=>t+n+r+s+o+(e/2**32|0)|0,lr={fromBig:Nt,split:Gn,toBig:Fn,shrSH:Kn,shrSL:Qn,rotrSH:Xn,rotrSL:qn,rotrBH:Yn,rotrBL:Wn,rotr32H:Zn,rotr32L:Jn,rotlSH:er,rotlSL:tr,rotlBH:nr,rotlBL:rr,add:sr,add3L:ir,add3H:or,add4L:ar,add4H:cr,add5H:hr,add5L:ur},C=lr,E=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),u=new Uint32Array(32);function Q(e,t,n,r,s,o){const i=s[o],a=s[o+1];let h=u[2*e],g=u[2*e+1],f=u[2*t],l=u[2*t+1],p=u[2*n],w=u[2*n+1],y=u[2*r],b=u[2*r+1],H=C.add3L(h,f,i);g=C.add3H(H,g,l,a),h=H|0,{Dh:b,Dl:y}={Dh:b^g,Dl:y^h},{Dh:b,Dl:y}={Dh:C.rotr32H(b,y),Dl:C.rotr32L(b,y)},{h:w,l:p}=C.add(w,p,b,y),{Bh:l,Bl:f}={Bh:l^w,Bl:f^p},{Bh:l,Bl:f}={Bh:C.rotrSH(l,f,24),Bl:C.rotrSL(l,f,24)},u[2*e]=h,u[2*e+1]=g,u[2*t]=f,u[2*t+1]=l,u[2*n]=p,u[2*n+1]=w,u[2*r]=y,u[2*r+1]=b}function X(e,t,n,r,s,o){const i=s[o],a=s[o+1];let h=u[2*e],g=u[2*e+1],f=u[2*t],l=u[2*t+1],p=u[2*n],w=u[2*n+1],y=u[2*r],b=u[2*r+1],H=C.add3L(h,f,i);g=C.add3H(H,g,l,a),h=H|0,{Dh:b,Dl:y}={Dh:b^g,Dl:y^h},{Dh:b,Dl:y}={Dh:C.rotrSH(b,y,16),Dl:C.rotrSL(b,y,16)},{h:w,l:p}=C.add(w,p,b,y),{Bh:l,Bl:f}={Bh:l^w,Bl:f^p},{Bh:l,Bl:f}={Bh:C.rotrBH(l,f,63),Bl:C.rotrBL(l,f,63)},u[2*e]=h,u[2*e+1]=g,u[2*t]=f,u[2*t+1]=l,u[2*n]=p,u[2*n+1]=w,u[2*r]=y,u[2*r+1]=b}class dr extends $n{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=E[0]|0,this.v0h=E[1]|0,this.v1l=E[2]|0,this.v1h=E[3]|0,this.v2l=E[4]|0,this.v2h=E[5]|0,this.v3l=E[6]|0,this.v3h=E[7]|0,this.v4l=E[8]|0,this.v4h=E[9]|0,this.v5l=E[10]|0,this.v5h=E[11]|0,this.v6l=E[12]|0,this.v6h=E[13]|0,this.v7l=E[14]|0,this.v7h=E[15]|0;const n=t.key?t.key.length:0;if(this.v0l^=this.outputLen|n<<8|65536|1<<24,t.salt){const r=Pe(re(t.salt));this.v4l^=r[0],this.v4h^=r[1],this.v5l^=r[2],this.v5h^=r[3]}if(t.personalization){const r=Pe(re(t.personalization));this.v6l^=r[0],this.v6h^=r[1],this.v7l^=r[2],this.v7h^=r[3]}if(t.key){const r=new Uint8Array(this.blockLen);r.set(re(t.key)),this.update(r)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:o,v2h:i,v3l:a,v3h:h,v4l:g,v4h:f,v5l:l,v5h:p,v6l:w,v6h:y,v7l:b,v7h:H}=this;return[t,n,r,s,o,i,a,h,g,f,l,p,w,y,b,H]}set(t,n,r,s,o,i,a,h,g,f,l,p,w,y,b,H){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=o|0,this.v2h=i|0,this.v3l=a|0,this.v3h=h|0,this.v4l=g|0,this.v4h=f|0,this.v5l=l|0,this.v5h=p|0,this.v6l=w|0,this.v6h=y|0,this.v7l=b|0,this.v7h=H|0}compress(t,n,r){this.get().forEach((h,g)=>u[g]=h),u.set(E,16);let{h:s,l:o}=C.fromBig(BigInt(this.length));u[24]=E[8]^o,u[25]=E[9]^s,r&&(u[28]=~u[28],u[29]=~u[29]);let i=0;const a=Vn;for(let h=0;h<12;h++)Q(0,4,8,12,t,n+2*a[i++]),X(0,4,8,12,t,n+2*a[i++]),Q(1,5,9,13,t,n+2*a[i++]),X(1,5,9,13,t,n+2*a[i++]),Q(2,6,10,14,t,n+2*a[i++]),X(2,6,10,14,t,n+2*a[i++]),Q(3,7,11,15,t,n+2*a[i++]),X(3,7,11,15,t,n+2*a[i++]),Q(0,5,10,15,t,n+2*a[i++]),X(0,5,10,15,t,n+2*a[i++]),Q(1,6,11,12,t,n+2*a[i++]),X(1,6,11,12,t,n+2*a[i++]),Q(2,7,8,13,t,n+2*a[i++]),X(2,7,8,13,t,n+2*a[i++]),Q(3,4,9,14,t,n+2*a[i++]),X(3,4,9,14,t,n+2*a[i++]);this.v0l^=u[0]^u[16],this.v0h^=u[1]^u[17],this.v1l^=u[2]^u[18],this.v1h^=u[3]^u[19],this.v2l^=u[4]^u[20],this.v2h^=u[5]^u[21],this.v3l^=u[6]^u[22],this.v3h^=u[7]^u[23],this.v4l^=u[8]^u[24],this.v4h^=u[9]^u[25],this.v5l^=u[10]^u[26],this.v5h^=u[11]^u[27],this.v6l^=u[12]^u[28],this.v6h^=u[13]^u[29],this.v7l^=u[14]^u[30],this.v7h^=u[15]^u[31],u.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const fr=Dn(e=>new dr(e));function gr(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),a=Number(n&o),h=r?4:0,g=r?0:4;e.setUint32(t+h,i,r),e.setUint32(t+g,a,r)}class pr extends Mt{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ne(this.buffer)}update(t){Le(this);const{view:n,buffer:r,blockLen:s}=this;t=re(t);const o=t.length;for(let i=0;i<o;){const a=Math.min(s-this.pos,o-i);if(a===s){const h=Ne(t);for(;s<=o-i;i+=s)this.process(h,i);continue}r.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Le(this),zt(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:o}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let l=i;l<s;l++)n[l]=0;gr(r,s-8,BigInt(this.length*8),o),this.process(r,0);const a=Ne(t),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=h/4,f=this.get();if(g>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<g;l++)a.setUint32(4*l,f[l],o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:a}=this;return t.length=s,t.pos=a,t.finished=o,t.destroyed=i,s%n&&t.buffer.set(r),t}}const yr=(e,t,n)=>e&t^~e&n,mr=(e,t,n)=>e&t^e&n^t&n,wr=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),q=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Y=new Uint32Array(64);class br extends pr{constructor(){super(64,32,8,!1),this.A=q[0]|0,this.B=q[1]|0,this.C=q[2]|0,this.D=q[3]|0,this.E=q[4]|0,this.F=q[5]|0,this.G=q[6]|0,this.H=q[7]|0}get(){const{A:t,B:n,C:r,D:s,E:o,F:i,G:a,H:h}=this;return[t,n,r,s,o,i,a,h]}set(t,n,r,s,o,i,a,h){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=a|0,this.H=h|0}process(t,n){for(let l=0;l<16;l++,n+=4)Y[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){const p=Y[l-15],w=Y[l-2],y=z(p,7)^z(p,18)^p>>>3,b=z(w,17)^z(w,19)^w>>>10;Y[l]=b+Y[l-7]+y+Y[l-16]|0}let{A:r,B:s,C:o,D:i,E:a,F:h,G:g,H:f}=this;for(let l=0;l<64;l++){const p=z(a,6)^z(a,11)^z(a,25),w=f+p+yr(a,h,g)+wr[l]+Y[l]|0,b=(z(r,2)^z(r,13)^z(r,22))+mr(r,s,o)|0;f=g,g=h,h=a,a=i+w|0,i=o,o=s,s=r,r=w+b|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,a=a+this.E|0,h=h+this.F|0,g=g+this.G|0,f=f+this.H|0,this.set(r,s,o,i,a,h,g,f)}roundClean(){Y.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const _r=Nn(()=>new br);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ie(...e){const t=(s,o)=>i=>s(o(i)),n=Array.from(e).reverse().reduce((s,o)=>s?t(s,o.encode):o.encode,void 0),r=e.reduce((s,o)=>s?t(s,o.decode):o.decode,void 0);return{encode:n,decode:r}}function ce(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function ue(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function et(e,t="="){if(typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let s of n)if(typeof s!="string")throw new Error(`padding.decode: non-string input=${s}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function xr(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function dt(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const s=[],o=Array.from(e);for(o.forEach(i=>{if(i<0||i>=t)throw new Error(`Wrong integer: ${i}`)});;){let i=0,a=!0;for(let h=r;h<o.length;h++){const g=o[h],f=t*i+g;if(!Number.isSafeInteger(f)||t*i/t!==i||f-g!==t*i)throw new Error("convertRadix: carry overflow");i=f%n;const l=Math.floor(f/n);if(o[h]=l,!Number.isSafeInteger(l)||l*n+i!==f)throw new Error("convertRadix: carry overflow");if(a)l?a=!1:r=h;else continue}if(s.push(i),a)break}for(let i=0;i<e.length-1&&e[i]===0;i++)s.push(0);return s.reverse()}const Dt=(e,t)=>t?Dt(t,e%t):e,Re=(e,t)=>e+(t-Dt(e,t));function ft(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Re(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Re(t,n)}`);let s=0,o=0;const i=2**n-1,a=[];for(const h of e){if(h>=2**t)throw new Error(`convertRadix2: invalid data word=${h} from=${t}`);if(s=s<<t|h,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)a.push((s>>o-n&i)>>>0);s&=2**o-1}if(s=s<<n-o&i,!r&&o>=t)throw new Error("Excess padding");if(!r&&s)throw new Error(`Non-zero padding: ${s}`);return r&&o>0&&a.push(s>>>0),a}function Er(e){return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return dt(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(dt(t,e,2**8))}}}function xe(e,t=!1){if(e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Re(8,e)>32||Re(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return ft(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(ft(n,e,8,t))}}}function vr(e,t){if(typeof t!="function")throw new Error("checksum fn should be function");return{encode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),s=new Uint8Array(n.length+e);return s.set(n),s.set(r,n.length),s},decode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),s=t(r).slice(0,e),o=n.slice(-e);for(let i=0;i<e;i++)if(s[i]!==o[i])throw new Error("Invalid checksum");return r}}}const Tr=ie(xe(4),ce("0123456789ABCDEF"),ue("")),kr=ie(xe(5),ce("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),et(5),ue("")),Ir=ie(xe(6),ce("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),et(6),ue("")),Br=ie(xe(6),ce("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),et(6),ue("")),Ar=e=>ie(Er(58),ce(e),ue("")),pe=Ar("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),gt=[0,2,3,5,6,7,9,10,11],Sr={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=pe.encode(r).padStart(gt[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),s=gt.indexOf(r.length),o=pe.decode(r);for(let i=0;i<o.length-s;i++)if(o[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(o.slice(o.length-s)))}return Uint8Array.from(t)}},Cr=e=>ie(vr(4,t=>e(e(t))),pe),Hr={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},Pr=ie(xe(4),ce("0123456789abcdef"),ue(""),xr(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),pt={utf8:Hr,hex:Pr,base16:Tr,base32:kr,base64:Ir,base64url:Br,base58:pe,base58xmr:Sr},Lr="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",Js=(e,t)=>{if(!pt.hasOwnProperty(e))throw new TypeError(Lr);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return pt[e].decode(t)};var Rr=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Or(e){Ze(e,Uint8Array);let t="";for(let n=0,r=e.length;n<r;n++)t+=Rr[e[n]];return t}function Ur(e){Pt(e,"string"),j(e.length%2===0,"Invalid hex padding.");const t=new Uint8Array(e.length/2);for(let n=0,r=0,s=t.length;n<s;n++){const o=yt(e.charCodeAt(r++)),i=yt(e.charCodeAt(r++));t[n]=o*16+i}return t}function yt(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-(65-10);if(e>=97&&e<=102)return e-(97-10);throw new Error("Invalid byte sequence.")}var T={encode:Or,decode:Ur};function Mr(e){return Ze(e,Uint8Array),new TextDecoder().decode(e)}function zr(e){return Pt(e,"string"),new Uint8Array(new TextEncoder().encode(e))}var je={encode:Mr,decode:zr};Cr(Nr);var he=pe;function jt(e){return e instanceof Uint8Array?e:T.decode(e)}function fe(e){return fr(jt(e),{dkLen:32})}function Nr(e){return _r(jt(e))}function Dr(e){e.length%2&&(e="0"+e);const t=BigInt("0x"+e);return 128&parseInt(e.slice(0,2),16)?-Vt(t):t}function jr(e){const t=e>=m;t||(e=Vt(e));let n=e.toString(16);return n.length%2&&(n="0"+n),t&&128&parseInt(n.slice(0,2),16)&&(n="00"+n),n}function Vt(e){const t=e<m;t&&(e=-e);const n=e.toString(2);let r=n.length;const s=r%8;s>0?r+=8-s:t&&Z(n)==="1"&&n.indexOf("1",1)!==-1&&(r+=8);const o=(1n<<BigInt(r))-1n;return(~e&o)+1n}function Vr(e,t){if(t===0)return e.write(0);if(t<0)throw new RangeError("Variable Length Quantity not supported for negative numbers.");do{let n=t&127;t>>=7,t>0&&(n|=128),e.write(n)}while(t>0);return e}function Ve(e){if(e.isEmpty)return 0;let t=0,n=0,r=0;do r=e.readByte(),t|=(r&127)<<n,n+=7;while(r&128);return t}function $r(e,t){if(t===m)return e.write(0);if(t<m)throw new RangeError("Variable Length Quantity not supported for negative numbers");do{let n=Number(t&Rt);t>>=Lt,t>0&&(n|=128),e.write(n)}while(t>0);return e}function Gr(e){if(e.isEmpty)return m;let t=m,n=m,r=m;do r=BigInt(e.readByte()),t|=(r&Rt)<<n,n+=Lt;while((r&Ot)!=m);return t}function S(e){let t=0;if(typeof e=="number"){do t++,e=Math.floor(e/128);while(e>0);return t}e=k(e);do t++,e/=Ot;while(e>m);return t}function Fr(e){return e<<1^e>>63}function Kr(e){return e>>1^-(e&1)}function Qr(e){return e<<He^e>>Pn}function Xr(e){return e>>He^-(e&He)}var V,D,At,qr=(At=class{constructor(e){K(this,V,void 0);K(this,D,void 0);typeof e=="string"?L(this,V,T.decode(e)):L(this,V,e),L(this,D,0)}get isEmpty(){return O(x(this,V))}readBoolean(){return this.readByte()===1}readBits(e){const t=new Array(e);let n=0;for(let r=0;r<e;r++){const s=x(this,V)[x(this,D)]>>n++&1;t[r]=s===1,n==8&&(n=0,ee(this,D)._++)}return n>0&&ee(this,D)._++,t}readByte(){return x(this,V)[ee(this,D)._++]}readBytes(e){return x(this,V).subarray(x(this,D),L(this,D,x(this,D)+e))}readVlq(){return Ve(this)}readShort(){return Number(Kr(Ve(this)))}readInt(){const e=this.readLong();return Number(e)}readLong(){return Xr(Gr(this))}readBigInt(){const e=Ve(this);return Dr(T.encode(this.readBytes(e)))}},V=new WeakMap,D=new WeakMap,At),$,P,St,tt=(St=class{constructor(e){K(this,$,void 0);K(this,P,void 0);L(this,$,new Uint8Array(e)),L(this,P,0)}get length(){return x(this,P)}writeBoolean(e){return this.write(e===!0?1:0),this}writeVLQ(e){return Vr(this,e)}writeBigVLQ(e){return $r(this,e)}writeShort(e){return this.writeVLQ(Fr(e)),this}writeInt(e){return this.writeLong(BigInt(e)),this}writeLong(e){return this.writeBigVLQ(Qr(e)),this}write(e){return x(this,$)[ee(this,P)._++]=e,this}writeBytes(e){return x(this,$).set(e,x(this,P)),L(this,P,x(this,P)+e.length),this}writeHex(e){return this.writeBytes(T.decode(e))}writeBits(e){let t=0;for(let n=0;n<e.length;n++)e[n]?x(this,$)[x(this,P)]|=1<<t++:x(this,$)[x(this,P)]&=~(1<<t++),t==8&&(t=0,ee(this,P)._++);return t>0&&ee(this,P)._++,this}writeBigInt(e){const t=jr(e);return this.writeVLQ(t.length/2),this.writeHex(t),this}toHex(){return T.encode(this.toBytes())}toBytes(){return x(this,$).subarray(0,x(this,P))}},$=new WeakMap,P=new WeakMap,St),$t=class{coerce(e){return e}},Gt=class extends $t{get embeddable(){return!1}},J=class extends Gt{get embeddable(){return!0}},me,Ct,Ft=(Ct=class extends $t{constructor(t){super();K(this,me,void 0);L(this,me,t)}get elementsType(){return x(this,me)}get embeddable(){return!1}},me=new WeakMap,Ct),Kt=class extends J{get code(){return 1}toString(){return"SBool"}},Qt=class extends J{get code(){return 2}toString(){return"SByte"}},Xt=class extends J{get code(){return 3}toString(){return"SShort"}},qt=class extends J{get code(){return 4}toString(){return"SInt"}},Yt=class extends J{get code(){return 5}coerce(e){return k(e)}toString(){return"SLong"}},Wt=class extends J{get code(){return 6}coerce(e){return k(e)}toString(){return"SBigInt"}},Zt=class extends J{get code(){return 7}coerce(e){return typeof e=="string"?T.decode(e):e}toString(){return"SGroupElement"}},Jt=class extends J{get code(){return 8}toString(){return"SSigmaProp"}},en=class extends Gt{get code(){return 98}toString(){return"SUnit"}},B=Object.freeze({embeddable:0,simpleColl:1,nestedColl:2,option:3,optionCollection:4,pairOne:5,pairTwo:6,symmetricPair:7,genericTuple:8}),tn=11,Xe=tn+1,N=e=>Xe*e,Yr=Object.freeze({code:N(B.simpleColl),embeddable:!1,simpleCollTypeCode:N(B.simpleColl),nestedCollTypeCode:N(B.nestedColl)}),Wr=Object.freeze({code:N(B.pairOne),embeddable:!1,pairOneTypeCode:N(B.pairOne),pairTwoTypeCode:N(B.pairTwo),tripleTypeCode:N(B.pairTwo),symmetricPairTypeCode:N(B.symmetricPair),quadrupleTypeCode:N(B.symmetricPair),genericTupleTypeCode:N(B.genericTuple)}),c={bool:new Kt,byte:new Qt,short:new Xt,int:new qt,long:new Yt,bigInt:new Wt,groupElement:new Zt,sigmaProp:new Jt,unit:new en,coll:Yr,tuple:Wr};function qe(e){return e.code>=c.coll.simpleCollTypeCode&&e.code<=c.coll.nestedCollTypeCode+tn}function nn(e){return e.code>=c.tuple.pairOneTypeCode&&e.code<=c.tuple.genericTupleTypeCode}function te(e){switch(e){case c.bool.code:return c.bool;case c.byte.code:return c.byte;case c.short.code:return c.short;case c.int.code:return c.int;case c.long.code:return c.long;case c.bigInt.code:return c.bigInt;case c.groupElement.code:return c.groupElement;case c.sigmaProp.code:return c.sigmaProp;default:throw new Error(`The type code '0x${e.toString(16)}' is not a valid primitive type code.`)}}var Ae=class extends Ft{get code(){return c.coll.code}coerce(e){return this.elementsType.code===c.byte.code&&!(e instanceof Uint8Array)?typeof e=="string"?T.decode(e):Uint8Array.from(e):e.map(t=>this.elementsType.coerce(t))}toString(){return`SColl[${this.elementsType.toString()}]`}},le=class extends Ft{get code(){return c.tuple.code}coerce(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=this.elementsType[n].coerce(e[n]);return t}toString(){return`(${this.elementsType.map(e=>e.toString()).join(", ")})`}};function F(e,t,n){return new Proxy(e,{apply:(r,s,o)=>{const i=t??new r;return!n&&O(o)?i:new ge(i,...o)}})}function rn(e,t){return new Proxy(e,{apply:t})}var $e=F(Qt,c.byte);F(Kt,c.bool);F(Xt,c.short);var ei=F(qt,c.int),ti=F(Yt,c.long);F(Wt,c.bigInt);var ni=F(Zt,c.groupElement),ri=F(Jt,c.sigmaProp);F(en,void 0,!0);var Ge=rn(Ae,(e,t,n)=>{const[r,s]=n,o=r();return s?new ge(new e(o),s):()=>new e(o)});rn(le,(e,t,n)=>{const[r,s]=n;if(typeof r=="function"&&typeof s=="function")return()=>new e([r(),s()]);if(r instanceof ge&&s instanceof ge)return new ge(new e([r.type,s.type]),[r.data,s.data]);throw new Error("Invalid tuple declaration.")});var Zr=33,mt=205,wt=class Se{static serialize(t,n,r){if(n.embeddable)switch(n.code){case c.bool.code:return r.writeBoolean(t);case c.byte.code:return r.write(t);case c.short.code:return r.writeShort(t);case c.int.code:return r.writeInt(t);case c.long.code:return r.writeLong(t);case c.bigInt.code:return r.writeBigInt(t);case c.groupElement.code:return r.writeBytes(t);case c.sigmaProp.code:{const s=t;if(s.type===c.groupElement)return r.write(mt),Se.serialize(s.data,s.type,r);throw Error("Serialization error: SigmaProp operation not implemented.")}}else if(qe(n)){if(n.elementsType.code===c.byte.code){const s=t instanceof Uint8Array;j(s,`SColl[Byte] expected an UInt8Array, got ${typeof t}.`)}else j(Array.isArray(t),`SColl expected an array, got ${typeof t}.`);switch(r.writeVLQ(t.length),n.elementsType.code){case c.bool.code:return r.writeBits(t);case c.byte.code:return r.writeBytes(t);default:{for(let s=0;s<t.length;s++)Se.serialize(t[s],n.elementsType,r);return r}}}else if(nn(n)){j(Array.isArray(t),`STupleType serialization expected an array, got ${typeof t}.`);const s=n.elementsType.length;for(let o=0;o<s;o++)Se.serialize(t[o],n.elementsType[o],r);return r}else if(n.code===c.unit.code)return r;throw Error(`Serialization error: '0x${n.code.toString(16)}' type not implemented.`)}static deserialize(t,n){if(t.embeddable)switch(t.code){case c.bool.code:return n.readBoolean();case c.byte.code:return n.readByte();case c.short.code:return n.readShort();case c.int.code:return n.readInt();case c.long.code:return n.readLong();case c.bigInt.code:return n.readBigInt();case c.groupElement.code:return n.readBytes(Zr);case c.sigmaProp.code:{if(n.readByte()===mt)return this.deserialize(c.groupElement,n);break}}else switch(t.code){case c.coll.code:{const r=n.readVlq(),s=t.elementsType;switch(s.code){case c.bool.code:return n.readBits(r);case c.byte.code:return n.readBytes(r);default:{const o=new Array(r);for(let i=0;i<r;i++)o[i]=this.deserialize(s,n);return o}}}case c.tuple.code:return t.elementsType.map(r=>this.deserialize(r,n));case c.unit.code:return}throw new Error(`Parsing error: '0x${t.code.toString(16)}' type not implemented.`)}},bt=class{static serialize(e,t){if(e.embeddable)t.write(e.code);else if(e.code===c.unit.code)t.write(e.code);else if(qe(e))if(e.elementsType.embeddable)t.write(c.coll.simpleCollTypeCode+e.elementsType.code);else if(qe(e.elementsType)){const n=e.elementsType;n.elementsType.embeddable?t.write(c.coll.nestedCollTypeCode+n.elementsType.code):(t.write(c.coll.simpleCollTypeCode),this.serialize(n,t))}else t.write(c.coll.simpleCollTypeCode),this.serialize(e.elementsType,t);else if(nn(e)){switch(e.elementsType.length){case 2:{const n=Z(e.elementsType),r=kn(e.elementsType);n.embeddable?n.code===r.code?t.write(c.tuple.symmetricPairTypeCode+n.code):(t.write(c.tuple.pairOneTypeCode+n.code),this.serialize(r,t)):r.embeddable?(t.write(c.tuple.pairTwoTypeCode+r.code),this.serialize(n,t)):(t.write(c.tuple.pairOneTypeCode),this.serialize(n,t),this.serialize(r,t));return}case 3:t.write(c.tuple.tripleTypeCode);break;case 4:t.write(c.tuple.quadrupleTypeCode);break;default:{const n=e.elementsType.length;j(n>=2&&n<=255,"Invalid type: tuples must have between 2 and 255 items."),t.write(c.tuple.genericTupleTypeCode),t.writeVLQ(n)}}for(let n=0;n<e.elementsType.length;n++)this.serialize(e.elementsType[n],t)}else throw new Error("Serialization error: type not implemented.")}static deserialize(e){const t=e.readByte();if(j(t>0,`Parsing Error: Unexpected type code '0x${t.toString(16)}'`),t<c.tuple.genericTupleTypeCode){const n=Math.floor(t/Xe),r=Math.floor(t%Xe);switch(n){case B.embeddable:return te(r);case B.simpleColl:{const s=r===0?this.deserialize(e):te(r);return new Ae(s)}case B.nestedColl:return new Ae(new Ae(te(r)));case B.pairOne:{const s=r===0?[this.deserialize(e),this.deserialize(e)]:[te(r),this.deserialize(e)];return new le(s)}case B.pairTwo:{const s=r===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[this.deserialize(e),te(r)];return new le(s)}case B.symmetricPair:{const s=r===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[te(r),te(r)];return new le(s)}}}else switch(t){case c.tuple.genericTupleTypeCode:{const n=e.readVlq(),r=new Array(n);for(let s=0;s<n;s++)r[s]=this.deserialize(e);return new le(r)}case c.unit.code:return c.unit}throw new Error("Not implemented.")}},Jr=4096,we,be,_e,ge=(_e=class{constructor(t,n){K(this,we,void 0);K(this,be,void 0);L(this,we,t),L(this,be,t.coerce(n))}static from(t){j(t.length>0,"Empty constant bytes.");const n=new qr(t),r=bt.deserialize(n),s=wt.deserialize(r,n);return new _e(r,s)}get type(){return x(this,we)}get data(){return x(this,be)}toBytes(){const t=new tt(Jr);return bt.serialize(this.type,t),wt.serialize(this.data,this.type,t),t.toBytes()}toHex(){return T.encode(this.toBytes())}},we=new WeakMap,be=new WeakMap,_e),es=65535;function sn(e,t,n){if(t||(t=new tt(5e4)),t.writeBigVLQ(k(e.value)),t.writeHex(e.ergoTree),t.writeVLQ(e.creationHeight),ts(t,e.assets,n),ns(t,e.additionalRegisters),_(n))return t;if(!on(e))throw new Error("Invalid box type.");return t.writeHex(e.transactionId).writeVLQ(e.index)}function on(e){const t=e;return _(t.transactionId)&&_(t.index)}function ts(e,t,n){if(O(t)){e.write(0);return}e.writeVLQ(t.length),I(n)?t.map(r=>e.writeVLQ(n.indexOf(r.tokenId)).writeBigVLQ(k(r.amount))):t.map(r=>e.writeHex(r.tokenId).writeBigVLQ(k(r.amount)))}function ns(e,t){const n=Object.keys(t).sort();let r=0;for(const s of n)t[s]&&r++;if(e.writeVLQ(r),r!=0)for(const s of n){const o=t[s];_(o)&&e.writeHex(o)}}function rs(e,t){if(A(e.creationHeight))throw new Error("Box size estimation error: creation height is undefined.");let n=0;n+=S(_(t)?t:e.value),n+=de(e.ergoTree),n+=S(e.creationHeight),n+=S(e.assets.length),n+=e.assets.reduce((s,o)=>s+=de(o.tokenId)+S(o.amount),0);let r=0;for(const s in e.additionalRegisters){const o=e.additionalRegisters[s];o&&(n+=de(o),r++)}return n+=S(r),n+=32,n+=S(on(e)?e.index:es),n}function ss(e){const t=new tt(1e5);t.writeVLQ(e.inputs.length),e.inputs.map(r=>is(t,r)),t.writeVLQ(e.dataInputs.length),e.dataInputs.map(r=>t.writeHex(r.boxId));const n=as(e.outputs);return t.writeVLQ(n.length),n.map(r=>t.writeHex(r)),t.writeVLQ(e.outputs.length),e.outputs.map(r=>sn(r,t,n)),t}function is(e,t){e.writeHex(t.boxId),e.write(0),os(e,t.extension)}function os(e,t){const n=Object.keys(t);let r=0;for(const s of n){const o=t[s];_(o)&&r++}if(e.writeVLQ(r),r!=0)for(const s of n){const o=t[s];_(o)&&e.writeVLQ(Number(s)).writeHex(o)}}function as(e){const t=new Set;return e.flatMap(n=>n.assets.map(r=>t.add(r.tokenId))),Array.from(t)}var cs=class extends Error{constructor(){super("One or more inputs was selected more than one time by the current selection strategy.")}},us=class extends Error{constructor(t){const n=[];if(t.nanoErgs&&n.push(_t("nanoErgs",t.nanoErgs)),I(t.tokens))for(const r of t.tokens)n.push(_t(r.tokenId,r.amount));super(`Insufficient inputs:${n.join()}`);d(this,"unreached");this.unreached=t}};function _t(e,t){return`
  > ${e}: ${t==null?void 0:t.toString()}`}var hs=class{constructor(){d(this,"_inputs")}select(e,t){this._inputs=e;let n=[];I(t.tokens)&&(n=this._selectTokens(t.tokens));const r=Ke(n,s=>s.value);if(A(t.nanoErgs)&&O(t.tokens)||_(t.nanoErgs)&&r<t.nanoErgs){const s=_(t.nanoErgs)?t.nanoErgs-r:void 0;n=n.concat(this._select(s))}return n}_selectTokens(e){let t=[];for(const n of e){const r=_(n.amount)?n.amount-G(t,n.tokenId):void 0;r&&r<=m||(t=t.concat(this._select(r,n.tokenId)))}return t}_select(e,t){const n=this._inputs;let r=m,s=[];if(A(e))t?s=n.filter(o=>o.assets.some(i=>i.tokenId===t)):s=n;else for(let o=0;o<n.length&&r<e;o++)if(t)for(const i of n[o].assets)i.tokenId===t&&(r+=i.amount,s.push(n[o]));else r+=n[o].value,s.push(n[o]);return I(s)&&(this._inputs=this._inputs.filter(o=>!s.includes(o))),s}},ls=class{constructor(e){d(this,"_selector");this._selector=e}select(e,t){return this._selector(e,t)}},ds=class{constructor(e){d(this,"_inputs");d(this,"_strategy");d(this,"_ensureFilterPredicate");d(this,"_selector");d(this,"_sortDirection");d(this,"_ensureInclusionBoxIds");this._inputs=e}defineStrategy(e){return this._isISelectionStrategyImplementation(e)?this._strategy=e:this._strategy=new ls(e),this}select(e){this._strategy||(this._strategy=new hs);const t=this._deepCloneTarget(e);let n=[...this._inputs],r=[];const s=this._ensureFilterPredicate,o=this._ensureInclusionBoxIds;if(s?o?r=n.filter(a=>s(a)||o.has(a.boxId)):r=n.filter(s):o&&(r=n.filter(a=>o.has(a.boxId))),I(r)&&(n=n.filter(a=>!r.some(h=>h.boxId===a.boxId)),t.nanoErgs&&t.nanoErgs>m&&(t.nanoErgs-=Ke(r,a=>a.value)),I(t.tokens)&&r.some(a=>!O(a.assets))))for(const a of t.tokens)a.amount&&a.amount>m&&(a.amount-=G(r,a.tokenId));if(this._selector&&(n=Sn(n,this._selector,this._sortDirection||"asc")),r=r.concat(this._strategy.select(n,t)),Bn(r,a=>a.boxId))throw new cs;const i=this._getUnreachedTargets(r,e);if(i.nanoErgs||I(i.tokens))throw new us(i);return r}_deepCloneTarget(e){return{nanoErgs:e.nanoErgs,tokens:e.tokens?e.tokens.map(t=>({tokenId:t.tokenId,amount:t.amount})):void 0}}_getUnreachedTargets(e,t){const n={nanoErgs:void 0,tokens:void 0},r=Ke(e,s=>s.value);if(t.nanoErgs&&t.nanoErgs>r&&(n.nanoErgs=t.nanoErgs-r),O(t.tokens))return n;for(const s of t.tokens){const o=G(e,s.tokenId);if(s.amount&&s.amount>o){if(s.tokenId===Z(e).boxId)continue;A(n.tokens)&&(n.tokens=[]),n.tokens.push({tokenId:s.tokenId,amount:s.amount-o})}}return n}ensureInclusion(e){if(typeof e=="function")this._ensureFilterPredicate=e;else if(e==="all")this._ensureFilterPredicate=t=>t.value>0n;else if(A(this._ensureInclusionBoxIds)&&(this._ensureInclusionBoxIds=new Set),Array.isArray(e))for(const t of e)this._ensureInclusionBoxIds.add(t);else this._ensureInclusionBoxIds.add(e);return this}orderBy(e,t){return this._selector=e,this._sortDirection=t,this}_isISelectionStrategyImplementation(e){return!!e.select}static buildTargetFrom(e){const t={};let n=m;for(const r of e){n+=k(r.value);for(const s of r.assets)t[s.tokenId]=(t[s.tokenId]||m)+k(s.amount)}return{nanoErgs:n,tokens:Object.keys(t).map(r=>({tokenId:r,amount:t[r]}))}}},fs=class extends Error{constructor(){super("Registers should be densely packed. This means that it's not possible to use a register like 'R7' without filling 'R6', 'R5' and 'R4', for example.")}},gs=class extends Error{constructor(){super("Minting context is undefined. Transaction's inputs must be included in order to determine minting token id.")}},ps=class extends Error{constructor(){super("Creation Height is undefined.")}},ys=class extends Error{constructor(e){super(`Invalid Ergo address: ${e}`)}},ne=4,ms=32,Ye=T.decode("0008cd"),ws=36,an=T.decode("d40801"),Ce=T.decode("00ea02d193b4cbe4e3010e040004300e18"),bs=44,ke=24;function xt(e){return Z(e)&240}function Fe(e){return Z(e)&15}function Et(e){return typeof e=="string"?T.decode(e):e}function _s(e){return e.length===ws&&ut(e,Ye)?R.P2PK:e.length===bs&&ut(e,Ce)&&Hn(e,an)?R.P2SH:R.P2S}function vt(e){return O(e)||e.length!==33?!1:e[0]===2||e[0]===3}var se=class ae{constructor(t,n){d(this,"_ergoTree");d(this,"_network");d(this,"_type");this._ergoTree=t,this._network=n,this._type=_s(t)}get network(){return this._network}get ergoTree(){return T.encode(this._ergoTree)}get type(){return this._type}static fromErgoTree(t,n){return new ae(T.decode(t),n)}static fromPublicKey(t,n){const r=Et(t);if(!vt(r))throw new Error("The Public Key is invalid.");const s=ve(Ye,r);return new ae(s,n)}static fromHash(t,n){if(t=Et(t),t.length===ms)t=t.subarray(0,ke);else if(t.length!=ke)throw Error(`Invalid hash length: ${t.length}`);const r=ve(Ce,t,an);return new ae(r,n)}static fromBase58(t,n=!1){const r=he.decode(t);if(!n&&!ae.validate(r))throw new ys(t);const s=xt(r),o=Fe(r),i=r.subarray(1,r.length-ne);return o===R.P2PK?this.fromPublicKey(i,s):o===R.P2SH?this.fromHash(i,s):new ae(i,s)}static validate(t){const n=typeof t=="string"?he.decode(t):t;if(n.length<ne)return!1;if(Fe(n)===R.P2PK){const a=n.subarray(1,n.length-ne);if(!vt(a))return!1}const r=n.subarray(0,n.length-ne),s=n.subarray(n.length-ne,n.length),i=fe(r).subarray(0,ne);return Cn(i,s)}static getNetworkType(t){return xt(he.decode(t))}static getAddressType(t){return Fe(he.decode(t))}getPublicKeys(){return this.type===R.P2PK?[this._ergoTree.subarray(Ye.length)]:[]}toP2SH(t){if(this.type===R.P2SH)return this.encode();const n=fe(this._ergoTree).subarray(0,ke);return this._encode(n,R.P2SH,t)}encode(t){let n;return this.type===R.P2PK?n=Z(this.getPublicKeys()):this.type===R.P2SH?n=this._ergoTree.subarray(Ce.length,Ce.length+ke):n=this._ergoTree,this._encode(n,this.type,t)}_encode(t,n,r){_(r)||(_(this.network)?r=this.network:r=Oe.Mainnet);const s=Uint8Array.from([r+n]);t=ve(s,t);const o=fe(t).subarray(0,ne);return he.encode(ve(t,o))}toString(t){return this.encode(t)}},xs=class cn{constructor(t){d(this,"boxId");d(this,"value");d(this,"ergoTree");d(this,"creationHeight");d(this,"assets");d(this,"additionalRegisters");d(this,"transactionId");d(this,"index");this.boxId=t.boxId,this.ergoTree=t.ergoTree,this.creationHeight=t.creationHeight,this.value=k(t.value),this.assets=t.assets.map(n=>({tokenId:n.tokenId,amount:k(n.amount)})),this.additionalRegisters=t.additionalRegisters,this.transactionId=t.transactionId,this.index=t.index}isValid(){return cn.validate(this)}static validate(t){const n=sn(t).toBytes(),r=T.encode(fe(n));return t.boxId===r}},Tt=class extends xs{constructor(t){super(t);d(this,"_extension");t.extension&&this.setContextVars(t.extension)}get extension(){return this._extension}setContextVars(t){return this._extension=t,this}toUnsignedInputObject(t){return{...this.toPlainObject(t),extension:this._extension||{}}}toPlainObject(t){return t==="EIP-12"?{boxId:this.boxId,value:this.value.toString(),ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:this.assets.map(n=>({tokenId:n.tokenId,amount:n.amount.toString()})),additionalRegisters:this.additionalRegisters,transactionId:this.transactionId,index:this.index}:{boxId:this.boxId}}},Es=class{constructor(e,t,n){d(this,"_inputs");d(this,"_dataInputs");d(this,"_outputs");this._inputs=Object.freeze(e),this._dataInputs=Object.freeze(t),this._outputs=Object.freeze(n)}get id(){return T.encode(fe(this.toBytes()))}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get burning(){return Be(G(this.inputs),G(this.outputs))}toPlainObject(e){return{inputs:this.inputs.map(t=>t.toUnsignedInputObject(e||"default")),dataInputs:this.dataInputs.map(t=>t.toPlainObject(e||"default")),outputs:this.outputs.map(t=>vs(t))}}toEIP12Object(){return this.toPlainObject("EIP-12")}toBytes(){return ss({inputs:this.inputs.map(e=>e.toUnsignedInputObject("default")),dataInputs:this.dataInputs.map(e=>e.toPlainObject("default")),outputs:this.outputs}).toBytes()}};function vs(e){return{...e,value:e.value.toString(),assets:e.assets.map(t=>({tokenId:t.tokenId,amount:t.amount.toString()}))}}var Ts=class extends Error{constructor(e){super(`Box '${e}' is already included.`)}},ks=class extends Error{constructor(e){super(e)}},Is=class extends Error{constructor(e){super(`Invalid input: ${e}`)}},kt=class extends Error{constructor(e){super(`Malformed transaction: ${e}`)}},Bs=class extends Error{constructor(){super(`A box must contain no more than ${rt} distinct tokens.`)}},un=class extends Error{constructor(){super("This transaction is trying to burn tokens. If that's your intention you must explicitly allow token burning on TransactionBuilder.configure() method. If no, a change address should be provided.")}},nt=class extends Error{constructor(e){super(e)}},rt=120,We=class extends Je{constructor(e,t){super(),_(e)&&this.add(e,t)}_map(e){return{tokenId:e.tokenId,amount:k(e.amount)}}_addOne(e,t){if((A(t)||t.sum&&!_(t.index))&&this._sum(this._map(e)))return this.length;if(this._items.length>=rt)throw new Bs;return super._addOne(e,t),this.length}add(e,t){return super.add(e,t)}_sum(e){for(const t of this._items)if(t.tokenId===e.tokenId)return t.amount+=e.amount,!0;return!1}remove(e,t){let n=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);n=e}else if(n=this._items.findIndex(r=>r.tokenId===e),this._isIndexOutOfBounds(n))throw new nt(`TokenId '${e}' not found in assets collection.`);if(t&&n>-1){const r=k(t),s=this._items[n];if(r>s.amount)throw new ks("Insufficient token amount to perform a subtraction operation.");if(r<s.amount)return s.amount-=r,this.length}return this._items.splice(n,1),this.length}contains(e){return this._items.some(t=>t.tokenId===e)}},It=class extends Je{constructor(e){super(),_(e)&&this.add(e)}_map(e){return e instanceof Tt?e:new Tt(e)}_addOne(e){if(this._items.some(t=>t.boxId===e.boxId))throw new Ts(e.boxId);return super._addOne(e)}remove(e){let t=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);t=e}else if(t=this._items.findIndex(n=>n.boxId===e),this._isIndexOutOfBounds(t))throw new nt("The input you are trying to remove is not present in the inputs collection.");return this._items.splice(t,1),this.length}},As=class hn extends Je{constructor(t){super(),_(t)&&this.add(t)}_map(t){return t}remove(t){let n=-1;if(typeof t=="number"){if(this._isIndexOutOfBounds(t))throw new RangeError(`Index '${t}' is out of range.`);n=t}else if(n=this._items.lastIndexOf(t),this._isIndexOutOfBounds(n))throw new nt("The output you are trying to remove is not present in the outputs collection.");return this._items.splice(n,1),this.length}clone(){return new hn(this._items)}sum(t){const n={};let r=m;if(t&&(t.nanoErgs&&(r=t.nanoErgs),I(t.tokens)))for(const s of t.tokens)A(s.amount)||(n[s.tokenId]=(n[s.tokenId]||m)+s.amount);for(const s of this._items){r+=s.value;for(const o of s.assets)n[o.tokenId]=(n[o.tokenId]||m)+o.amount}return{nanoErgs:r,tokens:Object.keys(n).map(s=>({tokenId:s,amount:n[s]}))}}},Ss=7,Cs=class{constructor(e){d(this,"_bytes");typeof e=="string"?this._bytes=T.decode(e):this._bytes=e}get header(){return this._bytes[0]}get version(){return this.header&Ss}get hasSegregatedConstants(){return(this.header&lt.constantSegregation)!=0}get hasSize(){return(this.header&lt.sizeInclusion)!=0}toBytes(){return this._bytes}toHex(){return T.encode(this.toBytes())}toAddress(e=Oe.Mainnet){return se.fromErgoTree(this.toHex(),e)}},ln=BigInt(360),dn=BigInt(1e6);function Hs(e=ln){return t=>BigInt(t.estimateSize())*e}var Ie=class{constructor(e,t,n){d(this,"_address");d(this,"_tokens");d(this,"_value");d(this,"_valueEstimator");d(this,"_creationHeight");d(this,"_registers");d(this,"_minting");this.setValue(e),this._creationHeight=n,this._tokens=new We,this._registers={},typeof t=="string"?this._address=Ut(t)?se.fromErgoTree(t):se.fromBase58(t):t instanceof Cs?this._address=t.toAddress():this._address=t}get value(){return _(this._valueEstimator)?this._valueEstimator(this):this._value}get address(){return this._address}get ergoTree(){return this._address.ergoTree}get creationHeight(){return this._creationHeight}get assets(){return this._tokens}get additionalRegisters(){return this._registers}get minting(){return this._minting}setValue(e){if(typeof e=="function")this._valueEstimator=e;else if(this._value=k(e),this._valueEstimator=void 0,this._value<=m)throw new Error("An UTxO cannot be created without a minimum required amount.");return this}addTokens(e,t){return e instanceof We?this._tokens.add(e.toArray(),t):this._tokens.add(e,t),this}addNfts(...e){const t=e.map(n=>({tokenId:n,amount:He}));return this.addTokens(t)}mintToken(e){return this._minting={...e,amount:k(e.amount)},this}setCreationHeight(e,t){return(A(t)||t.replace===!0||t.replace===!1&&A(this._creationHeight))&&(this._creationHeight=e),this}setAdditionalRegisters(e){if(this._registers=On(e),!Rn(e))throw new fs;return this}eject(e){return e({tokens:this._tokens}),this}build(e){var n;let t=this.assets.toArray();if(this.minting){if(O(e))throw new ps;O(this.additionalRegisters)&&this.setAdditionalRegisters({R4:Ge($e,je.decode(this.minting.name||"")).toHex(),R5:Ge($e,je.decode(this.minting.description||"")).toHex(),R6:Ge($e,je.decode(((n=this.minting.decimals)==null?void 0:n.toString())||"0")).toHex()}),t=[{tokenId:Z(e).boxId,amount:this.minting.amount},...t]}if(A(this.creationHeight))throw new gs;return{value:this.value,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters}}estimateSize(e=dn){j(!!this.creationHeight,"Creation height must be set");const t=this._tokens.toArray();this.minting&&t.push({tokenId:"0000000000000000000000000000000000000000000000000000000000000000",amount:this.minting.amount});const n={value:e,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters};return rs(n)}},Ps=class extends Error{constructor(e){super(e)}};function Ls(e){return{addInputs:t=>e.from(t).configureSelector(n=>n.ensureInclusion(Array.isArray(t)?t.map(r=>r.boxId):t.boxId)).inputs.length,addOutputs:(t,n)=>e.to(t,n).outputs.length,addDataInputs:(t,n)=>e.withDataFrom(t,n).dataInputs.length,burnTokens:t=>{if(!e.settings.canBurnTokensFromPlugins)throw new un;e.burnTokens(t)},setFee:t=>e.payFee(t)}}var Rs=class{constructor(){d(this,"_maxDistinctTokensPerChangeBox");d(this,"_allowTokenBurning");d(this,"_allowTokenBurningFromPlugins");d(this,"_isolateErgOnChange");this._maxDistinctTokensPerChangeBox=rt,this._allowTokenBurning=!1,this._allowTokenBurningFromPlugins=!1,this._isolateErgOnChange=!1}get maxTokensPerChangeBox(){return this._maxDistinctTokensPerChangeBox}get canBurnTokens(){return this._allowTokenBurning}get canBurnTokensFromPlugins(){return this.canBurnTokens||this._allowTokenBurningFromPlugins}get shouldIsolateErgOnChange(){return this._isolateErgOnChange}setMaxTokensPerChangeBox(e){return this._maxDistinctTokensPerChangeBox=e,this}allowTokenBurning(e=!0){return this._allowTokenBurning=e,this}allowTokenBurningFromPlugins(e=!0){return this._allowTokenBurningFromPlugins=e,this}isolateErgOnChange(e=!0){return this._isolateErgOnChange=e,this}},Os=BigInt(11e5),Us="1005040004000e36100204a00b08cd0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ea02d192a39a8cc7a701730073011001020402d19683030193a38cc7b2a57300000193c2b2a57301007473027303830108cdeeac93b1a57304",si=class{constructor(e){d(this,"_inputs");d(this,"_dataInputs");d(this,"_outputs");d(this,"_settings");d(this,"_creationHeight");d(this,"_selectorCallbacks");d(this,"_changeAddress");d(this,"_feeAmount");d(this,"_burning");d(this,"_plugins");this._inputs=new It,this._dataInputs=new It,this._outputs=new As,this._settings=new Rs,this._creationHeight=e}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get changeAddress(){return this._changeAddress}get fee(){return this._feeAmount}get burning(){return this._burning}get settings(){return this._settings}get creationHeight(){return this._creationHeight}get and(){return this}from(e){return Ms(e)&&(e=e.toArray()),this._inputs.add(e),this}to(e,t){return this._outputs.add(e,t),this}withDataFrom(e,t){return this._dataInputs.add(e,t),this}sendChangeTo(e){return typeof e=="string"?this._changeAddress=Ut(e)?se.fromErgoTree(e,Oe.Mainnet):se.fromBase58(e):this._changeAddress=e,this}payFee(e){return this._feeAmount=k(e),this}payMinFee(){return this.payFee(Os),this}burnTokens(e){return this._burning||(this._burning=new We),this._burning.add(e),this}configure(e){return e(this._settings),this}configureSelector(e){return A(this._selectorCallbacks)&&(this._selectorCallbacks=[]),this._selectorCallbacks.push(e),this}extend(e){return this._plugins||(this._plugins=[]),this._plugins.push({execute:e,pending:!0}),this}eject(e){return e({inputs:this.inputs,dataInputs:this.dataInputs,outputs:this.outputs,burning:this.burning,settings:this.settings,selection:t=>{this.configureSelector(t)}}),this}build(){if(I(this._plugins)){const i=Ls(this);for(const a of this._plugins)a.pending&&(a.execute(i),a.pending=!1)}if(this._isMinting()){if(this._isMoreThanOneTokenBeingMinted())throw new kt("only one token can be minted per transaction.");if(this._isTheSameTokenBeingMintedOutsideTheMintingBox())throw new Ps("EIP-4 tokens cannot be minted from outside of the minting box.")}this.outputs.toArray().map(i=>i.setCreationHeight(this._creationHeight,{replace:!1}));const e=this.outputs.clone();_(this._feeAmount)&&e.add(new Ie(this._feeAmount,Us));const t=new ds(this.inputs.toArray());if(I(this._selectorCallbacks))for(const i of this._selectorCallbacks)i(t);const n=I(this._burning)?e.sum({tokens:this._burning.toArray()}):e.sum();let r=t.select(n);if(_(this._changeAddress)){let i=Be(G(r),n);const a=[];if(I(i.tokens)){let h=Bt({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:i.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});for(;h>i.nanoErgs;)r=t.select({nanoErgs:n.nanoErgs+h,tokens:n.tokens}),i=Be(G(r),n),h=Bt({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:i.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});const g=An(i.tokens,this._settings.maxTokensPerChangeBox);for(const f of g){const l=new Ie(Hs(),this._changeAddress,this._creationHeight).addTokens(f);i.nanoErgs-=l.value,a.push(l)}}if(i.nanoErgs>m)if(I(a)){if(this.settings.shouldIsolateErgOnChange)e.add(new Ie(i.nanoErgs,this._changeAddress));else{const h=Z(a);h.setValue(h.value+i.nanoErgs)}e.add(a)}else e.add(new Ie(i.nanoErgs,this._changeAddress))}for(const i of r)if(!i.isValid())throw new Is(i.boxId);const s=new Es(r,this.dataInputs.toArray(),e.toArray().map(i=>i.setCreationHeight(this._creationHeight,{replace:!1}).build(r)));let o=s.burning;if(o.nanoErgs>m)throw new kt("it's not possible to burn ERG.");if(I(o.tokens)&&I(this._burning)&&(o=Be(o,{nanoErgs:m,tokens:this._burning.toArray()})),!this._settings.canBurnTokens&&I(o.tokens))throw new un;return s}_isMinting(){for(const e of this._outputs)if(e.minting)return!0;return!1}_isMoreThanOneTokenBeingMinted(){let e=0;for(const t of this._outputs)if(_(t.minting)&&(e++,e>1))return!0;return!1}_isTheSameTokenBeingMintedOutsideTheMintingBox(){const e=this._getMintingTokenId();if(A(e))return!1;for(const t of this._outputs)if(t.assets.contains(e))return!0;return!1}_getMintingTokenId(){let e;for(const t of this._outputs)if(t.minting){e=t.minting.tokenId;break}return e}};function Ms(e){return e.toArray!==void 0}function Bt(e){return BigInt(zs(e))*ln}function zs({changeAddress:e,creationHeight:t,tokens:n,baseIndex:r,maxTokensPerBox:s}){const o=Math.ceil(n.length/s);let i=0;i+=S(dn),i+=de(e.ergoTree),i+=S(t),i+=S(0),i+=32,i=i*o;for(let a=0;a<o;a++)i+=S(r+a);return i+=n.reduce((a,h)=>a+=de(h.tokenId)+S(h.amount),0),n.length>s?n.length%s>0?(i+=S(s)*Math.floor(n.length/s),i+=S(n.length%s)):i+=S(s)*o:i+=S(n.length),i}function ii(e){return e.toHex()}const oi="9fxHfNqjT4ELqxbBU3RyvmTretGh88btXFHPBHvXC5RaZoMLKqt",fn="f57dfb23f768a2f85cd88bc453e4479af870410bf132e7d182718da50d9aa34b",Ns="H3AA3QNR1XTqqPnNsjrYjsF3JAKFZATMemhZ1pp94Vgus7BK3WsuZwmqfDYNWCFGvVd3Udo1nEMt3MyKEFiCnqT4fd9FUwPhTTCbMjbL5LyuVpTRhLppi9AnHvBVhmtYMLmWeyUnspkDbHC5VzZMTaETLmA9ZsNZPjzYab5woeSwSXKk5uCa9GkJf8FYi2mAHuaXB9MohZR9B3gGZY5uP8Wsq1QDE8pxKTmurTd9tVRjsjWVF7hyTdbEkhq3Ue89WsJEi1Y5Ur9RrVjNx3MgMXCiHbi2XnATEAkdssCSxybr9pyGqF2pyfjP2daNioEtaok99ca3pUFg7egqtfAuALqgjwBPMZyDT6ewmkLSwiBbNG4F8Yvh6d7jEzBM41fXNtNKHtRbxRhrj95fQmZW9dPbsr4MyAF5HpJpgCKEjpe4YBfuCjssu5YKMc5sNjwBEo8k8xHVPEne7SwpCbLDSeyj98XgK58yt9Zcm1Lr9M7txoiNxHAGaNAXmcbayGTkeVPyrgAfni8daXmzHyGTcQ8zH33bfkM6asQPpj54LTWPAfHAKsK646MPJ9UUjCGoNunpQ",Ds="2GA8D6BRAQBFM43ToK7rVxKuEanxNv9r5fy85kP5yZdsefddeVsNPv3eKY1MUek9YizEuo6oMpJTD6GxXQ26wpgikiJgdpTLKc7LB9KvcSEjhBYSmsnSkkthRPWJR5obRVqYZRcVtmbRM4k3EXymDAkctymB9VonNmoMvQXS3HzENceRdD7SJg72sYWCakgKk2rj595Dgjm5UM3jKFGK9FrGhrbW6BA2CsKe617Zp4KfUv2tirBqxSYuSbpnMJC3hrjHRpciZMgxc23BQp37hcEmYgorJQbDSYcCwsqp4vCdhc2Y7X3G7DvPHGzg43rzGJirKnAyDZRuWGm6LMtAFAWYtqaLyCkahmXuYftbQPT7x4AvXJgay2wyY5CJHBDXvEFJqRTuQ51mnZSBkmEPaqXec2uLpp9P45kQFW9b763jVmXDTou5fcNQUqKAL4yvg8bbZZebrfMQJdi8kFAM19rWmkDcsQWtc26vyNjaNnndShhA8LQosfisBQepD9wzftKA6co4PxtJvDr",ai=W(""),ci=W([]),ui=W([]),gn=W([]),pn=W([]);function hi(){const e=localStorage.getItem("ergo_bay_unconfirmed_mints");e&&pn.set(JSON.parse(e))}async function js(){const e=await Ht(Ds);e.forEach(t=>{var n;((n=t.assets)==null?void 0:n.length)>0&&t.assets[0].tokenId==fn?(t.treasure=ye.find(r=>t.assets[0].amount==r.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=ye.find(r=>t.value==r.price*10**9),t.currency="ERG"),t.hodler=se.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString()}),gn.update(t=>[...t,...e]),yn(e)}async function Vs(){const e=await Ht(Ns);e.forEach(t=>{var n;((n=t.assets)==null?void 0:n.length)>0&&t.assets[0].tokenId==fn?(t.treasure=ye.find(r=>t.assets[0].amount==r.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=ye.find(r=>t.value==r.price*10**9),t.currency="ERG"),t.hodler=se.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString()}),gn.set(e),yn(e)}async function li(){await Vs(),await js()}function yn(e){pn.update(t=>t.filter(n=>!e.some(r=>r.transactionId==n.transactionId)))}const ye=[{id:0,price:10,img:"chest/10erg.png",cid:"bafybeihui4r6ylwy2u7crtvhllwy4rnorop3icpgvks5edkyb47f3guziq",sha256:"e8f26588981063e0bd9fd3f4b05b2f42aac53a0c17fd1e265b3f1eef27466b44",name:"$200.00 Hodlbox"},{id:1,price:100,img:"chest/100erg.png",cid:"bafybeideasgh2la3p4c3pqvwjzcjevyxr6j7wawtqqfa6rc25a6ntogk5i",sha256:"df338cc3cce006d349dd3f4c4ca97bc497733906e20afb178f982e343548989d",name:"$2,000.00 Hodlbox"},{id:2,price:1e3,img:"chest/1000erg.png",cid:"bafybeigkm4chflhvptckwprjmhvps5kcpuzevgjcthak5q435dv4os2x54",sha256:"5704bd829777b113026534fd24c8f0e89185090f6cd36b087532173ca9d26e5e",name:"$20,000.00 Hodlbox"},{id:3,price:1e4,img:"chest/10000erg.png",cid:"bafybeicihtoti7v4ul5l4aisp2ccb7feoatoqyjtxw4clw6jk676gfkuhm",sha256:"ed40bd94ca81b53e4fe930be0e0d81e1f3fabf336ba5c26311ec55e633542d59",name:"$200,000.00 Hodlbox"},{id:4,price:1.27,img:"chest/1.27erg.png",cid:"bafkreia4wvsv6j2ka6s6sso5vkmemmkx4risp5o5i3wk3cbbtkplzcmjpe",sha256:"1cb5655f274a07a5e949ddaa98463157e45127f5dd46ecad88219a9ebc898979",name:"$25.40 Hodlbox"}],$s=["ERG","hodlERG3"],di=W(ye[0]),fi=W($s[0]),Gs=W();function Fs(e){return typeof e=="number"?{timeout:e}:e}function st(e,t="default",n){Gs.set({type:t,message:e,options:Fs(n)})}function gi(e,t){st(e,"danger",t)}function pi(e,t){st(e,"warning",t)}function yi(e,t){st(e,"info",t)}export{ye as A,Ns as C,oi as D,se as E,fn as H,Ie as O,Os as R,ii as S,si as T,Ge as a,$e as b,Js as c,gi as d,Ys as e,dn as f,ti as g,ei as h,ri as i,ni as j,Z as k,Ds as l,pn as m,Gs as n,Ws as o,fi as p,di as q,ci as r,ai as s,ui as t,Zs as u,yi as v,pi as w,gn as x,hi as y,li as z};
