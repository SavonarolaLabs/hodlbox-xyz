var kn=Object.defineProperty;var Tn=(e,t,n)=>t in e?kn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var d=(e,t,n)=>(Tn(e,typeof t!="symbol"?t+"":t,n),n),gt=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var x=(e,t,n)=>(gt(e,t,"read from private field"),n?n.call(e):t.get(e)),X=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},O=(e,t,n,r)=>(gt(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var te=(e,t,n,r)=>({set _(s){O(e,t,s,n)},get _(){return x(e,t,r)}});import{t as In,d as Bn}from"./index.e9246ef9.js";import{r as An}from"./scheduler.71af12de.js";import{w as M}from"./index.4dcf2086.js";function si(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ii(e,t){In(e,1,1,()=>{t.delete(e.key)})}function oi(e,t,n,r,s,o,i,a,l,g,f,h){let p=e.length,w=o.length,m=p;const b={};for(;m--;)b[e[m].key]=m;const H=[],je=new Map,Ve=new Map,ht=[];for(m=w;m--;){const v=h(s,o,m),N=n(v);let D=i.get(N);D?r&&ht.push(()=>D.p(v,t)):(D=g(N,v),D.c()),je.set(N,H[m]=D),N in b&&Ve.set(N,Math.abs(m-b[N]))}const dt=new Set,ft=new Set;function $e(v){Bn(v,1),v.m(a,f),i.set(v.key,v),f=v.first,w--}for(;p&&w;){const v=H[w-1],N=e[p-1],D=v.key,Te=N.key;v===N?(f=v.first,p--,w--):je.has(Te)?!i.has(D)||dt.has(D)?$e(v):ft.has(Te)?p--:Ve.get(D)>Ve.get(Te)?(ft.add(D),$e(v)):(dt.add(Te),p--):(l(N,i),p--)}for(;p--;){const v=e[p];je.has(v.key)||l(v,i)}for(;w;)$e(H[w-1]);return An(ht),H}function Sn(e){let t=JSON.parse(JSON.stringify(e));t.value=t.value.toString(),t.assets===void 0&&(t.assets=[]);for(let n=0;n<t.assets.length;n++)t.assets[n].amount=t.assets[n].amount.toString();return t}async function Ut(e){const t=`https://api.ergoplatform.com/api/v1/boxes/unspent/byAddress/${e}`,n=await fetch(t);return n.status==200?(await n.json()).items.map(Sn):[]}function G(e,t){if(e)return;let n;switch(typeof t){case"string":n=new Error(t);break;case"function":n=new Error(t());break;default:n=t}throw n}function Mt(e,t){const n=typeof e;if(n!==t)throw new Error(`Expected an object of type '${t}', got '${n}'.`)}var Cn=e=>Object.prototype.toString.call(e);function Rn(e){if(e===null)return"null";const t=typeof e;return t==="object"||t==="function"?Cn(e).slice(8,-1):t}function rt(e,t){if(!(e instanceof t))throw new Error(`Expected an instance of '${t.name}', got '${Rn(e)}'.`)}function U(e){return e?Array.isArray(e)?e.length===0:Object.keys(e).length===0:!0}function B(e){return!U(e)}function S(e){return e==null||Number.isNaN(e)}function _(e){return!S(e)}function P(e){if(e)return G(e.length>0,"Empty array."),e[0]}function Hn(e){if(e)return G(e.length>0,"Empty array."),Pn(e,-1)}function Pn(e,t){const n=e==null?void 0:e.length;if(n)return t<0&&(t+=n),e[t]}function Ln(e,t){return e.some((n,r)=>e.findIndex(s=>t(s)===t(n))!==r)}function On(e,t){if(e.length<=t)return[e];const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}function zn(e,t,n="asc"){return[...e].sort((r,s)=>t(r)>t(s)?n==="asc"?1:-1:t(r)<t(s)?n==="asc"?-1:1:0)}function Un(e,t){if(e===t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function pt(e,t){if(e===t)return!0;if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Mn(e,t){if(e===t)return!0;if(t.length>e.length)return!1;const n=e.length-t.length;for(let r=t.length-1;r>=0;r--)if(t[r]!==e[r+n])return!1;return!0}var y=BigInt(0),Le=BigInt(1),Nt=BigInt(7);BigInt(10);var Nn=BigInt(63),Dt=BigInt(127),jt=BigInt(128);function I(e){return typeof e=="bigint"?e:BigInt(e)}function Ye(e,t,n){let r=y;if(U(e))return r;for(const s of e)(S(n)||n(s))&&(r+=t(s));return r}var oe="nanoErgs";function q(e,t){const n={};for(const r of e)if((S(t)||t===oe)&&(n[oe]=(n[oe]||y)+I(r.value)),t!==oe)for(const s of r.assets)_(t)&&t!==s.tokenId||(n[s.tokenId]=(n[s.tokenId]||y)+I(s.amount));return _(t)?n[t]||y:{nanoErgs:n[oe]||y,tokens:Object.keys(n).filter(r=>r!==oe).map(r=>({tokenId:r,amount:n[r]}))}}function Ce(e,t){var s;Array.isArray(e)&&(e=q(e)),Array.isArray(t)&&(t=q(t));const n=[],r=e.nanoErgs-t.nanoErgs;for(const o of e.tokens){const i=o.amount-(((s=t.tokens.find(a=>a.tokenId===o.tokenId))==null?void 0:s.amount)||y);i!==y&&n.push({tokenId:o.tokenId,amount:i})}return{nanoErgs:r,tokens:n}}var mt=4,Dn=9;function jn(e){let t=0;for(let n=mt;n<=Dn;n++){const r=`R${n}`;if(e[r]){if(n===mt){t=n;continue}if(n-t>1)return!1;t=n}}return!0}function Vn(e){const t={};for(const n in e){const r=e[n];S(r)||(t[n]=r)}return t}function Ie(...e){const t=new Uint8Array(e.reduce((r,s)=>r+s.length,0));let n=0;for(const r of e)rt(r,Uint8Array),t.set(r,n),n+=r.length;return t}function Vt(e){return!e||e.length%2?!1:(e.startsWith("0x")||(e="0x"+e),!isNaN(Number(e)))}function me(e){return e.length/2}var De=(e=>(e[e.Mainnet=0]="Mainnet",e[e.Testnet=16]="Testnet",e))(De||{}),z=(e=>(e[e.P2PK=1]="P2PK",e[e.P2SH=2]="P2SH",e[e.P2S=3]="P2S",e))(z||{}),yt={sizeInclusion:8,constantSegregation:16},st=class{constructor(){d(this,"_items");this._items=[]}_isIndexOutOfBounds(e){return e<0||e>=this._items.length}[Symbol.iterator](){let e=0;return{next:()=>({done:e>=this.length,value:this._items[e++]})}}get length(){return this._items.length}get isEmpty(){return this.length===0}at(e){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);return this._items[e]}add(e,t){return this._addOneOrMore(e,t)}_addOne(e,t){if(_(t)&&_(t.index)){if(t.index===this.length)return this._items.push(this._map(e)),this.length;if(this._isIndexOutOfBounds(t.index))throw new RangeError(`Index '${t.index}' is out of range.`);return this._items.splice(t.index,0,this._map(e)),this.length}return this._items.push(this._map(e)),this._items.length}_addOneOrMore(e,t){if(Array.isArray(e)){_(t)&&_(t.index)&&(e=e.reverse());for(const n of e)this._addOne(n,t)}else this._addOne(e,t);return this.length}toArray(){return[...this._items]}reduce(e,t){return this._items.reduce(e,t)}};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $n=e=>e instanceof Uint8Array,Oe=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ge=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),j=(e,t)=>e<<32-t|e>>>t,Gn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Gn)throw new Error("Non little-endian hardware is not supported");function Kn(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function se(e){if(typeof e=="string"&&(e=Kn(e)),!$n(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}class $t{clone(){return this._cloneInto()}}function Fn(e){const t=r=>e().update(se(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function qn(e){const t=(r,s)=>e(s).update(se(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Ke(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Qn(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function ze(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Gt(e,t){Qn(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Xn=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);class Wn extends $t{constructor(t,n,r={},s,o,i){if(super(),this.blockLen=t,this.outputLen=n,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,Ke(t),Ke(n),Ke(s),n<0||n>s)throw new Error("outputLen bigger than keyLen");if(r.key!==void 0&&(r.key.length<1||r.key.length>s))throw new Error(`key must be up 1..${s} byte long or undefined`);if(r.salt!==void 0&&r.salt.length!==o)throw new Error(`salt must be ${o} byte long or undefined`);if(r.personalization!==void 0&&r.personalization.length!==i)throw new Error(`personalization must be ${i} byte long or undefined`);this.buffer32=Oe(this.buffer=new Uint8Array(t))}update(t){ze(this);const{blockLen:n,buffer:r,buffer32:s}=this;t=se(t);const o=t.length,i=t.byteOffset,a=t.buffer;for(let l=0;l<o;){this.pos===n&&(this.compress(s,0,!1),this.pos=0);const g=Math.min(n-this.pos,o-l),f=i+l;if(g===n&&!(f%4)&&l+g<o){const h=new Uint32Array(a,f,Math.floor((o-l)/4));for(let p=0;l+n<o;p+=s.length,l+=n)this.length+=n,this.compress(h,p,!1);continue}r.set(t.subarray(l,l+g),this.pos),this.pos+=g,this.length+=g,l+=g}return this}digestInto(t){ze(this),Gt(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,this.buffer.subarray(n).fill(0),this.compress(r,0,!0);const s=Oe(t);this.get().forEach((o,i)=>s[i]=o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:o,outputLen:i,pos:a}=this;return t||(t=new this.constructor({dkLen:i})),t.set(...this.get()),t.length=r,t.finished=s,t.destroyed=o,t.outputLen=i,t.buffer.set(n),t.pos=a,t}}const Be=BigInt(2**32-1),Ze=BigInt(32);function Kt(e,t=!1){return t?{h:Number(e&Be),l:Number(e>>Ze&Be)}:{h:Number(e>>Ze&Be)|0,l:Number(e&Be)|0}}function Yn(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:o,l:i}=Kt(e[s],t);[n[s],r[s]]=[o,i]}return[n,r]}const Zn=(e,t)=>BigInt(e>>>0)<<Ze|BigInt(t>>>0),Jn=(e,t,n)=>e>>>n,er=(e,t,n)=>e<<32-n|t>>>n,tr=(e,t,n)=>e>>>n|t<<32-n,nr=(e,t,n)=>e<<32-n|t>>>n,rr=(e,t,n)=>e<<64-n|t>>>n-32,sr=(e,t,n)=>e>>>n-32|t<<64-n,ir=(e,t)=>t,or=(e,t)=>e,ar=(e,t,n)=>e<<n|t>>>32-n,cr=(e,t,n)=>t<<n|e>>>32-n,ur=(e,t,n)=>t<<n-32|e>>>64-n,lr=(e,t,n)=>e<<n-32|t>>>64-n;function hr(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const dr=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),fr=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,gr=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),pr=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,mr=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),yr=(e,t,n,r,s,o)=>t+n+r+s+o+(e/2**32|0)|0,wr={fromBig:Kt,split:Yn,toBig:Zn,shrSH:Jn,shrSL:er,rotrSH:tr,rotrSL:nr,rotrBH:rr,rotrBL:sr,rotr32H:ir,rotr32L:or,rotlSH:ar,rotlSL:cr,rotlBH:ur,rotlBL:lr,add:hr,add3L:dr,add3H:fr,add4L:gr,add4H:pr,add5H:yr,add5L:mr},R=wr,E=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),u=new Uint32Array(32);function W(e,t,n,r,s,o){const i=s[o],a=s[o+1];let l=u[2*e],g=u[2*e+1],f=u[2*t],h=u[2*t+1],p=u[2*n],w=u[2*n+1],m=u[2*r],b=u[2*r+1],H=R.add3L(l,f,i);g=R.add3H(H,g,h,a),l=H|0,{Dh:b,Dl:m}={Dh:b^g,Dl:m^l},{Dh:b,Dl:m}={Dh:R.rotr32H(b,m),Dl:R.rotr32L(b,m)},{h:w,l:p}=R.add(w,p,b,m),{Bh:h,Bl:f}={Bh:h^w,Bl:f^p},{Bh:h,Bl:f}={Bh:R.rotrSH(h,f,24),Bl:R.rotrSL(h,f,24)},u[2*e]=l,u[2*e+1]=g,u[2*t]=f,u[2*t+1]=h,u[2*n]=p,u[2*n+1]=w,u[2*r]=m,u[2*r+1]=b}function Y(e,t,n,r,s,o){const i=s[o],a=s[o+1];let l=u[2*e],g=u[2*e+1],f=u[2*t],h=u[2*t+1],p=u[2*n],w=u[2*n+1],m=u[2*r],b=u[2*r+1],H=R.add3L(l,f,i);g=R.add3H(H,g,h,a),l=H|0,{Dh:b,Dl:m}={Dh:b^g,Dl:m^l},{Dh:b,Dl:m}={Dh:R.rotrSH(b,m,16),Dl:R.rotrSL(b,m,16)},{h:w,l:p}=R.add(w,p,b,m),{Bh:h,Bl:f}={Bh:h^w,Bl:f^p},{Bh:h,Bl:f}={Bh:R.rotrBH(h,f,63),Bl:R.rotrBL(h,f,63)},u[2*e]=l,u[2*e+1]=g,u[2*t]=f,u[2*t+1]=h,u[2*n]=p,u[2*n+1]=w,u[2*r]=m,u[2*r+1]=b}class br extends Wn{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=E[0]|0,this.v0h=E[1]|0,this.v1l=E[2]|0,this.v1h=E[3]|0,this.v2l=E[4]|0,this.v2h=E[5]|0,this.v3l=E[6]|0,this.v3h=E[7]|0,this.v4l=E[8]|0,this.v4h=E[9]|0,this.v5l=E[10]|0,this.v5h=E[11]|0,this.v6l=E[12]|0,this.v6h=E[13]|0,this.v7l=E[14]|0,this.v7h=E[15]|0;const n=t.key?t.key.length:0;if(this.v0l^=this.outputLen|n<<8|65536|1<<24,t.salt){const r=Oe(se(t.salt));this.v4l^=r[0],this.v4h^=r[1],this.v5l^=r[2],this.v5h^=r[3]}if(t.personalization){const r=Oe(se(t.personalization));this.v6l^=r[0],this.v6h^=r[1],this.v7l^=r[2],this.v7h^=r[3]}if(t.key){const r=new Uint8Array(this.blockLen);r.set(se(t.key)),this.update(r)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:o,v2h:i,v3l:a,v3h:l,v4l:g,v4h:f,v5l:h,v5h:p,v6l:w,v6h:m,v7l:b,v7h:H}=this;return[t,n,r,s,o,i,a,l,g,f,h,p,w,m,b,H]}set(t,n,r,s,o,i,a,l,g,f,h,p,w,m,b,H){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=o|0,this.v2h=i|0,this.v3l=a|0,this.v3h=l|0,this.v4l=g|0,this.v4h=f|0,this.v5l=h|0,this.v5h=p|0,this.v6l=w|0,this.v6h=m|0,this.v7l=b|0,this.v7h=H|0}compress(t,n,r){this.get().forEach((l,g)=>u[g]=l),u.set(E,16);let{h:s,l:o}=R.fromBig(BigInt(this.length));u[24]=E[8]^o,u[25]=E[9]^s,r&&(u[28]=~u[28],u[29]=~u[29]);let i=0;const a=Xn;for(let l=0;l<12;l++)W(0,4,8,12,t,n+2*a[i++]),Y(0,4,8,12,t,n+2*a[i++]),W(1,5,9,13,t,n+2*a[i++]),Y(1,5,9,13,t,n+2*a[i++]),W(2,6,10,14,t,n+2*a[i++]),Y(2,6,10,14,t,n+2*a[i++]),W(3,7,11,15,t,n+2*a[i++]),Y(3,7,11,15,t,n+2*a[i++]),W(0,5,10,15,t,n+2*a[i++]),Y(0,5,10,15,t,n+2*a[i++]),W(1,6,11,12,t,n+2*a[i++]),Y(1,6,11,12,t,n+2*a[i++]),W(2,7,8,13,t,n+2*a[i++]),Y(2,7,8,13,t,n+2*a[i++]),W(3,4,9,14,t,n+2*a[i++]),Y(3,4,9,14,t,n+2*a[i++]);this.v0l^=u[0]^u[16],this.v0h^=u[1]^u[17],this.v1l^=u[2]^u[18],this.v1h^=u[3]^u[19],this.v2l^=u[4]^u[20],this.v2h^=u[5]^u[21],this.v3l^=u[6]^u[22],this.v3h^=u[7]^u[23],this.v4l^=u[8]^u[24],this.v4h^=u[9]^u[25],this.v5l^=u[10]^u[26],this.v5h^=u[11]^u[27],this.v6l^=u[12]^u[28],this.v6h^=u[13]^u[29],this.v7l^=u[14]^u[30],this.v7h^=u[15]^u[31],u.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const _r=qn(e=>new br(e));function xr(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),a=Number(n&o),l=r?4:0,g=r?0:4;e.setUint32(t+l,i,r),e.setUint32(t+g,a,r)}class Er extends $t{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ge(this.buffer)}update(t){ze(this);const{view:n,buffer:r,blockLen:s}=this;t=se(t);const o=t.length;for(let i=0;i<o;){const a=Math.min(s-this.pos,o-i);if(a===s){const l=Ge(t);for(;s<=o-i;i+=s)this.process(l,i);continue}r.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ze(this),Gt(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:o}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let h=i;h<s;h++)n[h]=0;xr(r,s-8,BigInt(this.length*8),o),this.process(r,0);const a=Ge(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=l/4,f=this.get();if(g>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<g;h++)a.setUint32(4*h,f[h],o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:a}=this;return t.length=s,t.pos=a,t.finished=o,t.destroyed=i,s%n&&t.buffer.set(r),t}}const vr=(e,t,n)=>e&t^~e&n,kr=(e,t,n)=>e&t^e&n^t&n,Tr=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Z=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),J=new Uint32Array(64);class Ir extends Er{constructor(){super(64,32,8,!1),this.A=Z[0]|0,this.B=Z[1]|0,this.C=Z[2]|0,this.D=Z[3]|0,this.E=Z[4]|0,this.F=Z[5]|0,this.G=Z[6]|0,this.H=Z[7]|0}get(){const{A:t,B:n,C:r,D:s,E:o,F:i,G:a,H:l}=this;return[t,n,r,s,o,i,a,l]}set(t,n,r,s,o,i,a,l){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=a|0,this.H=l|0}process(t,n){for(let h=0;h<16;h++,n+=4)J[h]=t.getUint32(n,!1);for(let h=16;h<64;h++){const p=J[h-15],w=J[h-2],m=j(p,7)^j(p,18)^p>>>3,b=j(w,17)^j(w,19)^w>>>10;J[h]=b+J[h-7]+m+J[h-16]|0}let{A:r,B:s,C:o,D:i,E:a,F:l,G:g,H:f}=this;for(let h=0;h<64;h++){const p=j(a,6)^j(a,11)^j(a,25),w=f+p+vr(a,l,g)+Tr[h]+J[h]|0,b=(j(r,2)^j(r,13)^j(r,22))+kr(r,s,o)|0;f=g,g=l,l=a,a=i+w|0,i=o,o=s,s=r,r=w+b|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,a=a+this.E|0,l=l+this.F|0,g=g+this.G|0,f=f+this.H|0,this.set(r,s,o,i,a,l,g,f)}roundClean(){J.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Br=Fn(()=>new Ir);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ie(...e){const t=(s,o)=>i=>s(o(i)),n=Array.from(e).reverse().reduce((s,o)=>s?t(s,o.encode):o.encode,void 0),r=e.reduce((s,o)=>s?t(s,o.decode):o.decode,void 0);return{encode:n,decode:r}}function de(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function fe(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function it(e,t="="){if(typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let s of n)if(typeof s!="string")throw new Error(`padding.decode: non-string input=${s}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function Ar(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function wt(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const s=[],o=Array.from(e);for(o.forEach(i=>{if(i<0||i>=t)throw new Error(`Wrong integer: ${i}`)});;){let i=0,a=!0;for(let l=r;l<o.length;l++){const g=o[l],f=t*i+g;if(!Number.isSafeInteger(f)||t*i/t!==i||f-g!==t*i)throw new Error("convertRadix: carry overflow");i=f%n;const h=Math.floor(f/n);if(o[l]=h,!Number.isSafeInteger(h)||h*n+i!==f)throw new Error("convertRadix: carry overflow");if(a)h?a=!1:r=l;else continue}if(s.push(i),a)break}for(let i=0;i<e.length-1&&e[i]===0;i++)s.push(0);return s.reverse()}const Ft=(e,t)=>t?Ft(t,e%t):e,Ue=(e,t)=>e+(t-Ft(e,t));function bt(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Ue(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Ue(t,n)}`);let s=0,o=0;const i=2**n-1,a=[];for(const l of e){if(l>=2**t)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(s=s<<t|l,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)a.push((s>>o-n&i)>>>0);s&=2**o-1}if(s=s<<n-o&i,!r&&o>=t)throw new Error("Excess padding");if(!r&&s)throw new Error(`Non-zero padding: ${s}`);return r&&o>0&&a.push(s>>>0),a}function Sr(e){return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return wt(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(wt(t,e,2**8))}}}function ke(e,t=!1){if(e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Ue(8,e)>32||Ue(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return bt(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(bt(n,e,8,t))}}}function Cr(e,t){if(typeof t!="function")throw new Error("checksum fn should be function");return{encode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),s=new Uint8Array(n.length+e);return s.set(n),s.set(r,n.length),s},decode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),s=t(r).slice(0,e),o=n.slice(-e);for(let i=0;i<e;i++)if(s[i]!==o[i])throw new Error("Invalid checksum");return r}}}const Rr=ie(ke(4),de("0123456789ABCDEF"),fe("")),Hr=ie(ke(5),de("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),it(5),fe("")),Pr=ie(ke(6),de("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),it(6),fe("")),Lr=ie(ke(6),de("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),it(6),fe("")),Or=e=>ie(Sr(58),de(e),fe("")),be=Or("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),_t=[0,2,3,5,6,7,9,10,11],zr={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=be.encode(r).padStart(_t[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),s=_t.indexOf(r.length),o=be.decode(r);for(let i=0;i<o.length-s;i++)if(o[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(o.slice(o.length-s)))}return Uint8Array.from(t)}},Ur=e=>ie(Cr(4,t=>e(e(t))),be),Mr={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},Nr=ie(ke(4),de("0123456789abcdef"),fe(""),Ar(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),xt={utf8:Mr,hex:Nr,base16:Rr,base32:Hr,base64:Pr,base64url:Lr,base58:be,base58xmr:zr},Dr="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",ai=(e,t)=>{if(!xt.hasOwnProperty(e))throw new TypeError(Dr);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return xt[e].decode(t)};var jr=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Vr(e){rt(e,Uint8Array);let t="";for(let n=0,r=e.length;n<r;n++)t+=jr[e[n]];return t}function $r(e){Mt(e,"string"),G(e.length%2===0,"Invalid hex padding.");const t=new Uint8Array(e.length/2);for(let n=0,r=0,s=t.length;n<s;n++){const o=Et(e.charCodeAt(r++)),i=Et(e.charCodeAt(r++));t[n]=o*16+i}return t}function Et(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-(65-10);if(e>=97&&e<=102)return e-(97-10);throw new Error("Invalid byte sequence.")}var k={encode:Vr,decode:$r};function Gr(e){return rt(e,Uint8Array),new TextDecoder().decode(e)}function Kr(e){return Mt(e,"string"),new Uint8Array(new TextEncoder().encode(e))}var Fe={encode:Gr,decode:Kr};Ur(Fr);var ge=be;function qt(e){return e instanceof Uint8Array?e:k.decode(e)}function ye(e){return _r(qt(e),{dkLen:32})}function Fr(e){return Br(qt(e))}function qr(e){e.length%2&&(e="0"+e);const t=BigInt("0x"+e);return 128&parseInt(e.slice(0,2),16)?-Qt(t):t}function Qr(e){const t=e>=y;t||(e=Qt(e));let n=e.toString(16);return n.length%2&&(n="0"+n),t&&128&parseInt(n.slice(0,2),16)&&(n="00"+n),n}function Qt(e){const t=e<y;t&&(e=-e);const n=e.toString(2);let r=n.length;const s=r%8;s>0?r+=8-s:t&&P(n)==="1"&&n.indexOf("1",1)!==-1&&(r+=8);const o=(1n<<BigInt(r))-1n;return(~e&o)+1n}function Xr(e,t){if(t===0)return e.write(0);if(t<0)throw new RangeError("Variable Length Quantity not supported for negative numbers.");do{let n=t&127;t>>=7,t>0&&(n|=128),e.write(n)}while(t>0);return e}function qe(e){if(e.isEmpty)return 0;let t=0,n=0,r=0;do r=e.readByte(),t|=(r&127)<<n,n+=7;while(r&128);return t}function Wr(e,t){if(t===y)return e.write(0);if(t<y)throw new RangeError("Variable Length Quantity not supported for negative numbers");do{let n=Number(t&Dt);t>>=Nt,t>0&&(n|=128),e.write(n)}while(t>0);return e}function Yr(e){if(e.isEmpty)return y;let t=y,n=y,r=y;do r=BigInt(e.readByte()),t|=(r&Dt)<<n,n+=Nt;while((r&jt)!=y);return t}function C(e){let t=0;if(typeof e=="number"){do t++,e=Math.floor(e/128);while(e>0);return t}e=I(e);do t++,e/=jt;while(e>y);return t}function Zr(e){return e<<1^e>>63}function Jr(e){return e>>1^-(e&1)}function es(e){return e<<Le^e>>Nn}function ts(e){return e>>Le^-(e&Le)}var K,$,Lt,ns=(Lt=class{constructor(e){X(this,K,void 0);X(this,$,void 0);typeof e=="string"?O(this,K,k.decode(e)):O(this,K,e),O(this,$,0)}get isEmpty(){return U(x(this,K))}readBoolean(){return this.readByte()===1}readBits(e){const t=new Array(e);let n=0;for(let r=0;r<e;r++){const s=x(this,K)[x(this,$)]>>n++&1;t[r]=s===1,n==8&&(n=0,te(this,$)._++)}return n>0&&te(this,$)._++,t}readByte(){return x(this,K)[te(this,$)._++]}readBytes(e){return x(this,K).subarray(x(this,$),O(this,$,x(this,$)+e))}readVlq(){return qe(this)}readShort(){return Number(Jr(qe(this)))}readInt(){const e=this.readLong();return Number(e)}readLong(){return ts(Yr(this))}readBigInt(){const e=qe(this);return qr(k.encode(this.readBytes(e)))}},K=new WeakMap,$=new WeakMap,Lt),F,L,Ot,ot=(Ot=class{constructor(e){X(this,F,void 0);X(this,L,void 0);O(this,F,new Uint8Array(e)),O(this,L,0)}get length(){return x(this,L)}writeBoolean(e){return this.write(e===!0?1:0),this}writeVLQ(e){return Xr(this,e)}writeBigVLQ(e){return Wr(this,e)}writeShort(e){return this.writeVLQ(Zr(e)),this}writeInt(e){return this.writeLong(BigInt(e)),this}writeLong(e){return this.writeBigVLQ(es(e)),this}write(e){return x(this,F)[te(this,L)._++]=e,this}writeBytes(e){return x(this,F).set(e,x(this,L)),O(this,L,x(this,L)+e.length),this}writeHex(e){return this.writeBytes(k.decode(e))}writeBits(e){let t=0;for(let n=0;n<e.length;n++)e[n]?x(this,F)[x(this,L)]|=1<<t++:x(this,F)[x(this,L)]&=~(1<<t++),t==8&&(t=0,te(this,L)._++);return t>0&&te(this,L)._++,this}writeBigInt(e){const t=Qr(e);return this.writeVLQ(t.length/2),this.writeHex(t),this}toHex(){return k.encode(this.toBytes())}toBytes(){return x(this,F).subarray(0,x(this,L))}},F=new WeakMap,L=new WeakMap,Ot),Xt=class{coerce(e){return e}},Wt=class extends Xt{get embeddable(){return!1}},ee=class extends Wt{get embeddable(){return!0}},_e,zt,Yt=(zt=class extends Xt{constructor(t){super();X(this,_e,void 0);O(this,_e,t)}get elementsType(){return x(this,_e)}get embeddable(){return!1}},_e=new WeakMap,zt),Zt=class extends ee{get code(){return 1}toString(){return"SBool"}},Jt=class extends ee{get code(){return 2}toString(){return"SByte"}},en=class extends ee{get code(){return 3}toString(){return"SShort"}},tn=class extends ee{get code(){return 4}toString(){return"SInt"}},nn=class extends ee{get code(){return 5}coerce(e){return I(e)}toString(){return"SLong"}},rn=class extends ee{get code(){return 6}coerce(e){return I(e)}toString(){return"SBigInt"}},sn=class extends ee{get code(){return 7}coerce(e){return typeof e=="string"?k.decode(e):e}toString(){return"SGroupElement"}},on=class extends ee{get code(){return 8}toString(){return"SSigmaProp"}},an=class extends Wt{get code(){return 98}toString(){return"SUnit"}},A=Object.freeze({embeddable:0,simpleColl:1,nestedColl:2,option:3,optionCollection:4,pairOne:5,pairTwo:6,symmetricPair:7,genericTuple:8}),cn=11,Je=cn+1,V=e=>Je*e,rs=Object.freeze({code:V(A.simpleColl),embeddable:!1,simpleCollTypeCode:V(A.simpleColl),nestedCollTypeCode:V(A.nestedColl)}),ss=Object.freeze({code:V(A.pairOne),embeddable:!1,pairOneTypeCode:V(A.pairOne),pairTwoTypeCode:V(A.pairTwo),tripleTypeCode:V(A.pairTwo),symmetricPairTypeCode:V(A.symmetricPair),quadrupleTypeCode:V(A.symmetricPair),genericTupleTypeCode:V(A.genericTuple)}),c={bool:new Zt,byte:new Jt,short:new en,int:new tn,long:new nn,bigInt:new rn,groupElement:new sn,sigmaProp:new on,unit:new an,coll:rs,tuple:ss};function et(e){return e.code>=c.coll.simpleCollTypeCode&&e.code<=c.coll.nestedCollTypeCode+cn}function un(e){return e.code>=c.tuple.pairOneTypeCode&&e.code<=c.tuple.genericTupleTypeCode}function ne(e){switch(e){case c.bool.code:return c.bool;case c.byte.code:return c.byte;case c.short.code:return c.short;case c.int.code:return c.int;case c.long.code:return c.long;case c.bigInt.code:return c.bigInt;case c.groupElement.code:return c.groupElement;case c.sigmaProp.code:return c.sigmaProp;default:throw new Error(`The type code '0x${e.toString(16)}' is not a valid primitive type code.`)}}var Re=class extends Yt{get code(){return c.coll.code}coerce(e){return this.elementsType.code===c.byte.code&&!(e instanceof Uint8Array)?typeof e=="string"?k.decode(e):Uint8Array.from(e):e.map(t=>this.elementsType.coerce(t))}toString(){return`SColl[${this.elementsType.toString()}]`}},pe=class extends Yt{get code(){return c.tuple.code}coerce(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=this.elementsType[n].coerce(e[n]);return t}toString(){return`(${this.elementsType.map(e=>e.toString()).join(", ")})`}};function Q(e,t,n){return new Proxy(e,{apply:(r,s,o)=>{const i=t??new r;return!n&&U(o)?i:new we(i,...o)}})}function ln(e,t){return new Proxy(e,{apply:t})}var Qe=Q(Jt,c.byte);Q(Zt,c.bool);Q(en,c.short);var ci=Q(tn,c.int),ui=Q(nn,c.long);Q(rn,c.bigInt);var ce=Q(sn,c.groupElement),ue=Q(on,c.sigmaProp);Q(an,void 0,!0);var Xe=ln(Re,(e,t,n)=>{const[r,s]=n,o=r();return s?new we(new e(o),s):()=>new e(o)});ln(pe,(e,t,n)=>{const[r,s]=n;if(typeof r=="function"&&typeof s=="function")return()=>new e([r(),s()]);if(r instanceof we&&s instanceof we)return new we(new e([r.type,s.type]),[r.data,s.data]);throw new Error("Invalid tuple declaration.")});var is=33,vt=205,kt=class He{static serialize(t,n,r){if(n.embeddable)switch(n.code){case c.bool.code:return r.writeBoolean(t);case c.byte.code:return r.write(t);case c.short.code:return r.writeShort(t);case c.int.code:return r.writeInt(t);case c.long.code:return r.writeLong(t);case c.bigInt.code:return r.writeBigInt(t);case c.groupElement.code:return r.writeBytes(t);case c.sigmaProp.code:{const s=t;if(s.type===c.groupElement)return r.write(vt),He.serialize(s.data,s.type,r);throw Error("Serialization error: SigmaProp operation not implemented.")}}else if(et(n)){if(n.elementsType.code===c.byte.code){const s=t instanceof Uint8Array;G(s,`SColl[Byte] expected an UInt8Array, got ${typeof t}.`)}else G(Array.isArray(t),`SColl expected an array, got ${typeof t}.`);switch(r.writeVLQ(t.length),n.elementsType.code){case c.bool.code:return r.writeBits(t);case c.byte.code:return r.writeBytes(t);default:{for(let s=0;s<t.length;s++)He.serialize(t[s],n.elementsType,r);return r}}}else if(un(n)){G(Array.isArray(t),`STupleType serialization expected an array, got ${typeof t}.`);const s=n.elementsType.length;for(let o=0;o<s;o++)He.serialize(t[o],n.elementsType[o],r);return r}else if(n.code===c.unit.code)return r;throw Error(`Serialization error: '0x${n.code.toString(16)}' type not implemented.`)}static deserialize(t,n){if(t.embeddable)switch(t.code){case c.bool.code:return n.readBoolean();case c.byte.code:return n.readByte();case c.short.code:return n.readShort();case c.int.code:return n.readInt();case c.long.code:return n.readLong();case c.bigInt.code:return n.readBigInt();case c.groupElement.code:return n.readBytes(is);case c.sigmaProp.code:{if(n.readByte()===vt)return this.deserialize(c.groupElement,n);break}}else switch(t.code){case c.coll.code:{const r=n.readVlq(),s=t.elementsType;switch(s.code){case c.bool.code:return n.readBits(r);case c.byte.code:return n.readBytes(r);default:{const o=new Array(r);for(let i=0;i<r;i++)o[i]=this.deserialize(s,n);return o}}}case c.tuple.code:return t.elementsType.map(r=>this.deserialize(r,n));case c.unit.code:return}throw new Error(`Parsing error: '0x${t.code.toString(16)}' type not implemented.`)}},Tt=class{static serialize(e,t){if(e.embeddable)t.write(e.code);else if(e.code===c.unit.code)t.write(e.code);else if(et(e))if(e.elementsType.embeddable)t.write(c.coll.simpleCollTypeCode+e.elementsType.code);else if(et(e.elementsType)){const n=e.elementsType;n.elementsType.embeddable?t.write(c.coll.nestedCollTypeCode+n.elementsType.code):(t.write(c.coll.simpleCollTypeCode),this.serialize(n,t))}else t.write(c.coll.simpleCollTypeCode),this.serialize(e.elementsType,t);else if(un(e)){switch(e.elementsType.length){case 2:{const n=P(e.elementsType),r=Hn(e.elementsType);n.embeddable?n.code===r.code?t.write(c.tuple.symmetricPairTypeCode+n.code):(t.write(c.tuple.pairOneTypeCode+n.code),this.serialize(r,t)):r.embeddable?(t.write(c.tuple.pairTwoTypeCode+r.code),this.serialize(n,t)):(t.write(c.tuple.pairOneTypeCode),this.serialize(n,t),this.serialize(r,t));return}case 3:t.write(c.tuple.tripleTypeCode);break;case 4:t.write(c.tuple.quadrupleTypeCode);break;default:{const n=e.elementsType.length;G(n>=2&&n<=255,"Invalid type: tuples must have between 2 and 255 items."),t.write(c.tuple.genericTupleTypeCode),t.writeVLQ(n)}}for(let n=0;n<e.elementsType.length;n++)this.serialize(e.elementsType[n],t)}else throw new Error("Serialization error: type not implemented.")}static deserialize(e){const t=e.readByte();if(G(t>0,`Parsing Error: Unexpected type code '0x${t.toString(16)}'`),t<c.tuple.genericTupleTypeCode){const n=Math.floor(t/Je),r=Math.floor(t%Je);switch(n){case A.embeddable:return ne(r);case A.simpleColl:{const s=r===0?this.deserialize(e):ne(r);return new Re(s)}case A.nestedColl:return new Re(new Re(ne(r)));case A.pairOne:{const s=r===0?[this.deserialize(e),this.deserialize(e)]:[ne(r),this.deserialize(e)];return new pe(s)}case A.pairTwo:{const s=r===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[this.deserialize(e),ne(r)];return new pe(s)}case A.symmetricPair:{const s=r===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[ne(r),ne(r)];return new pe(s)}}}else switch(t){case c.tuple.genericTupleTypeCode:{const n=e.readVlq(),r=new Array(n);for(let s=0;s<n;s++)r[s]=this.deserialize(e);return new pe(r)}case c.unit.code:return c.unit}throw new Error("Not implemented.")}},os=4096,xe,Ee,ve,we=(ve=class{constructor(t,n){X(this,xe,void 0);X(this,Ee,void 0);O(this,xe,t),O(this,Ee,t.coerce(n))}static from(t){G(t.length>0,"Empty constant bytes.");const n=new ns(t),r=Tt.deserialize(n),s=kt.deserialize(r,n);return new ve(r,s)}get type(){return x(this,xe)}get data(){return x(this,Ee)}toBytes(){const t=new ot(os);return Tt.serialize(this.type,t),kt.serialize(this.data,this.type,t),t.toBytes()}toHex(){return k.encode(this.toBytes())}},xe=new WeakMap,Ee=new WeakMap,ve),as=65535;function hn(e,t,n){if(t||(t=new ot(5e4)),t.writeBigVLQ(I(e.value)),t.writeHex(e.ergoTree),t.writeVLQ(e.creationHeight),cs(t,e.assets,n),us(t,e.additionalRegisters),_(n))return t;if(!dn(e))throw new Error("Invalid box type.");return t.writeHex(e.transactionId).writeVLQ(e.index)}function dn(e){const t=e;return _(t.transactionId)&&_(t.index)}function cs(e,t,n){if(U(t)){e.write(0);return}e.writeVLQ(t.length),B(n)?t.map(r=>e.writeVLQ(n.indexOf(r.tokenId)).writeBigVLQ(I(r.amount))):t.map(r=>e.writeHex(r.tokenId).writeBigVLQ(I(r.amount)))}function us(e,t){const n=Object.keys(t).sort();let r=0;for(const s of n)t[s]&&r++;if(e.writeVLQ(r),r!=0)for(const s of n){const o=t[s];_(o)&&e.writeHex(o)}}function ls(e,t){if(S(e.creationHeight))throw new Error("Box size estimation error: creation height is undefined.");let n=0;n+=C(_(t)?t:e.value),n+=me(e.ergoTree),n+=C(e.creationHeight),n+=C(e.assets.length),n+=e.assets.reduce((s,o)=>s+=me(o.tokenId)+C(o.amount),0);let r=0;for(const s in e.additionalRegisters){const o=e.additionalRegisters[s];o&&(n+=me(o),r++)}return n+=C(r),n+=32,n+=C(dn(e)?e.index:as),n}function hs(e){const t=new ot(1e5);t.writeVLQ(e.inputs.length),e.inputs.map(r=>ds(t,r)),t.writeVLQ(e.dataInputs.length),e.dataInputs.map(r=>t.writeHex(r.boxId));const n=gs(e.outputs);return t.writeVLQ(n.length),n.map(r=>t.writeHex(r)),t.writeVLQ(e.outputs.length),e.outputs.map(r=>hn(r,t,n)),t}function ds(e,t){e.writeHex(t.boxId),e.write(0),fs(e,t.extension)}function fs(e,t){const n=Object.keys(t);let r=0;for(const s of n){const o=t[s];_(o)&&r++}if(e.writeVLQ(r),r!=0)for(const s of n){const o=t[s];_(o)&&e.writeVLQ(Number(s)).writeHex(o)}}function gs(e){const t=new Set;return e.flatMap(n=>n.assets.map(r=>t.add(r.tokenId))),Array.from(t)}var ps=class extends Error{constructor(){super("One or more inputs was selected more than one time by the current selection strategy.")}},ms=class extends Error{constructor(t){const n=[];if(t.nanoErgs&&n.push(It("nanoErgs",t.nanoErgs)),B(t.tokens))for(const r of t.tokens)n.push(It(r.tokenId,r.amount));super(`Insufficient inputs:${n.join()}`);d(this,"unreached");this.unreached=t}};function It(e,t){return`
  > ${e}: ${t==null?void 0:t.toString()}`}var ys=class{constructor(){d(this,"_inputs")}select(e,t){this._inputs=e;let n=[];B(t.tokens)&&(n=this._selectTokens(t.tokens));const r=Ye(n,s=>s.value);if(S(t.nanoErgs)&&U(t.tokens)||_(t.nanoErgs)&&r<t.nanoErgs){const s=_(t.nanoErgs)?t.nanoErgs-r:void 0;n=n.concat(this._select(s))}return n}_selectTokens(e){let t=[];for(const n of e){const r=_(n.amount)?n.amount-q(t,n.tokenId):void 0;r&&r<=y||(t=t.concat(this._select(r,n.tokenId)))}return t}_select(e,t){const n=this._inputs;let r=y,s=[];if(S(e))t?s=n.filter(o=>o.assets.some(i=>i.tokenId===t)):s=n;else for(let o=0;o<n.length&&r<e;o++)if(t)for(const i of n[o].assets)i.tokenId===t&&(r+=i.amount,s.push(n[o]));else r+=n[o].value,s.push(n[o]);return B(s)&&(this._inputs=this._inputs.filter(o=>!s.includes(o))),s}},ws=class{constructor(e){d(this,"_selector");this._selector=e}select(e,t){return this._selector(e,t)}},bs=class{constructor(e){d(this,"_inputs");d(this,"_strategy");d(this,"_ensureFilterPredicate");d(this,"_selector");d(this,"_sortDirection");d(this,"_ensureInclusionBoxIds");this._inputs=e}defineStrategy(e){return this._isISelectionStrategyImplementation(e)?this._strategy=e:this._strategy=new ws(e),this}select(e){this._strategy||(this._strategy=new ys);const t=this._deepCloneTarget(e);let n=[...this._inputs],r=[];const s=this._ensureFilterPredicate,o=this._ensureInclusionBoxIds;if(s?o?r=n.filter(a=>s(a)||o.has(a.boxId)):r=n.filter(s):o&&(r=n.filter(a=>o.has(a.boxId))),B(r)&&(n=n.filter(a=>!r.some(l=>l.boxId===a.boxId)),t.nanoErgs&&t.nanoErgs>y&&(t.nanoErgs-=Ye(r,a=>a.value)),B(t.tokens)&&r.some(a=>!U(a.assets))))for(const a of t.tokens)a.amount&&a.amount>y&&(a.amount-=q(r,a.tokenId));if(this._selector&&(n=zn(n,this._selector,this._sortDirection||"asc")),r=r.concat(this._strategy.select(n,t)),Ln(r,a=>a.boxId))throw new ps;const i=this._getUnreachedTargets(r,e);if(i.nanoErgs||B(i.tokens))throw new ms(i);return r}_deepCloneTarget(e){return{nanoErgs:e.nanoErgs,tokens:e.tokens?e.tokens.map(t=>({tokenId:t.tokenId,amount:t.amount})):void 0}}_getUnreachedTargets(e,t){const n={nanoErgs:void 0,tokens:void 0},r=Ye(e,s=>s.value);if(t.nanoErgs&&t.nanoErgs>r&&(n.nanoErgs=t.nanoErgs-r),U(t.tokens))return n;for(const s of t.tokens){const o=q(e,s.tokenId);if(s.amount&&s.amount>o){if(s.tokenId===P(e).boxId)continue;S(n.tokens)&&(n.tokens=[]),n.tokens.push({tokenId:s.tokenId,amount:s.amount-o})}}return n}ensureInclusion(e){if(typeof e=="function")this._ensureFilterPredicate=e;else if(e==="all")this._ensureFilterPredicate=t=>t.value>0n;else if(S(this._ensureInclusionBoxIds)&&(this._ensureInclusionBoxIds=new Set),Array.isArray(e))for(const t of e)this._ensureInclusionBoxIds.add(t);else this._ensureInclusionBoxIds.add(e);return this}orderBy(e,t){return this._selector=e,this._sortDirection=t,this}_isISelectionStrategyImplementation(e){return!!e.select}static buildTargetFrom(e){const t={};let n=y;for(const r of e){n+=I(r.value);for(const s of r.assets)t[s.tokenId]=(t[s.tokenId]||y)+I(s.amount)}return{nanoErgs:n,tokens:Object.keys(t).map(r=>({tokenId:r,amount:t[r]}))}}},_s=class extends Error{constructor(){super("Registers should be densely packed. This means that it's not possible to use a register like 'R7' without filling 'R6', 'R5' and 'R4', for example.")}},xs=class extends Error{constructor(){super("Minting context is undefined. Transaction's inputs must be included in order to determine minting token id.")}},Es=class extends Error{constructor(){super("Creation Height is undefined.")}},vs=class extends Error{constructor(e){super(`Invalid Ergo address: ${e}`)}},re=4,ks=32,tt=k.decode("0008cd"),Ts=36,fn=k.decode("d40801"),Pe=k.decode("00ea02d193b4cbe4e3010e040004300e18"),Is=44,Ae=24;function Bt(e){return P(e)&240}function We(e){return P(e)&15}function At(e){return typeof e=="string"?k.decode(e):e}function Bs(e){return e.length===Ts&&pt(e,tt)?z.P2PK:e.length===Is&&pt(e,Pe)&&Mn(e,fn)?z.P2SH:z.P2S}function St(e){return U(e)||e.length!==33?!1:e[0]===2||e[0]===3}var T=class ae{constructor(t,n){d(this,"_ergoTree");d(this,"_network");d(this,"_type");this._ergoTree=t,this._network=n,this._type=Bs(t)}get network(){return this._network}get ergoTree(){return k.encode(this._ergoTree)}get type(){return this._type}static fromErgoTree(t,n){return new ae(k.decode(t),n)}static fromPublicKey(t,n){const r=At(t);if(!St(r))throw new Error("The Public Key is invalid.");const s=Ie(tt,r);return new ae(s,n)}static fromHash(t,n){if(t=At(t),t.length===ks)t=t.subarray(0,Ae);else if(t.length!=Ae)throw Error(`Invalid hash length: ${t.length}`);const r=Ie(Pe,t,fn);return new ae(r,n)}static fromBase58(t,n=!1){const r=ge.decode(t);if(!n&&!ae.validate(r))throw new vs(t);const s=Bt(r),o=We(r),i=r.subarray(1,r.length-re);return o===z.P2PK?this.fromPublicKey(i,s):o===z.P2SH?this.fromHash(i,s):new ae(i,s)}static validate(t){const n=typeof t=="string"?ge.decode(t):t;if(n.length<re)return!1;if(We(n)===z.P2PK){const a=n.subarray(1,n.length-re);if(!St(a))return!1}const r=n.subarray(0,n.length-re),s=n.subarray(n.length-re,n.length),i=ye(r).subarray(0,re);return Un(i,s)}static getNetworkType(t){return Bt(ge.decode(t))}static getAddressType(t){return We(ge.decode(t))}getPublicKeys(){return this.type===z.P2PK?[this._ergoTree.subarray(tt.length)]:[]}toP2SH(t){if(this.type===z.P2SH)return this.encode();const n=ye(this._ergoTree).subarray(0,Ae);return this._encode(n,z.P2SH,t)}encode(t){let n;return this.type===z.P2PK?n=P(this.getPublicKeys()):this.type===z.P2SH?n=this._ergoTree.subarray(Pe.length,Pe.length+Ae):n=this._ergoTree,this._encode(n,this.type,t)}_encode(t,n,r){_(r)||(_(this.network)?r=this.network:r=De.Mainnet);const s=Uint8Array.from([r+n]);t=Ie(s,t);const o=ye(t).subarray(0,re);return ge.encode(Ie(t,o))}toString(t){return this.encode(t)}},As=class gn{constructor(t){d(this,"boxId");d(this,"value");d(this,"ergoTree");d(this,"creationHeight");d(this,"assets");d(this,"additionalRegisters");d(this,"transactionId");d(this,"index");this.boxId=t.boxId,this.ergoTree=t.ergoTree,this.creationHeight=t.creationHeight,this.value=I(t.value),this.assets=t.assets.map(n=>({tokenId:n.tokenId,amount:I(n.amount)})),this.additionalRegisters=t.additionalRegisters,this.transactionId=t.transactionId,this.index=t.index}isValid(){return gn.validate(this)}static validate(t){const n=hn(t).toBytes(),r=k.encode(ye(n));return t.boxId===r}},Ct=class extends As{constructor(t){super(t);d(this,"_extension");t.extension&&this.setContextVars(t.extension)}get extension(){return this._extension}setContextVars(t){return this._extension=t,this}toUnsignedInputObject(t){return{...this.toPlainObject(t),extension:this._extension||{}}}toPlainObject(t){return t==="EIP-12"?{boxId:this.boxId,value:this.value.toString(),ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:this.assets.map(n=>({tokenId:n.tokenId,amount:n.amount.toString()})),additionalRegisters:this.additionalRegisters,transactionId:this.transactionId,index:this.index}:{boxId:this.boxId}}},Ss=class{constructor(e,t,n){d(this,"_inputs");d(this,"_dataInputs");d(this,"_outputs");this._inputs=Object.freeze(e),this._dataInputs=Object.freeze(t),this._outputs=Object.freeze(n)}get id(){return k.encode(ye(this.toBytes()))}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get burning(){return Ce(q(this.inputs),q(this.outputs))}toPlainObject(e){return{inputs:this.inputs.map(t=>t.toUnsignedInputObject(e||"default")),dataInputs:this.dataInputs.map(t=>t.toPlainObject(e||"default")),outputs:this.outputs.map(t=>Cs(t))}}toEIP12Object(){return this.toPlainObject("EIP-12")}toBytes(){return hs({inputs:this.inputs.map(e=>e.toUnsignedInputObject("default")),dataInputs:this.dataInputs.map(e=>e.toPlainObject("default")),outputs:this.outputs}).toBytes()}};function Cs(e){return{...e,value:e.value.toString(),assets:e.assets.map(t=>({tokenId:t.tokenId,amount:t.amount.toString()}))}}var Rs=class extends Error{constructor(e){super(`Box '${e}' is already included.`)}},Hs=class extends Error{constructor(e){super(e)}},Ps=class extends Error{constructor(e){super(`Invalid input: ${e}`)}},Rt=class extends Error{constructor(e){super(`Malformed transaction: ${e}`)}},Ls=class extends Error{constructor(){super(`A box must contain no more than ${ct} distinct tokens.`)}},pn=class extends Error{constructor(){super("This transaction is trying to burn tokens. If that's your intention you must explicitly allow token burning on TransactionBuilder.configure() method. If no, a change address should be provided.")}},at=class extends Error{constructor(e){super(e)}},ct=120,nt=class extends st{constructor(e,t){super(),_(e)&&this.add(e,t)}_map(e){return{tokenId:e.tokenId,amount:I(e.amount)}}_addOne(e,t){if((S(t)||t.sum&&!_(t.index))&&this._sum(this._map(e)))return this.length;if(this._items.length>=ct)throw new Ls;return super._addOne(e,t),this.length}add(e,t){return super.add(e,t)}_sum(e){for(const t of this._items)if(t.tokenId===e.tokenId)return t.amount+=e.amount,!0;return!1}remove(e,t){let n=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);n=e}else if(n=this._items.findIndex(r=>r.tokenId===e),this._isIndexOutOfBounds(n))throw new at(`TokenId '${e}' not found in assets collection.`);if(t&&n>-1){const r=I(t),s=this._items[n];if(r>s.amount)throw new Hs("Insufficient token amount to perform a subtraction operation.");if(r<s.amount)return s.amount-=r,this.length}return this._items.splice(n,1),this.length}contains(e){return this._items.some(t=>t.tokenId===e)}},Ht=class extends st{constructor(e){super(),_(e)&&this.add(e)}_map(e){return e instanceof Ct?e:new Ct(e)}_addOne(e){if(this._items.some(t=>t.boxId===e.boxId))throw new Rs(e.boxId);return super._addOne(e)}remove(e){let t=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);t=e}else if(t=this._items.findIndex(n=>n.boxId===e),this._isIndexOutOfBounds(t))throw new at("The input you are trying to remove is not present in the inputs collection.");return this._items.splice(t,1),this.length}},Os=class mn extends st{constructor(t){super(),_(t)&&this.add(t)}_map(t){return t}remove(t){let n=-1;if(typeof t=="number"){if(this._isIndexOutOfBounds(t))throw new RangeError(`Index '${t}' is out of range.`);n=t}else if(n=this._items.lastIndexOf(t),this._isIndexOutOfBounds(n))throw new at("The output you are trying to remove is not present in the outputs collection.");return this._items.splice(n,1),this.length}clone(){return new mn(this._items)}sum(t){const n={};let r=y;if(t&&(t.nanoErgs&&(r=t.nanoErgs),B(t.tokens)))for(const s of t.tokens)S(s.amount)||(n[s.tokenId]=(n[s.tokenId]||y)+s.amount);for(const s of this._items){r+=s.value;for(const o of s.assets)n[o.tokenId]=(n[o.tokenId]||y)+o.amount}return{nanoErgs:r,tokens:Object.keys(n).map(s=>({tokenId:s,amount:n[s]}))}}},zs=7,Us=class{constructor(e){d(this,"_bytes");typeof e=="string"?this._bytes=k.decode(e):this._bytes=e}get header(){return this._bytes[0]}get version(){return this.header&zs}get hasSegregatedConstants(){return(this.header&yt.constantSegregation)!=0}get hasSize(){return(this.header&yt.sizeInclusion)!=0}toBytes(){return this._bytes}toHex(){return k.encode(this.toBytes())}toAddress(e=De.Mainnet){return T.fromErgoTree(this.toHex(),e)}},yn=BigInt(360),wn=BigInt(1e6);function Ms(e=yn){return t=>BigInt(t.estimateSize())*e}var Se=class{constructor(e,t,n){d(this,"_address");d(this,"_tokens");d(this,"_value");d(this,"_valueEstimator");d(this,"_creationHeight");d(this,"_registers");d(this,"_minting");this.setValue(e),this._creationHeight=n,this._tokens=new nt,this._registers={},typeof t=="string"?this._address=Vt(t)?T.fromErgoTree(t):T.fromBase58(t):t instanceof Us?this._address=t.toAddress():this._address=t}get value(){return _(this._valueEstimator)?this._valueEstimator(this):this._value}get address(){return this._address}get ergoTree(){return this._address.ergoTree}get creationHeight(){return this._creationHeight}get assets(){return this._tokens}get additionalRegisters(){return this._registers}get minting(){return this._minting}setValue(e){if(typeof e=="function")this._valueEstimator=e;else if(this._value=I(e),this._valueEstimator=void 0,this._value<=y)throw new Error("An UTxO cannot be created without a minimum required amount.");return this}addTokens(e,t){return e instanceof nt?this._tokens.add(e.toArray(),t):this._tokens.add(e,t),this}addNfts(...e){const t=e.map(n=>({tokenId:n,amount:Le}));return this.addTokens(t)}mintToken(e){return this._minting={...e,amount:I(e.amount)},this}setCreationHeight(e,t){return(S(t)||t.replace===!0||t.replace===!1&&S(this._creationHeight))&&(this._creationHeight=e),this}setAdditionalRegisters(e){if(this._registers=Vn(e),!jn(e))throw new _s;return this}eject(e){return e({tokens:this._tokens}),this}build(e){var n;let t=this.assets.toArray();if(this.minting){if(U(e))throw new Es;U(this.additionalRegisters)&&this.setAdditionalRegisters({R4:Xe(Qe,Fe.decode(this.minting.name||"")).toHex(),R5:Xe(Qe,Fe.decode(this.minting.description||"")).toHex(),R6:Xe(Qe,Fe.decode(((n=this.minting.decimals)==null?void 0:n.toString())||"0")).toHex()}),t=[{tokenId:P(e).boxId,amount:this.minting.amount},...t]}if(S(this.creationHeight))throw new xs;return{value:this.value,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters}}estimateSize(e=wn){G(!!this.creationHeight,"Creation height must be set");const t=this._tokens.toArray();this.minting&&t.push({tokenId:"0000000000000000000000000000000000000000000000000000000000000000",amount:this.minting.amount});const n={value:e,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters};return ls(n)}},Ns=class extends Error{constructor(e){super(e)}};function Ds(e){return{addInputs:t=>e.from(t).configureSelector(n=>n.ensureInclusion(Array.isArray(t)?t.map(r=>r.boxId):t.boxId)).inputs.length,addOutputs:(t,n)=>e.to(t,n).outputs.length,addDataInputs:(t,n)=>e.withDataFrom(t,n).dataInputs.length,burnTokens:t=>{if(!e.settings.canBurnTokensFromPlugins)throw new pn;e.burnTokens(t)},setFee:t=>e.payFee(t)}}var js=class{constructor(){d(this,"_maxDistinctTokensPerChangeBox");d(this,"_allowTokenBurning");d(this,"_allowTokenBurningFromPlugins");d(this,"_isolateErgOnChange");this._maxDistinctTokensPerChangeBox=ct,this._allowTokenBurning=!1,this._allowTokenBurningFromPlugins=!1,this._isolateErgOnChange=!1}get maxTokensPerChangeBox(){return this._maxDistinctTokensPerChangeBox}get canBurnTokens(){return this._allowTokenBurning}get canBurnTokensFromPlugins(){return this.canBurnTokens||this._allowTokenBurningFromPlugins}get shouldIsolateErgOnChange(){return this._isolateErgOnChange}setMaxTokensPerChangeBox(e){return this._maxDistinctTokensPerChangeBox=e,this}allowTokenBurning(e=!0){return this._allowTokenBurning=e,this}allowTokenBurningFromPlugins(e=!0){return this._allowTokenBurningFromPlugins=e,this}isolateErgOnChange(e=!0){return this._isolateErgOnChange=e,this}},Vs=BigInt(11e5),$s="1005040004000e36100204a00b08cd0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ea02d192a39a8cc7a701730073011001020402d19683030193a38cc7b2a57300000193c2b2a57301007473027303830108cdeeac93b1a57304",li=class{constructor(e){d(this,"_inputs");d(this,"_dataInputs");d(this,"_outputs");d(this,"_settings");d(this,"_creationHeight");d(this,"_selectorCallbacks");d(this,"_changeAddress");d(this,"_feeAmount");d(this,"_burning");d(this,"_plugins");this._inputs=new Ht,this._dataInputs=new Ht,this._outputs=new Os,this._settings=new js,this._creationHeight=e}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get changeAddress(){return this._changeAddress}get fee(){return this._feeAmount}get burning(){return this._burning}get settings(){return this._settings}get creationHeight(){return this._creationHeight}get and(){return this}from(e){return Gs(e)&&(e=e.toArray()),this._inputs.add(e),this}to(e,t){return this._outputs.add(e,t),this}withDataFrom(e,t){return this._dataInputs.add(e,t),this}sendChangeTo(e){return typeof e=="string"?this._changeAddress=Vt(e)?T.fromErgoTree(e,De.Mainnet):T.fromBase58(e):this._changeAddress=e,this}payFee(e){return this._feeAmount=I(e),this}payMinFee(){return this.payFee(Vs),this}burnTokens(e){return this._burning||(this._burning=new nt),this._burning.add(e),this}configure(e){return e(this._settings),this}configureSelector(e){return S(this._selectorCallbacks)&&(this._selectorCallbacks=[]),this._selectorCallbacks.push(e),this}extend(e){return this._plugins||(this._plugins=[]),this._plugins.push({execute:e,pending:!0}),this}eject(e){return e({inputs:this.inputs,dataInputs:this.dataInputs,outputs:this.outputs,burning:this.burning,settings:this.settings,selection:t=>{this.configureSelector(t)}}),this}build(){if(B(this._plugins)){const i=Ds(this);for(const a of this._plugins)a.pending&&(a.execute(i),a.pending=!1)}if(this._isMinting()){if(this._isMoreThanOneTokenBeingMinted())throw new Rt("only one token can be minted per transaction.");if(this._isTheSameTokenBeingMintedOutsideTheMintingBox())throw new Ns("EIP-4 tokens cannot be minted from outside of the minting box.")}this.outputs.toArray().map(i=>i.setCreationHeight(this._creationHeight,{replace:!1}));const e=this.outputs.clone();_(this._feeAmount)&&e.add(new Se(this._feeAmount,$s));const t=new bs(this.inputs.toArray());if(B(this._selectorCallbacks))for(const i of this._selectorCallbacks)i(t);const n=B(this._burning)?e.sum({tokens:this._burning.toArray()}):e.sum();let r=t.select(n);if(_(this._changeAddress)){let i=Ce(q(r),n);const a=[];if(B(i.tokens)){let l=Pt({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:i.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});for(;l>i.nanoErgs;)r=t.select({nanoErgs:n.nanoErgs+l,tokens:n.tokens}),i=Ce(q(r),n),l=Pt({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:i.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});const g=On(i.tokens,this._settings.maxTokensPerChangeBox);for(const f of g){const h=new Se(Ms(),this._changeAddress,this._creationHeight).addTokens(f);i.nanoErgs-=h.value,a.push(h)}}if(i.nanoErgs>y)if(B(a)){if(this.settings.shouldIsolateErgOnChange)e.add(new Se(i.nanoErgs,this._changeAddress));else{const l=P(a);l.setValue(l.value+i.nanoErgs)}e.add(a)}else e.add(new Se(i.nanoErgs,this._changeAddress))}for(const i of r)if(!i.isValid())throw new Ps(i.boxId);const s=new Ss(r,this.dataInputs.toArray(),e.toArray().map(i=>i.setCreationHeight(this._creationHeight,{replace:!1}).build(r)));let o=s.burning;if(o.nanoErgs>y)throw new Rt("it's not possible to burn ERG.");if(B(o.tokens)&&B(this._burning)&&(o=Ce(o,{nanoErgs:y,tokens:this._burning.toArray()})),!this._settings.canBurnTokens&&B(o.tokens))throw new pn;return s}_isMinting(){for(const e of this._outputs)if(e.minting)return!0;return!1}_isMoreThanOneTokenBeingMinted(){let e=0;for(const t of this._outputs)if(_(t.minting)&&(e++,e>1))return!0;return!1}_isTheSameTokenBeingMintedOutsideTheMintingBox(){const e=this._getMintingTokenId();if(S(e))return!1;for(const t of this._outputs)if(t.assets.contains(e))return!0;return!1}_getMintingTokenId(){let e;for(const t of this._outputs)if(t.minting){e=t.minting.tokenId;break}return e}};function Gs(e){return e.toArray!==void 0}function Pt(e){return BigInt(Ks(e))*yn}function Ks({changeAddress:e,creationHeight:t,tokens:n,baseIndex:r,maxTokensPerBox:s}){const o=Math.ceil(n.length/s);let i=0;i+=C(wn),i+=me(e.ergoTree),i+=C(t),i+=C(0),i+=32,i=i*o;for(let a=0;a<o;a++)i+=C(r+a);return i+=n.reduce((a,l)=>a+=me(l.tokenId)+C(l.amount),0),n.length>s?n.length%s>0?(i+=C(s)*Math.floor(n.length/s),i+=C(n.length%s)):i+=C(s)*o:i+=C(n.length),i}function hi(e){return e.toHex()}const ut="9fxHfNqjT4ELqxbBU3RyvmTretGh88btXFHPBHvXC5RaZoMLKqt",bn="9gdLSKyzeyB3qQ1LWidALiyyfvQwFCZtcozXqjQ9hRkfGwPFCbR",_n="9hGceS9rTZDDmsnioJGWykfUAzk8ZbCuuadNLvoeG7hN9bM3kNP",le="cbd75cfe1a4f37f9a22eaee516300e36ea82017073036f07a09c1d2e10277cda",Fs=20000000000n,di=60000000000n,fi=30000000000n,qs="H3AA3QNR1XTqqPnNsjrYjsF3JAKFZATMemhZ1pp94Vgus7BK3WsuZwmqfDYNWCFGvVd3Udo1nEMt3MyKEFiCnqT4fd9FUwPhTTCbMjbL5LyuVpTRhLppi9AnHvBVhmtYMLmWeyUnspkDbHC5VzZMTaETLmA9ZsNZPjzYab5woeSwSXKk5uCa9GkJf8FYi2mAHuaXB9MohZR9B3gGZY5uP8Wsq1QDE8pxKTmurTd9tVRjsjWVF7hyTdbEkhq3Ue89WsJEi1Y5Ur9RrVjNx3MgMXCiHbi2XnATEAkdssCSxybr9pyGqF2pyfjP2daNioEtaok99ca3pUFg7egqtfAuALqgjwBPMZyDT6ewmkLSwiBbNG4F8Yvh6d7jEzBM41fXNtNKHtRbxRhrj95fQmZW9dPbsr4MyAF5HpJpgCKEjpe4YBfuCjssu5YKMc5sNjwBEo8k8xHVPEne7SwpCbLDSeyj98XgK58yt9Zcm1Lr9M7txoiNxHAGaNAXmcbayGTkeVPyrgAfni8daXmzHyGTcQ8zH33bfkM6asQPpj54LTWPAfHAKsK646MPJ9UUjCGoNunpQ",Qs="2GA8D6BRAQBFM43ToK7rVxKuEanxNv9r5fy85kP5yZdsefddeVsNPv3eKY1MUek9YizEuo6oMpJTD6GxXQ26wpgikiJgdpTLKc7LB9KvcSEjhBYSmsnSkkthRPWJR5obRVqYZRcVtmbRM4k3EXymDAkctymB9VonNmoMvQXS3HzENceRdD7SJg72sYWCakgKk2rj595Dgjm5UM3jKFGK9FrGhrbW6BA2CsKe617Zp4KfUv2tirBqxSYuSbpnMJC3hrjHRpciZMgxc23BQp37hcEmYgorJQbDSYcCwsqp4vCdhc2Y7X3G7DvPHGzg43rzGJirKnAyDZRuWGm6LMtAFAWYtqaLyCkahmXuYftbQPT7x4AvXJgay2wyY5CJHBDXvEFJqRTuQ51mnZSBkmEPaqXec2uLpp9P45kQFW9b763jVmXDTou5fcNQUqKAL4yvg8bbZZebrfMQJdi8kFAM19rWmkDcsQWtc26vyNjaNnndShhA8LQosfisBQepD9wzftKA6co4PxtJvDr",gi=M(""),pi=M([]),mi=M([]),xn=M([]),En=M([]);function yi(){const e=localStorage.getItem("ergo_bay_unconfirmed_mints");e&&En.set(JSON.parse(e))}async function Xs(){const e=await Ut(Qs);e.forEach(t=>{var r,s,o;let n=null;t.additionalRegisters.R7.serializedValue==ue(ce(P(T.fromBase58(ut).getPublicKeys()))).toHex()&&(n="hodlbox"),t.additionalRegisters.R7.serializedValue==ue(ce(P(T.fromBase58(bn).getPublicKeys()))).toHex()&&(n="bitmasks"),t.additionalRegisters.R7.serializedValue==ue(ce(P(T.fromBase58(_n).getPublicKeys()))).toHex()&&(n="walrus"),n=="hodlbox"&&(((r=t.assets)==null?void 0:r.length)>0&&t.assets[0].tokenId==le?(t.treasure=he.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=he.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=T.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString()),n=="bitmasks"&&(((s=t.assets)==null?void 0:s.length)>0&&t.assets[0].tokenId==le?(t.treasure=Ne.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=Ne.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=T.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString()),n=="walrus"&&(((o=t.assets)==null?void 0:o.length)>0&&t.assets[0].tokenId==le?(t.treasure=Me.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=Me.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=T.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString())}),xn.update(t=>[...t,...e]),vn(e)}async function Ws(){const e=await Ut(qs);e.forEach(t=>{var r,s,o;let n=null;t.additionalRegisters.R7.serializedValue==ue(ce(P(T.fromBase58(ut).getPublicKeys()))).toHex()&&(n="hodlbox"),t.additionalRegisters.R7.serializedValue==ue(ce(P(T.fromBase58(bn).getPublicKeys()))).toHex()&&(n="bitmasks"),t.additionalRegisters.R7.serializedValue==ue(ce(P(T.fromBase58(_n).getPublicKeys()))).toHex()&&(n="walrus"),n=="hodlbox"&&(((r=t.assets)==null?void 0:r.length)>0&&t.assets[0].tokenId==le?(t.treasure=he.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=he.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=T.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString()),n=="bitmasks"&&(((s=t.assets)==null?void 0:s.length)>0&&t.assets[0].tokenId==le?(t.treasure=Ne.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=Ne.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=T.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString()),n=="walrus"&&(((o=t.assets)==null?void 0:o.length)>0&&t.assets[0].tokenId==le?(t.treasure=Me.find(i=>t.assets[0].amount==i.price*10**9),t.currency="hodlERG3"):t.value>1*10**9&&(t.treasure=Me.find(i=>t.value==i.price*10**9),t.currency="ERG"),t.hodler=T.fromPublicKey(t.additionalRegisters.R6.serializedValue.substring(4)).toString())}),xn.set(e),vn(e)}async function wi(){await Ws(),await Xs()}function vn(e){En.update(t=>t.filter(n=>!e.some(r=>r.transactionId==n.transactionId)))}const Me=[{id:0,price:10,img:"chest/walrus/10erg.png",cid:"bafybeiafladhfnbmt242kookpyvuvaemaimpuak5qb7unff5e3b57kmkhi",sha256:"61d1c1d07543bd8908bcb35ff0f57b6d03e7e4109d64cb16607f6ec5c88b7550",name:"$300.00 Walrus Chest"},{id:1,price:100,img:"chest/walrus/100erg.png",cid:"bafybeifdavbqmkn6hkznr7lwgwyk4i73uysskzc3slpqjvcznluteerxeq",sha256:"f52ef55eb5962b3e13fccc715ec83d00fcb4c7b653eb31a0d61ad1a583c594c9",name:"$3,000.00 Walrus Chest"},{id:2,price:1e3,img:"chest/walrus/1000erg.png",cid:"bafybeie7hbpqbzl7trvfc2cupiouzxkhkibzhbbvq47iaw4qr5gmm4dqmq",sha256:"b59dc966c57f20776e6492547b1fb5f6aaaaaa4116af61f42a4993909d40c8b1",name:"$30,000.00 Walrus Chest"},{id:3,price:1e4,img:"chest/walrus/10000erg.png",cid:"bafybeibab375c27tp62jxgbbwvfnz5uhgzknyyrda2tpzmz6gxc6sznsgi",sha256:"74a0982116b6a946b5f5430d19f8ae77521fe7c7ce8337214c4df25b3b838088",name:"$300,000.00 Walrus Chest"}],Ne=[{id:0,price:10,img:"chest/bitmasks/10erg.png",cid:"bafybeigqt6lkj54j7yefwhnlvf3zxu4u6stb2ekqeqw4edsn5tp7ojrjje",sha256:"d6681a167927bbe307c4720b7714f2af0faa235fef2cb8d749b3ce6b20de83cc",name:"$600.00 Bitbox"},{id:1,price:100,img:"chest/bitmasks/100erg.png",cid:"bafybeidpmf2y446z2eoc2hwpb7fdvihvlyszrasqsd5vm6f2i5vtydpbem",sha256:"988799f887981277f1ad6bd6069fdd942d8399099124fb04535f7fe586bb5791",name:"$6,000.00 Bitbox"},{id:2,price:1e3,img:"chest/bitmasks/1000erg.png",cid:"bafybeihtnoq4lzvklzoacz2sgoporvl5tf42prpnpkf2ue22krpezesxkq",sha256:"a6bd98171412dc07e52a46d32b2064f7c65ed3a0dce4b824b7cfafced7790ef6",name:"$60,000.00 Bitbox"},{id:3,price:1e4,img:"chest/bitmasks/10000erg.png",cid:"bafybeiemvri47zknjmtzjfxd3cxlu6pxyhsnxrwsx6wq72w72gmq52qkgm",sha256:"77443821d856013b7d6bb60c638131ff7324b82f2864e659434c7c0a7967ef13",name:"$600,000.00 Bitbox"}],he=[{id:0,price:10,img:"chest/10erg.png",cid:"bafybeihui4r6ylwy2u7crtvhllwy4rnorop3icpgvks5edkyb47f3guziq",sha256:"e8f26588981063e0bd9fd3f4b05b2f42aac53a0c17fd1e265b3f1eef27466b44",name:"$200.00 Hodlbox"},{id:1,price:100,img:"chest/100erg.png",cid:"bafybeideasgh2la3p4c3pqvwjzcjevyxr6j7wawtqqfa6rc25a6ntogk5i",sha256:"df338cc3cce006d349dd3f4c4ca97bc497733906e20afb178f982e343548989d",name:"$2,000.00 Hodlbox"},{id:2,price:1e3,img:"chest/1000erg.png",cid:"bafybeigkm4chflhvptckwprjmhvps5kcpuzevgjcthak5q435dv4os2x54",sha256:"5704bd829777b113026534fd24c8f0e89185090f6cd36b087532173ca9d26e5e",name:"$20,000.00 Hodlbox"},{id:3,price:1e4,img:"chest/10000erg.png",cid:"bafybeicihtoti7v4ul5l4aisp2ccb7feoatoqyjtxw4clw6jk676gfkuhm",sha256:"ed40bd94ca81b53e4fe930be0e0d81e1f3fabf336ba5c26311ec55e633542d59",name:"$200,000.00 Hodlbox"},{id:4,price:1.27,img:"chest/1.27erg.png",cid:"bafkreia4wvsv6j2ka6s6sso5vkmemmkx4risp5o5i3wk3cbbtkplzcmjpe",sha256:"1cb5655f274a07a5e949ddaa98463157e45127f5dd46ecad88219a9ebc898979",name:"$25.40 Hodlbox"}],bi=M(he),_i=M(ut),xi=M(Fs),Ys=["ERG","hodlERG3"],Ei=M(he[0]),vi=M(Ys[0]),Zs=M();function Js(e){return typeof e=="number"?{timeout:e}:e}function lt(e,t="default",n){Zs.set({type:t,message:e,options:Js(n)})}function ki(e,t){lt(e,"danger",t)}function Ti(e,t){lt(e,"warning",t)}function Ii(e,t){lt(e,"info",t)}export{le as A,bn as B,qs as C,bi as D,T as E,Fs as F,he as G,ut as H,di as I,Ne as J,_n as K,Me as L,yi as M,wi as N,Se as O,Vs as R,hi as S,li as T,fi as W,_i as a,xn as b,vi as c,ki as d,si as e,Xe as f,Qe as g,ai as h,wn as i,ui as j,ci as k,ue as l,ce as m,Zs as n,ii as o,P as p,Qs as q,En as r,gi as s,xi as t,oi as u,Ei as v,Ti as w,pi as x,mi as y,Ii as z};
